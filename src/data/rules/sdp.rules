alert tcp any any -> any [1210,1211] (msg:"CODESYS Gateway-Server invalid memory access attempt"; flow:to_server,established; content:"|DD DD|"; depth:2; content:"|00 00|"; within:2; distance:18; content:!"|00 00 00 00|"; within:4; pcre:"/^\xDD\xDD.{16}(\x09\x00)|(\x0E\x00)|(\xEE\x03)\x00\x00/"; sid:100000; rev:1;)
alert tcp any any -> any [1210,1211] (msg:"CODESYS Gateway-Server directory traversal attempt"; flow:to_server,established; content:"|DD DD|"; depth:2; content:".."; within:3; distance:20; content:".."; within:2; distance:1; sid:100001; rev:5;)
alert tcp any any -> any [1210,1211] (msg:"3S CoDeSys Gateway Server stack buffer overflow attempt 1"; flow:to_server,established; content:"|DD DD|"; depth:2; content:"|06 00 00 00|"; within:4; distance:16; isdataat:232,relative; content:!"|00|"; within:232; sid:100002; rev:3;)
alert tcp any any -> any [1210,1211] (msg:"CODESYS Gateway-Server heap buffer overflow attempt"; flow:to_server,established; content:"|DD DD|"; depth:2; content:"|06 00 00 00|"; within:4; distance:16; byte_test:4,>,0x7fffffff,260,relative,little; sid:100003; rev:1;)
alert tcp any any -> any 12397 (msg:"IGSS SCADA dc.exe Server Directory Traversal Arbitrary File Execution - 0xa"; flow:to_server,established; content:"|0a|"; offset:12; depth:1; content:"|2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; distance:0; sid:100005; rev:4;)
alert tcp any any -> any 12401 (msg:"7T Interactive Graphical SCADA System Arbitrary File Read And Overwrite"; flow:established,to_server; content:"|01 00|"; offset:2; depth:2; content:"|0d 00 00 00|"; offset:6; depth:4; byte_test:4,<,0x00000004,18,little; byte_test:4,>,0x00000001,18,little; content:".."; distance:0; sid:100006; rev:1;)
alert udp any any -> any 20034 (msg:"DAQFactory NETB protcol stack overflow attempt"; flow:to_server; dsize:>370; content:"NETB"; depth:4; content:"|00|"; within:6; distance:230; sid:100007; rev:5;)
alert tcp any any -> any 910 (msg:"DATAC Control RealWin SCADA System Crafted Packet Handling Buffer Overflow"; flow:to_server,established; isdataat:715; content:"|10 23 54 67|"; offset:0; byte_test:4,>,700,0,relative,little; content:"|0a 00 05 00|"; distance:6; within:4; sid:100008; rev:2;)
alert tcp any any -> any 777 (msg:"Kingview HMI heap overflow attempt"; flow:to_server,established; stream_size:client,>,2000; content:"|90 90 90 90 90 90 90 90|"; fast_pattern:only; sid:100009; rev:7;)
alert tcp any any -> any 777 (msg:"WellinTech Kingview HMI history server buffer overflow attempt"; flow:to_server,established; content:"|03 00 00|"; depth:3; offset:2; byte_test:2,>,9,0,little; byte_extract:2,4,element_count,relative,little,multiplier 12; byte_test:2,>,element_count,0,little; sid:100010; rev:5;)
alert tcp any any -> any 11234 (msg:"Measuresoft ScadaPro Directory (0day) Transversal Arbitrary Command Execution"; flow:to_server,established; content:"xf|25|"; content:"|5C|system32|5C|msvcrt.dll|2C|system|2C|start"; distance:0; sid:100011; rev:3;)
alert tcp any any -> any 11234 (msg:"Measuresoft ScadaPro msvcrt.dll local command execution attempt"; flow:to_server,established; content:"xf%"; depth:3; content:"msvcrt.dll"; fast_pattern:only; sid:100012; rev:4;)
alert tcp any any -> any 11234 (msg:"Measuresoft ScadaPro directory traversal file operation attempt"; flow:to_server,established; content:"..|5C|..|5C|"; fast_pattern:only; pcre:"/^[xounwR]f\x25[^\n]*(\.\.\x5C){2}/i"; sid:100013; rev:4;)
alert tcp any any -> any [2103,2105,2107] (msg:"NETBIOS Microsoft Windows Message Queuing Service String Buffer Overflow 4"; flow:to_server,established; flowbits:isset,ETPRO.RPCBind.Little; content:"|05 00 00|"; depth:3; byte_test:1,<,0x80,0,relative; byte_test:1,&,0xF0,1,relative; content:"|06 00|"; distance:19; within:2; byte_test:4,>,0x8E,12,relative,little; sid:100015; rev:2;)
alert tcp any any -> any 2101:2107 (msg:"NETBIOS Microsoft Windows Message Queuing Buffer Overflow 6"; flow:to_server,established; content:"O|00|S|00 3a 00|"; nocase; content:"|5c 00|"; distance:0; within:30; isdataat:268,relative; content:!"|00 00|"; distance:0; within:268; sid:100016; rev:2;)
alert udp any any -> any 135 (msg:"NETBIOS DCERPC Messenger Service buffer overflow attempt"; content:"|04 00|"; depth:2; byte_test:1,>,15,2,relative; byte_jump:4,86,little,align,relative; byte_jump:4,8,little,align,relative; byte_test:4,>,1024,0,little,relative; sid:100017; rev:10;)
alert tcp any any -> any 23 (msg:"ScadaTec Procyon Core server password overflow attempt 1"; flow:to_server,established; dsize:>500; content:"|BF 99 46 77 90 90 90 90 90 90 90 90 90 90|"; depth:14; offset:65; sid:100018; rev:3;)
alert tcp any any -> any 46823 (msg:"Sielco Sistemi Winlog Pro stack buffer overflow attempt"; flow:to_server,established; content:"|02 01 01|"; depth:3; isdataat:70,relative; sid:100019; rev:4;)
alert tcp any any -> any [1210,1211] (msg:"CODESYS Gateway-Server directory traversal and system32/wbem/mof/ attack"; flow:to_server,established; content:"|DD DD|"; depth:2; content:"..|5C|..|5C|WINDOWS|5C|system32|5C|wbem|5C|mof|5C|"; fast_pattern:only; sid:100020; rev:6;)
alert tcp any any -> any [1210,1211] (msg:"CODESYS Gateway-Server executable file upload attempt"; flow:to_server,established; content:"|DD DD|"; depth:2; content:"..|5C|..|5C|"; distance:0; content:"MZ"; distance:0; byte_jump:4,58,relative,little; content:"PE|00 00|"; within:4; distance:-64; sid:100021; rev:6;)
alert tcp any any -> any 20171 (msg:"Yokogawa CENTUM CS 3000 stack buffer overflow attempt"; flow:to_server,established; content:"|64 A1 18 00 00 00 83 C0 08 8B 20 81 C4 30 F8 FF FF|"; fast_pattern:only; sid:100022; rev:1;)
alert tcp any any -> any 4502 (msg:"Cogent unicode buffer overflow attempt 1"; flow:to_server,established; content:"(slave "; nocase; content:"|22|"; within:3; isdataat:500,relative; content:!"|22|"; within:500; sid:100023; rev:7;)
alert tcp any any -> any 4502 (msg:"Cogent unicode buffer overflow attempt 2"; flow:to_server,established; content:"(register_datahub "; nocase; content:"|22|"; within:3; isdataat:500,relative; content:!"|22|"; within:500; sid:100024; rev:7;)
alert tcp any any -> any 4502 (msg:"Cogent unicode buffer overflow attempt 3"; flow:to_server,established; content:"(domain "; nocase; content:"|22|"; within:3; isdataat:500,relative; content:!"|22|"; within:500; sid:100025; rev:8;)
alert tcp any any -> any 4502 (msg:"Cogent unicode buffer overflow attempt 4"; flow:to_server,established; content:"(report_domain "; nocase; content:"|22|"; within:3; isdataat:500,relative; content:!"|22|"; within:500; sid:100026; rev:7;)
alert tcp any 54321 -> any any (msg:"Moxa Device Manager buffer overflow attempt"; flow:to_client,established; dsize:>1080; content:"|28 10 00 29|"; depth:4; content:"|E8 D5 FD FF FF|"; within:5; distance:1076; sid:100027; rev:4;)
alert tcp any any -> any [2308,50523] (msg:"Siemens SIMATIC WinCC flexible runtime stack buffer overflow attempt 1"; flow:to_server,established; isdataat:1024; content:"|00 01 03|"; depth:3; byte_test:4,>,0x410,23,little,relative; sid:100028; rev:3;)
alert tcp any any -> any [2308,50523] (msg:"Siemens SIMATIC WinCC flexible runtime stack buffer overflow attempt 2"; flow:to_server,established; isdataat:1024; content:"|08 00 02|"; depth:3; byte_test:4,>,0x410,23,little,relative; sid:100029; rev:3;)
alert tcp any any -> any [2308,50523] (msg:"Siemens SIMATIC WinCC flexible runtime stack buffer overflow attempt 3"; flow:to_server,established; isdataat:1024; content:"|00 04 02|"; depth:3; byte_test:4,>,0x410,3,little,relative; sid:100030; rev:3;)
alert tcp any any -> any [2308,50523] (msg:"Siemens SIMATIC WinCC flexible runtime stack buffer overflow attempt 4"; flow:to_server,established; isdataat:1024; content:"|00 04 03|"; depth:3; byte_test:4,>,0x410,23,little,relative; sid:100031; rev:3;)
alert tcp any any -> any 23 (msg:"ScadaTec Procyon Core server password overflow attempt 2"; flow:to_server,established; dsize:>500; content:"|70 77 84 1d 41 41 41 41 06 01 01 01|"; offset:45; depth:12; content:"|bf 99 46 77|"; distance:8; within:4; sid:100032; rev:4;)
alert tcp any any -> any [12397,12399] (msg:"Schneider Electric IGSS integer underflow attempt"; flow:to_server,established; content:"|00 00|"; depth:2; offset:6; byte_jump:4,0,relative,little,post_offset -4; byte_test:4,>,0x800,0,relative,little; sid:100037; rev:5;)
alert tcp any any -> any [1210,1211] (msg:"3S CoDeSys Gateway Server stack buffer overflow attempt 2"; flow:to_server,established; content:"|DD DD|"; depth:2; content:"|F1 03 00 00|"; within:4; distance:16; isdataat:384,relative; content:!"|00|"; within:384; sid:100040; rev:3;)
alert tcp any any -> any [2308,50523] (msg:"Siemens SIMATIC WinCC flexible runtime stack buffer overflow attempt 5"; flow:to_server,established; isdataat:1024; content:"|00 08 02|"; depth:3; byte_test:4,>,0x410,3,little,relative; sid:100043; rev:1;)
alert tcp any any -> any 20222 (msg:"CitectSCADA ODBC Overflowflow Attempt"; flow:established,to_server; dsize:4; byte_test:4,>,233,0; sid:100045; rev:9;)
alert tcp any any -> any 912 (msg:"RealFlex RealWin SCADA SCPC_INITIALIZE Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|64 12 54 6a 02 00 00 00|"; depth:8; byte_test:4,>,200,0,relative,little; sid:100046; rev:1;)
alert tcp any any -> any 912 (msg:"RealFlex RealWin SCADA SCPC_INITIALIZE_RF Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|64 12 54 6a 20 00 00 00|"; depth:8; byte_test:4,>,200,0,relative,little; sid:100047; rev:1;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA System Directory Traversal and Download"; flow:to_server,established; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|03|"; distance:11; within:1; content:"|2e 2e|"; distance:0; content:"|2e 2e|"; distance:1; within:2; pcre:"/\x2e\x2e[\x2f\x5c]\x2e\x2e[\x2f\x5c]/"; sid:100049; rev:4;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA system Directory Traversal Upload and Overwrite"; flow:to_server,established; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|02|"; distance:11; within:1; content:"|2e 2e|"; distance:0; content:"|2e 2e|"; distance:1; within:2; pcre:"/\x2e\x2e[\x2f\x5c]\x2e\x2e[\x2f\x5c]/"; sid:100050; rev:4;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA ListAll Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|01|"; distance:11; within:1; sid:100051; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA Write File Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|02|"; distance:11; within:1; sid:100052; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA ReadFile Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|03|"; distance:11; within:1; sid:100053; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA Delete Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; sid:100054; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA RenameFile Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|05|"; distance:11; within:1; sid:100055; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA FileInfo Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|06|"; distance:11; within:1; sid:100056; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA RMS Report Add Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; sid:100057; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA RMS Report Template ReadFile Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|06|"; distance:11; within:1; sid:100058; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA RMS Report Template WriteFile Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|05|"; distance:11; within:1; sid:100059; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA RMS Report Template Add Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,534,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; sid:100060; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA RMS Report Template Rename Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,534,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|02|"; distance:11; within:1; sid:100061; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA RMS Report Template Delete Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,534,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|03|"; distance:11; within:1; sid:100062; rev:2;)
alert tcp any any -> any 12401 (msg:"IGSS SCADA STDREP Request Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 08|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; sid:100063; rev:2;)
alert tcp any any -> any 12397 (msg:"IGSS SCADA dc.exe Server Directory Traversal Arbitrary File Execution - 0x17"; flow:to_server,established; content:"|17|"; offset:12; depth:1; content:"|2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; distance:0; sid:100064; rev:3;)
alert tcp any any -> any 912 (msg:"RealFlex RealWin SCADA SCPC_TXTEVENT strcpy() Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|64 12 54 6a 10 00 00 00|"; offset:0; byte_test:4,>,200,0,relative,little; sid:100065; rev:1;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_CONNECT_FCS_LOGIN Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|01 00 01 00|"; distance:6; within:4; sid:100066; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_CADDTAG Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|05 00 01 00|"; distance:6; within:4; sid:100067; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_CDELTAG Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|05 00 02 00|"; distance:6; within:4; sid:100068; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_ADDTAGMS Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|05 00 05 00|"; distance:6; within:4; sid:100069; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_RFUSER_FCS_LOGIN Buffer Overflow"; flow:to_server,established; isdataat:59; content:"|10 23 54 67|"; offset:0; byte_test:4,>,44,0,relative,little; content:"|11 00 01 00|"; distance:6; within:4; sid:100070; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 1"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 01 00|"; distance:6; within:4; sid:100071; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 2"; flow:to_server; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 03 00|"; distance:6; within:4; sid:100072; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 3"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 08 00|"; distance:6; within:4; sid:100073; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 4"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 0A 00|"; distance:6; within:4; sid:100074; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 5"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 0B 00|"; distance:6; within:4; sid:100075; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 6"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 0D 00|"; distance:6; within:4; sid:100076; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_MISC_FCS_MSGBROADCAST Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|0F 00 01 00|"; distance:6; within:4; sid:100077; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_MISC_FCS_MSGSEND Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|0F 00 03 00|"; distance:6; within:4; sid:100078; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_CGETTAG_FCS_GETTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|02 00 0F 00|"; distance:6; within:4; sid:100079; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_CGETTAG_FCS_GETCHANNELTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|02 00 10 00|"; distance:6; within:4; sid:100080; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_CGETTAG_FCS_SETTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|04 00 12 00|"; distance:6; within:4; sid:100081; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_CGETTAG_FCS_SETCHANNELTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|04 00 13 00|"; distance:6; within:4; sid:100082; rev:2;)
alert tcp any any -> any 910 (msg:"RealFlex RealWin SCADA On_FC_SCRIPT_FCS_STARTPROG Buffer Overflow"; flow:to_server,established; isdataat:1000; content:"|10 23 54 67|"; offset:0; byte_test:4,>,1000,0,relative,little; content:"|09 00 12 00|"; distance:6; within:4; sid:100083; rev:2;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 1"; flow:to_server,established; dsize:62; content:"|b0 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 0f 00 00 ff 0f 00 00|"; sid:100084; rev:4;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 2"; flow:to_server,established; dsize:28; content:"|B2 04 00 00 FF 0F 00 00|"; sid:100085; rev:4;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 3"; flow:to_server,established; dsize:38; content:"|b5 04 00 00 00 00 00 00 00 00 00 00 00 00 ff 0f 00 00|"; sid:100086; rev:4;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 4"; flow:to_server,established; dsize:28; content:"|AE 0D 00 00 FF 0F 00 00|"; sid:100087; rev:4;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 5"; flow:to_server,established; dsize:37; content:"|bc 1b 00 00 00 00 00 00 00 00 00 00 00 ff 0f 00 00|"; sid:100088; rev:4;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0x9a08"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|9A 08|"; distance:4; within:2; isdataat:1024; sid:100089; rev:2;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0x5304"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|53 04|"; distance:4; within:2; isdataat:1024; sid:100090; rev:2;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0x04b0"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|B0 04|"; distance:4; within:2; isdataat:1024; sid:100091; rev:1;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0x04b2"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|B2 04|"; distance:4; within:2; isdataat:1024; sid:100092; rev:2;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0x04b5"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|B5 04|"; distance:4; within:2; isdataat:1024; sid:100093; rev:2;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0x7d0"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|d0 07|"; distance:4; within:2; isdataat:1024; sid:100094; rev:1;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0xdae"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|ae 0d|"; distance:4; within:2; isdataat:1024; sid:100095; rev:1;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0xfa4"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|a4 0f|"; distance:4; within:2; isdataat:1024; sid:100096; rev:1;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0xfa7"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|a7 0f|"; distance:4; within:2; isdataat:1024; sid:100097; rev:1;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0x1bbc"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|bc 1b|"; distance:4; within:2; isdataat:1024; sid:100098; rev:1;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0x1c84"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|84 1c|"; distance:4; within:2; isdataat:1024; sid:100099; rev:1;)
alert tcp any any -> any 38080 (msg:"Iconics Genesis SCADA Integer Overflow 0x26ac"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|ac 26|"; distance:4; within:2; isdataat:1024; sid:100100; rev:1;)
alert tcp any any -> any 7580 (msg:"Siemens Tecnomatix FactoryLink CSService CSMSG path Buffer Overflow"; flow:to_server,established; content:"LEN|00|"; depth:6; byte_test:4,>,1028,0,little,relative; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 06  00 00 00 03  06|"; distance:0; byte_test:4,>,1024,0,big,relative; sid:100101; rev:4;)
alert tcp any any -> any 7579 (msg:"Siemens Tecnomatix FactoryLink vrn.exe opcode 10 buffer overflow"; flow:to_server,established; content:"|ff 55 0a 00|"; offset:4; depth:4; byte_test:4,>,512,2,relative,little; content:"|01 00|"; distance:8; within:2; content:"|01 00 01 00|"; distance:16; within:4; sid:100105; rev:3;)
alert tcp any any -> any 7579 (msg:"Siemens Tecnomatix FactoryLink vrn.exe opcode 9 buffer overflow"; flow:to_server,established; content:"|ff 55 09 00|"; offset:4; depth:4; byte_test:4,>,512,2,relative,little; content:"|01 00|"; distance:8; within:2; content:"|01 00 01 00|"; distance:16; within:4; sid:100107; rev:2;)
alert tcp any any -> any 7579 (msg:"Siemens Tecnomatix FactoryLink vrn.exe opcode 8 arbitrary file download"; flow:to_server; content:"|ff 55 08 00|"; offset:4; depth:4; byte_test:4,>,512,2,relative,little; content:"|01 00|"; distance:8; within:2; content:"|01 00 01 00|"; distance:16; within:4; pcre:"/^..([A-Z]\x3a[\x5c\x2f]|\x2e\x2e[\x5c\x2f]|[\x5c\x2f]{2}(\x3f[\x5c\x2f])?([A-Z]\x3a[\x5c\x2f])?)/Rsi"; sid:100109; rev:2;)
alert tcp any any -> any any (msg:"Bacnet OPC Client Malicious .csv File Detected"; flow:established; content:"OPC_TAG_NAME,OBJECT_TYPE,INSTANCE,OBJECT_NAME"; content:"|0A 5C|"; distance:0; within:3; sid:100111; rev:3;)
alert udp any any -> any 48899 (msg:"Beckhoff TwinCAT Denial of Service Invalid Read Access"; dsize:>512; content:"|03 66 14 71|"; depth:4; content:"|ff ff ff ff|"; distance:16; within:4; sid:100112; rev:4;)
alert tcp any any -> any 4446 (msg:"Rockwell RSLogix Denial of Service Trigger 1"; flow:to_server,established; content:"rna|F2 FF FF FF FF|"; sid:100113; rev:1;)
alert tcp any any -> any 4446 (msg:"Rockwell RSLogix Denial of Service Trigger 2"; flow:to_server,established; content:"rna|F2 FF FF FF 7F|"; sid:100114; rev:1;)
alert tcp any any -> any 2001 (msg:"Sunway ForceControl SNMP NetDBServer Integer Signedness Buffer Overflow"; flow:to_server,established; content:"|eb 50 eb 50 57 00|"; depth:6; byte_test:1,>,0x20,12; sid:100115; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"PcVue Activex Control Insecure method (AddPage)"; flow:to_client,established; file_data; content:"<OBJECT "; nocase; distance:0; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"083B40D3-CCBA-11D2-AFE0-00C04F7993D6"; nocase; distance:0; content:".AddPage"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*083B40D3-CCBA-11D2-AFE0-00C04F7993D6/si"; sid:100116; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"PcVue Activex Control Insecure method (DeletePage)"; flow:to_client,established; file_data; content:"<OBJECT "; nocase; distance:0; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"083B40D3-CCBA-11D2-AFE0-00C04F7993D6"; nocase; distance:0; content:".DeletePage"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*083B40D3-CCBA-11D2-AFE0-00C04F7993D6/si"; sid:100117; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"PcVue Activex Control Insecure method (SaveObject)"; flow:to_client,established; file_data; content:"<OBJECT "; nocase; distance:0; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"2BBD45A5-28AE-11D1-ACAC-0800170967D9"; nocase; distance:0; content:".SaveObject"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*2BBD45A5-28AE-11D1-ACAC-0800170967D9/si"; sid:100118; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"PcVue Activex Control Insecure method (LoadObject)"; flow:to_client,established; file_data; content:"<OBJECT "; nocase; distance:0; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"2BBD45A5-28AE-11D1-ACAC-0800170967D9"; nocase; distance:0; content:".LoadObject"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*2BBD45A5-28AE-11D1-ACAC-0800170967D9/si"; sid:100119; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"PcVue Activex Control Insecure method (GetExtendedColor)"; flow:to_client,established; file_data; content:"<OBJECT "; nocase; distance:0; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"2BBD45A5-28AE-11D1-ACAC-0800170967D9"; nocase; distance:0; content:".GetExtendedColor"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*2BBD45A5-28AE-11D1-ACAC-0800170967D9/si"; sid:100120; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Sunway ForceControl Activex Control Insecure clsid access 1"; flow:to_client,established; file_data; content:"<OBJECT "; nocase; distance:0; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"BD9E5104-2F20-4A9F-AB14-82D558FF374E"; nocase; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*BD9E5104-2F20-4A9F-AB14-82D558FF374E/si"; sid:100121; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Sunway ForceControl Activex Control Insecure clsid access 2"; flow:to_client,established; file_data; content:"<OBJECT "; nocase; distance:0; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"3310FA24-A027-47B3-8C49-1091077317E9"; nocase; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3310FA24-A027-47B3-8C49-1091077317E9/si"; sid:100122; rev:4;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsys PROMOTIC ActiveX Control Insecure method (GetPromoticSite)"; flow:established,to_client; file_data; content:"<OBJECT "; nocase; distance:0; content:"classid"; nocase; distance:0; content:"clsid"; nocase; distance:0; content:"19BA6EE6-4BB4-11D1-8085-0020AFC8C4AF"; nocase; distance:0; content:".GetPromoticSite"; nocase; distance:0; sid:100123; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsys PROMOTIC ActiveX Control Insecure method (SaveCfg)"; flow:to_client,established; file_data; content:"<OBJECT "; nocase; distance:0; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"02000002-9DFA-4B37-ABE9-1929F4BCDEA2"; nocase; distance:0; content:".SaveCfg"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*02000002-9DFA-4B37-ABE9-1929F4BCDEA2/si"; sid:100124; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsys PROMOTIC ActiveX Control Insecure method (AddTrend)"; flow:to_client,established; file_data; content:"<OBJECT "; nocase; distance:0; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"02000002-9DFA-4B37-ABE9-1929F4BCDEA2"; nocase; distance:0; content:".AddTrend"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*02000002-9DFA-4B37-ABE9-1929F4BCDEA2/si"; sid:100125; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"Siemens Automation License Manager Service almaxcx.dll files overwriting via ActiveX component"; flow:to_client,established; file_data; content:"E57AF4A2-EF57-41D0-8512-FECDA78F1FE7"; distance:0; content:".Save"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*E57AF4A2-EF57-41D0-8512-FECDA78F1FE7/si"; sid:100126; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"Siemens Automation License Manager Service almaxcx.dll files overwriting via ActiveX component 2"; flow:to_client,established; file_data; content:"ALMListView.ALMListCtrl"; nocase; distance:0; content:"|2e|Save"; distance:0; pcre:"/(ActiveXObject|CreateObject)\s*\(\s*(\x22|\x27)ALMListView\.ALMListCtrl/i"; sid:100127; rev:4;)
alert tcp any any -> any 20222 (msg:"IGSS 8 ODBC Server Multiple Remote Uninitialized Pointer Free DoS"; flow:established,to_server; flowbits:isset,ETPRO.IGSS.DoS; content:"|16|"; offset:4; depth:1; byte_jump:4,0; byte_test:4,>,0x7ffdefff,0,relative; sid:100129; rev:2;)
alert tcp any any -> any 4410 (msg:"Siemens Automation License Manager Service Exception attempt 1"; flow:to_server,established; content:"<|00|?|00|x|00|m|00|l|00 20 00|"; nocase; content:"w|00|o|00|r|00|k|00|s|00|t|00|a|00|t|00|i|00|o|00|n|00 20 00|N|00|A|00|M|00|E|00 3d 00 22 00|"; isdataat:1024,relative; content:!"|00 22 00 2f 00 3e 00|"; within:1024; sid:100130; rev:8;)
alert tcp any any -> any 4410 (msg:"Siemens Automation License Manager Service *_licensekey serialid code execution"; flow:to_server,established; content:"<|00|?|00|x|00|m|00|l|00 20 00|"; nocase; content:"<|00|s|00|e|00|r|00|i|00|a|00|l|00|i|00|d|00|>"; distance:0; isdataat:400,relative; content:!"<|00|/|00|s|00|e|00|r|00|i|00|a|00|l|00|i|00|d|00|>"; within:400; sid:100131; rev:4;)
alert tcp any any -> any 4410 (msg:"Siemens Automation License Manager Service Exception attempt 2"; flow:to_server,established; content:"<|00|?|00|x|00|m|00|l|00 20 00|"; nocase; content:"V|00|E|00|R|00|S|00|I|00|O|00|N|00 3d 00 22 00|"; isdataat:1024,relative; content:!"|00 22 00 3e 00|"; within:1024; sid:100132; rev:5;)
alert tcp any any -> any 44818 (msg:"Rockwell Automation ControlLogix Denial of Service (CPU Stop)"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 02 00 02 00 00 00 00 00 b2 00 1a 00 52 02 20 06 24 01 03 f0 0c 00 07 02 20 64 24 01 DE AD BE EF CA FE 01 00 01 00|"; distance:0; sid:100133; rev:5;)
alert tcp any any -> any 44818 (msg:"Rockwell Automation ControlLogix Denial of Service (Crash CPU)"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 02 00 02 00 00 00 00 00 b2 00 1a 00 52 02 20 06 24 01 03 f0 0c 00 0a 02 20 02 24 01 f4 f0 09 09 88 04 01 00 01 00|"; distance:0; sid:100134; rev:4;)
alert tcp any any -> any 44818 (msg:"Rockwell Automation ControlLogix EtherNET/IPmodules boot code dump"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 00 04 02 00 00 00 00 00 b2 00 08 00 97 02 20 c0 24 00 00 00|"; distance:0; sid:100135; rev:6;)
alert tcp any any -> any 44818 (msg:"Rockwell Automation ControlLogix EtherNET/IPreset command Denial Of Service"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 00 04 02 00 00 00 00 00 b2 00 08 00 05 03 20 01 24 01 30 03|"; distance:0; sid:100136; rev:5;)
alert tcp any any -> any 44818 (msg:"Rockwell Automation ControlLogix EtherNET/IPInitialize the device to update the firmware"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 05 00 02 00 00 00 00 00 b2 00 16 00 4b 02 20 a1 24 01 05 99 07 00 4f 02 20 37 24 c8 00 00 01 00 01 00|"; distance:0; sid:100137; rev:4;)
alert tcp any any -> any 44818 (msg:"Rockwell Automation ControlLogix Crash 1756-ENBT module"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 20 00 02 00 00 00 00 00 b2 00 0c 00 0e 03 20 f5 24 01 10 43 24 01 10 43|"; distance:0; sid:100138; rev:5;)
alert tcp any 54321 -> any any (msg:"MOXA Device Manager Tool 2.1 Buffer Overflow"; flow:from_server,established; content:"|28 10 00 29|"; depth:4; isdataat:475,relative; content:"|a7 bc 16 10|"; distance:475; sid:100139; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"ScadaTEC ScadaPhone <= v5.3.11.1230 Stack Buffer Overflow"; flow:from_server,established; file_data; content:"|50 4B 03 04 14 00|"; within:6; byte_test:2,>,0xc8,20,relative,little; content:"|f4 14 40 00|"; distance:300; within:32; sid:100140; rev:1;)
alert tcp any any -> any 21 (msg:"Schneider Modicon Quantum PLC login names and passwords retrieval 1"; flow:established,to_server; content:"get /FLASH0/userlist.dat"; nocase; sid:100141; rev:2;)
alert tcp any any -> any 21 (msg:"Schneider Modicon Quantum PLC login names and passwords retrieval 2"; flow:established,to_server; content:"get /FLASH0/ftp/ftp.ini"; nocase; sid:100142; rev:2;)
alert tcp any any -> any 21 (msg:"Schneider Modicon Quantum PLC login names and passwords retrieval 3"; flow:established; content:"get /FLASH0/rdt/password.rde"; nocase; sid:100143; rev:1;)
alert udp any any -> any 69 (msg:"General Electric D20 Password Recovery via TFTP"; content:"|00 01|"; depth:2; content:"NVRAM"; nocase; distance:0; content:"D20.zlb"; within:9; nocase; sid:100144; rev:4;)
alert tcp any any -> any 46824 (msg:"Sielco Sistemi Winlog DbiSetToRecordNo code execution"; flow:to_server,established; content:"|15 e6 56 36 00 e6 56 36 00|"; offset:20; depth:9; isdataat:119,relative; sid:100145; rev:1;)
alert tcp any any -> any 46824 (msg:"Sielco Sistemi Winlog Db TDataSet Close qqrv code execution"; flow:to_server,established; content:"|17 e6 56 36 00 ea 56 36 00 ce 55 36 00|"; offset:20; depth:13; isdataat:119,relative; sid:100146; rev:2;)
alert tcp any any -> any 46824 (msg:"Sielco Sistemi Winlog DbiSetToRecordNo code execution op 1e"; flow:to_server,established; content:"|1e 11 11 11 11 e6 56 36 00|"; offset:20; depth:9; isdataat:119,relative; sid:100147; rev:1;)
alert tcp any any -> any 46824 (msg:"Sielco Sistemi Winlog DbiSetToRecordNo code execution op 28"; flow:to_server,established; content:"|28 11 11 11 11 e6 56 36 00|"; offset:20; depth:9; isdataat:119,relative; sid:100148; rev:1;)
alert tcp any any -> any 46824 (msg:"Sielco Sistemi Winlog DbiSetToRecordNo code execution op 32"; flow:to_server,established; content:"|32 11 11 11 11 e6 56 36 00|"; offset:20; depth:9; isdataat:119,relative; sid:100149; rev:2;)
alert tcp any any -> any 46824 (msg:"Sielco Sistemi Winlog DbiSetToRecordNo code execution op 3c"; flow:to_server,established; content:"|3c 11 11 11 11 e6 56 36 00|"; offset:20; depth:9; isdataat:119,relative; sid:100150; rev:1;)
alert tcp any any -> any 46824 (msg:"Sielco Sistemi Directory traversal opcode 78 "; flow:to_server,established; content:"|78 2e 2e 2f 2e 2e 2f 2e 2e 2f|"; offset:20; depth:10; isdataat:119,relative; sid:100151; rev:2;)
alert tcp any any -> any 46824 (msg:"Sielco Sistemi Winlog TCP/IP server buffer overflow"; flow:to_server,established; content:"|15 e6 56 36 00 7a 55 36 00 f2 56 36 00 88 88 88 88|"; offset:20; depth:17; isdataat:119,relative; sid:100152; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"Sinapsi eSolar Light Photovoltaic System Monitor SQL Injection 1"; flow:established,to_server; content:"/dettagliinverter.php?"; content:"&inverterselect="; pcre:"/\/dettagliinverter.php\?.+?&inverterselect=.+?(SELECT|UPDATE|DELETE).+?FROM/Ui"; sid:100153; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"Sinapsi eSolar Light Photovoltaic System Monitor SQL Injection 2"; flow:established,to_server; content:"POST"; http_method; content:"/changelanguagesession.php"; content:"lingua="; http_client_body; pcre:"/lingua\x3d.+?(SELECT|UPDATE|DELETE).+?FROM/Pi"; sid:100154; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"Sinapsi eSolar Light Photovoltaic System Monitor Login with hard coded account"; flow:established,to_server; content:"POST"; http_method; content:"/login.php"; content:"password=36e44c9b64"; http_client_body; sid:100155; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"Sinapsi eSolar Light Photovoltaic System Monitor arbitrary command execution"; flow:established,to_server; content:"POST"; http_method; content:"/ping.php"; content:"ip_dominio="; http_client_body; pcre:"/ip_dominio\x3d.+?\s+?%(26|3b)/Pi"; sid:100156; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"Siemens Simatic RF-Manager ActiveX Control Insecure clsid access 1"; flow:to_client,established; file_data; content:"9EB8768B-CDFA-44DF-8F3E-857A8405E1DB"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*9EB8768B-CDFA-44DF-8F3E-857A8405E1DB"/si"; sid:100157; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"Siemens Simatic RF-Manager ActiveX Control Insecure clsid access 2"; flow:to_client,established; file_data; content:"8569D715-FF88-44BA-8D1D-AD3E59543DDE"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*8569D715-FF88-44BA-8D1D-AD3E59543DDE"/si"; sid:100158; rev:1;)
alert tcp any any -> any 7131 (msg:"IntegraXor Stack Buffer Overflow"; flow:to_server,established; content:"/res?"; fast_pattern; content:".dll/"; distance:0; isdataat:261,relative; pcre:"/\/res\?[^\n]+?\.dll\/[^\n]{261}/"; sid:100159; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"Broadwin WebAccess ActiveX Control Insecure method (WriteTextData or CloseFile) 1"; flow:established,to_client; file_data; content:"5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C"; fast_pattern:only; pcre:"/(<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C.*\.(WriteTextData|CloseFile))|(\.(WriteTextData|CloseFile).*<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C)/sim"; sid:100160; rev:10;)
alert tcp any $HTTP_PORTS -> any any (msg:"Broadwin WebAccess ActiveX Control Insecure method (OcxSpool)"; flow:established,to_client; file_data; content:"5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>|\x2F)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C\s*}?\s*(?P=q1)(\s|>|\x2F).*(?P=id1)\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar1>\x22|\x27|)(\x25[dlnpsx])+|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C\s*}?\s*(?P=q2)(\s|>|\x2F)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>|\x2F).*(?P=id2)\.OcxSpool\s*\x28\s*(?P<quoteVar2>\x22|\x27|)(\x25[dlnpsx])+)/siO"; sid:100161; rev:9;)
alert tcp any any -> any [80,808] (msg:"Progea Movicon PowerHMI EIDP over HTTP memory corruption attempt"; flow:to_server,established; content:"|0d 0a 0d 0a|EIDP"; byte_test:4,>,0x7FFFFFFF,16,little,relative; sid:100162; rev:8;)
alert tcp any any -> any $HTTP_PORTS (msg:"Siemens Simatic HMI Administrator cookie detected"; flow:to_server,established; content:"EAAAAPiZE5314QWTlkMUFedwxt0qYWRtaW5pc3RyYXRvcio"; content:"EAAAAPiZE5314QWTlkMUFedwxt0qYWRtaW5pc3RyYXRvcio"; http_cookie; sid:100163; rev:5;)
alert tcp any $HTTP_PORTS -> any any (msg:"Broadwin WebAccess ActiveX Control Insecure method (OcxSpool) 2"; flow:established,to_client; file_data; content:"BWOCXRUN.BwocxrunCtrl.1"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar1>\x22|\x27|)(\x25[dlnpsx])+|.*(?P=v)\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar2>\x22|\x27|)(\x25[dlnpsx])+)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\)(\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar3>\x22|\x27|)(\x25[dlnpsx])+|.*(?P=n)\s*\.\s*OcxSpool\s*\x28\s*(?P<quoteVar4>\x22|\x27|)(\x25[dlnpsx])+)/smiO"; sid:100164; rev:5;)
alert tcp any $HTTP_PORTS -> any any (msg:"Broadwin WebAccess ActiveX Control Insecure method (WriteTextData or CloseFile) 2"; flow:established,to_client; file_data; content:"BWOCXRUN.BwocxrunCtrl.1"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29|.*(?P=v)\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x22|\x27BWOCXRUN\.BwocxrunCtrl\.1(\.\d)?\x27)\s*\)(\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29|.*(?P=n)\s*\.\s*(WriteTextData|CloseFile)\s*\x28[^\x28]*0x[a-f0-9]+[^\x29]*\x29)/smiO"; sid:100165; rev:5;)
alert tcp any any -> any $HTTP_PORTS (msg:"NetBiter webScada Directory Transversal"; flow:to_server,established; content:"/cgi-bin/read.cgi?page="; http_uri; content:"|2E 2E 2F 2E 2E 2F|"; http_uri; distance:0; sid:100166; rev:3;)
alert tcp any any -> any $HTTP_PORTS (msg:"NetBiter webScada User Information Disclosure"; flow:to_server,established; content:"/cgi-bin/read.cgi?file=/home/config/users.cfg"; sid:100167; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"ICONICS WebHMI ActiveX Insecure method (SetActiveXGUID) 1"; flow:to_client,established; file_data; content:"D25FCAFC-F795-4609-89BB-5F78B4ACAF2C"; nocase; distance:0; content:"SetActiveXGUID"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*D25FCAFC-F795-4609-89BB-5F78B4ACAF2C/si"; sid:100168; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"ICONICS WebHMI ActiveX Insecure method (SetActiveXGUID) 2"; flow:to_client,established; file_data; content:"CEFF5F48-BD2E-4D10-BAE5-AF729975E223"; nocase; distance:0; content:"SetActiveXGUID"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*CEFF5F48-BD2E-4D10-BAE5-AF729975E223/si"; sid:100169; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 33) Change Date Attempt"; flow:established; dsize:42; content:"|01460741|"; offset:28; depth:4; sid:100170; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 32) Change Time Attempt"; flow:established; dsize:42; content:"|01460741|"; offset:28; depth:4; sid:100171; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 11) Unlock PLC Attempt"; flow:established; dsize:44; content:"|01460915|"; offset:28; depth:4; sid:100172; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 10) Lock PLC Attempt 1"; flow:established; dsize:45; content:"|01460a1402|"; offset:28; depth:5; sid:100173; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 10) Lock PLC Attempt 2"; flow:established; dsize:45; content:"|01460a1403|"; offset:28; depth:5; sid:100174; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 10) Lock PLC Attempt 3"; flow:established; dsize:45; content:"|01460a1401|"; offset:28; depth:5; sid:100175; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 12) Remote Mode Change Attempt 1"; flow:established; dsize:37; content:"|0145020100|"; offset:28; depth:5; sid:100176; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 12) Remote Mode Change Attempt 2"; flow:established; dsize:37; content:"|0145020101|"; offset:28; depth:5; sid:100177; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 12) Remote Mode Change Attempt 3"; flow:established; dsize:37; content:"|0145020102|"; offset:28; depth:5; sid:100178; rev:1;)
alert tcp any any -> any 502 (msg:"CONTROL MICROSYSTEMS (Event 49) Request Controller ID"; flow:established; dsize:10; content:"|0401460117|"; sid:100179; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 39) IP Address Change Attempt"; flow:established; dsize:53; content:"|01461036|"; offset:28; depth:4; sid:100180; rev:1;)
alert tcp any 502 -> any any (msg:"CONTROL MICROSYSTEMS (Event 20) Function Not Available Error"; flow:established; dsize:9; content:"|01|"; offset:8; depth:1; sid:100181; rev:1;)
alert tcp any 502 -> any any (msg:"CONTROL MICROSYSTEMS (Event 21) Point Not Available Error"; flow:established; dsize:9; content:"|02|"; offset:8; depth:1; sid:100182; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 26) Flash Erase"; flow:established; content:"|01410a000000|"; offset:28; depth:6; sid:100183; rev:1;)
alert tcp any any -> any 502 (msg:"CONTROL MICROSYSTEMS (Event 27) Firmware Change"; flow:established; dsize:11; content:"|41050000|"; offset:7; depth:4; sid:100184; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 29) Software Upload"; flow:established; content:"|0146|"; offset:28; depth:2; content:"|22|"; distance:31; within:1; sid:100185; rev:2;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 41) Config File Change"; flow:established; content:"|0146|"; offset:28; depth:2; content:"|14|"; distance:31; within:1; sid:100186; rev:2;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS Potential SW Download Event"; flow:established; content:"|0146|"; offset:28; depth:2; content:"|03|"; distance:31; within:1; flowbits:set,spdown; flowbits:noalert; sid:100187; rev:2;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 45) Software Download"; flow:established; flowbits:isset,spdown; sid:100188; rev:2;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 22) Remote Diagnostic Self Test"; flow:established; content:"|01460173|"; offset:28; depth:4; sid:100189; rev:2;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 38) Control Protocol Change Attempt"; flow:established; content:"|01460d4d01|"; offset:28; depth:5; sid:100190; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 40) TCP UDP Port Change Attempt"; flow:established; content:"|01460d4d01|"; offset:28; depth:5; sid:100191; rev:1;)
alert tcp any any -> any 20000 (msg:"CONTROL MICROSYSTEMS (Event 36) Change Port Configuration Attempt"; flow:established; content:"|01461501|"; offset:28; depth:4; content:"|08|"; distance:33; within:1; sid:100192; rev:2;)
alert udp any 20000 -> any 20000 (msg:"GE (Event 24) View Device Status"; dsize:15; content:"|0564|"; depth:2; content:"|c4|"; distance:3; within:1; content:"|01|"; distance:12; within:1; sid:100193; rev:2;)
alert udp any 20000 -> any 20000 (msg:"GE (Event 32) Change Time Attempt"; dsize:25; content:"|0564|"; depth:2; content:"|c4|"; distance:3; within:1; content:"|02320107|"; distance:12; within:4; sid:100194; rev:2;)
alert udp any 20000 -> any 20000 (msg:"GE (Event 33) Change Date Attempt"; dsize:25; content:"|0564|"; depth:2; content:"|c4|"; distance:3; within:1; content:"|02320107|"; distance:12; within:4; sid:100195; rev:2;)
alert udp any any -> any 69 (msg:"GE (Event 41) Config File Change"; dsize:60; content:"|00 02 4e 56 52 41 4d 5c 46 41 43 5f 44 45 46 2e 5a 4c 42 00|"; depth:20; sid:100196; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 50) Feature Request"; dsize:10; content:"|48 41 50|"; depth:3; content:"|02|"; distance:9; within:1; sid:100197; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 33) Change Date Attempt"; dsize:29; content:"|48 41 50|"; depth:3; content:"|1a 00 10|"; distance:9; within:3; sid:100198; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 32) Change Time Attempt"; dsize:29; content:"|48 41 50|"; depth:3; content:"|1a 00 10|"; distance:9; within:3; sid:100199; rev:2;)
alert udp any any -> any any (msg:"DIRECTLOGIC (Event 39) IP Address Change Attempt 1"; dsize:>16; content:"|48 41 50|"; depth:3; content:"|15|"; distance:9; within:1; content:"|0c 00 36|"; distance:16; within:3; content:!"|00 00 00 00|"; distance:24; within:4; sid:100200; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 39) IP Address Change Attempt 2"; dsize:>16; content:"|48 41 50|"; depth:3; content:"|0c 00 36|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:16; within:4; sid:100201; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 10) Lock PLC Attempt 1"; dsize:26; content:"|48 41 50|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:20; within:4; content:"|17 4f|"; distance:24; within:2; sid:100202; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 10) Lock PLC Attempt 2"; dsize:26; content:"|48 41 50|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:"|ff ff ff ff 17 4f|"; distance:20; within:6; sid:100203; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 11) Unlock PLC Attempt 3"; dsize:26; content:"|48 41 50|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:"|00 00 00 00|"; distance:20; within:4; content:"|17 4f|"; distance:24; within:2; sid:100204; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 11) Unlock PLC Attempt 3"; dsize:26; content:"|48 41 50|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:20; within:4; content:"|17 3c|"; distance:24; within:2; sid:100205; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 31) Reboot or Restart 1"; dsize:10; content:"|48 41 50|"; depth:3; content:"|fa|"; distance:9; within:1; sid:100206; rev:2;)
alert udp any any -> any any (msg:"DIRECTLOGIC (Event 47) Device Poll All"; dsize:10; content:"|48 41 41|"; depth:3; content:"|05|"; distance:9; within:1; sid:100207; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 50) Feature Request"; dsize:10; content:"|48 41 41|"; depth:3; content:"|02|"; distance:9; within:1; sid:100208; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 32) Change Time Attempt"; dsize:29; content:"|48 41 41|"; depth:3; content:"|1a 00 10|"; distance:9; within:3; sid:100209; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 33) Change Date Attempt"; dsize:29; content:"|48 41 41|"; depth:3; content:"|1a 00 10|"; distance:9; within:3; sid:100210; rev:2;)
alert udp any any -> any any (msg:"DIRECTLOGIC (Event 39) IP Address Change Attempt 1"; dsize:>16; content:"|48 41 41|"; depth:3; content:"|15|"; distance:9; within:1; content:"|0c 00 36|"; distance:16; within:3; content:!"|00 00 00 00|"; distance:24; within:4; sid:100211; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 39) IP Address Change Attempt 2"; dsize:>16; content:"|48 41 41|"; depth:3; content:"|0c 00 36|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:16; within:4; sid:100212; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 10) Lock PLC Attempt 1"; dsize:26; content:"|48 41 41|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:20; within:4; content:"|17 4f|"; distance:24; within:2; sid:100213; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 10) Lock PLC Attempt 2"; dsize:26; content:"|48 41 41|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:"|ff ff ff ff 17 4f|"; distance:20; within:6; sid:100214; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 11) Unlock PLC Attempt 1"; dsize:26; content:"|48 41 41|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:"|00 00 00 00|"; distance:20; within:4; content:"|17 4f|"; distance:24; within:2; sid:100215; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 11) Unlock PLC Attempt 2"; dsize:26; content:"|48 41 41|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:20; within:4; content:"|17 3c|"; distance:24; within:2; sid:100216; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 31) Reboot or Restart 2"; dsize:10; content:"|48 41 41|"; depth:3; content:"|fa|"; distance:9; within:1; sid:100217; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 12) Remote Mode Change Attempt 1"; dsize:23; content:"|48 41 50|"; depth:3; content:"|1a 00 0a 00 01 51 01 15 02 01 00|"; distance:9; within:11; sid:100218; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 12) Remote Mode Change Attempt 2"; dsize:23; content:"|48 41 41|"; depth:3; content:"|1a 00 0a 00 01 51 01 15 02 01 00|"; distance:9; within:11; sid:100219; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 26) Flash Erase 1"; dsize:>100; content:"|48 41 50|"; depth:3; content:"|19 00 01 20|"; distance:9; within:4; content:"|31 00 00 00 00 00|"; distance:16; within:6; sid:100220; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 26) Flash Erase 2"; dsize:>100; content:"|48 41 41|"; depth:3; content:"|19 00 01 20|"; distance:9; within:4; content:"|31 00 00 00 00 00|"; distance:16; within:6; sid:100221; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 27) Firmware Change 1"; dsize:>100; content:"|48 41 50|"; depth:3; content:"|15|"; distance:9; within:1; content:"|f6|"; distance:16; within:1; sid:100222; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 27) Firmware Change 2"; dsize:>100; content:"|48 41 50|"; depth:3; content:"|15|"; distance:9; within:1; content:"|f2|"; distance:16; within:1; sid:100223; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 27) Firmware Change 3"; dsize:>100; content:"|48 41 41|"; depth:3; content:"|15|"; distance:9; within:1; content:"|f6|"; distance:16; within:1; sid:100224; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 27) Firmware Change 4"; dsize:>100; content:"|48 41 41|"; depth:3; content:"|15|"; distance:9; within:1; content:"|f2|"; distance:16; within:1; sid:100225; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 29) Software Upload 1"; dsize:>100; content:"|48 41 50|"; depth:3; content:"|19 00 01 20|"; distance:9; within:4; content:"|00 37|"; distance:15; within:2; sid:100226; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 29) Software Upload 2"; dsize:>100; content:"|48 41 41|"; depth:3; content:"|19 00 01 20|"; distance:9; within:4; content:"|00 37|"; distance:15; within:2; sid:100227; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 45) Software Download 1"; dsize:17; content:"|48 41 50|"; depth:3; content:"|19 00 01 1e|"; distance:9; within:4; content:"|00 37|"; distance:15; within:2; sid:100228; rev:2;)
alert udp any any -> any 28784 (msg:"DIRECTLOGIC (Event 45) Software Download 2"; dsize:17; content:"|48 41 41|"; depth:3; content:"|19 00 01 1e|"; distance:9; within:4; content:"|00 37|"; distance:15; within:2; sid:100229; rev:2;)
alert tcp any any -> any 23 (msg:"SCHWEITZER SEL2032-Device poll detected"; flow:established,to_server; content:"who|0d|"; nocase; sid:100230; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER SEL2032-Point Not Available"; flow:established,to_client; content:"The database region data is invalid"; nocase; sid:100231; rev:1;)
alert tcp any any -> any 21 (msg:"SCHWEITZER SEL2032-File Does Not Exist"; flow:established,to_client; content:"550 RETR requested action not taken"; sid:100232; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER SEL2032-Config File Change Attempt Detected"; flow:established,to_client; flowbits:set,cfgfile; flowbits:noalert; content:"Port communications settings for Port"; sid:100233; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER SEL2032-Successful Config File Change"; flow:established,to_client; flowbits:isset,cfgfile; content:"Port"; content:"Settings Changed"; sid:100234; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER SEL2032-Failed Config File Change 1"; flow:established,to_client; flowbits:isset,cfgfile; content:"Settings aborted"; sid:100235; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER SEL2032-Access Level 1 Attempted"; flow:established,to_server; content:"acc"; depth:3; nocase; pcre:"/acce{0,1}s{0,2}/i"; sid:100236; rev:2;)
alert tcp any any -> any 23 (msg:"SCHWEITZER SEL2032-Access Level 2 Attempted"; flow:established,to_server; content:"2ac"; nocase; pcre:"/ac{0,2}e{0,1}s{0,2}/i"; sid:100237; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER SEL2032-Control Protocol Change"; flow:established,to_client; flowbits:isset,cfgfile; flowbits:set,chgprot; flowbits:noalert; content:"Communications Type (S=SEL, L=LMD)"; sid:100238; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER SEL2032-Failed Config File Change 2"; flow:established,to_server; flowbits:isset,chgprot; content:"|0d|"; pcre:"/(l|s)\x0d/i"; sid:100239; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER SEL2032-Software Upload Attempt Detected"; flow:established,to_client; content:"file read"; nocase; sid:100240; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER (Event 03) Logout 1"; flow:established,to_server; content:"qui"; nocase; pcre:"/quit{0,1}\x0d/i"; sid:100243; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER (Event 03) Logout 2"; flow:established,to_server; content:"sta"; nocase; pcre:"/stat{0,1}u{0,1}s{0,1}\x0d/i"; sid:100244; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER (Event 36) Change Port Configuration Attempt"; flow:established,to_client; content:"Port"; content:"Settings Changed"; sid:100245; rev:1;)
alert tcp any any -> any 23 (msg:"SCHWEITZER (Event 41) Config File Change"; flow:established,to_client; content:"Port"; content:"Settings Changed"; sid:100246; rev:1;)
alert tcp any any -> any [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281] (msg:"Rockwell RNA Message Large Header Length - 8Kb"; flow:to_server; content:"rna|f2|"; byte_test:4,>,0x2000,0,relative,little; sid:100247; rev:2;)
alert tcp any any -> any [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281] (msg:"Rockwell RNA Message Negative Header Length"; flow:to_server; content:"rna|f2|"; byte_test:1,&,0x80,3,relative,little; sid:100248; rev:2;)
alert tcp any any -> any [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281] (msg:"Rockwell RNA Message Large Body Length - 8Mb"; flow:to_server; content:"rna|f2|"; byte_jump:4,0,relative,little; byte_test:4,>,0x800000,0,relative,little; sid:100249; rev:2;)
alert tcp any any -> any [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281] (msg:"Rockwell RNA Message Negative Body Length"; flow:to_server; content:"rna|f2|"; byte_jump:4,0,relative,little; byte_test:1,&,0x80,3,relative,little; sid:100250; rev:2;)
alert tcp any any -> any [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281] (msg:"Rockwell RNA Message Header Not Null Terminated"; flow:to_server; content:"rna|f2|"; byte_jump:4,0,relative,little; content:!"|00|"; distance:-1; within:1; sid:100251; rev:2;)
alert http any any -> any any (msg:"WEB_SERVER Microsoft SharePoint Remote File Disclosure Access"; flow:from_server,established; content:"<!ENTITY"; content:"|20|SYSTEM|20 22|"; within:10; content:"|3A 2F|"; within:15; sid:100253; rev:2;)
alert http any any -> any any (msg:"WEB_SERVER Microsoft SharePoint Remote File Disclosure Upload Inbound"; flow:to_server,established; content:"<!ENTITY"; content:"|20|SYSTEM|20 22|"; within:10; content:"|3A 2F|"; within:15; sid:100254; rev:4;)
alert http any any -> any any (msg:"WEB_SERVER Microsoft SharePoint XML Handling Remote File Disclosure (Published Exploit)"; flow:to_server,established; content:"<!ENTITY boom SYSTEM |22|c|3a 5c 5c|windows|5c 5c|system32|5c 5c|drivers|5c 5c|etc|5c 5c|hosts|22|>"; sid:100255; rev:4;)
alert http any any -> any any (msg:"BMP with invalid bfOffBits"; flow:established,to_client; content:"|0d 0a 0d 0a|BM"; fast_pattern; byte_test:4,>,14,0,relative; content:"|0000000000000000|"; distance:4; within:8; sid:100256; rev:10;)
alert http any any -> any any (msg:"CVE-2013-1331 Microsoft Office PNG Exploit plugin-detect script access"; flow:established,to_client; content:"ScriptBridge.ScriptBridge"; content:"|00|h|00|t|00|t|00|p|00 3a 00 2f 00 2f 00|"; content:"|2f 00|v|00|w|00|.|00|p|00|h|00|p|00|?|00|i|00|="; distance:0; fast_pattern; sid:100257; rev:6;)
alert http any any -> any any (msg:"Microsoft Windows Common Control Library Heap Buffer Overflow"; flow:established,from_server; content:"Content-Type|3a| image/svg|2b|xml"; nocase; content:"|3c|svg xmlns="; nocase; distance:0; content:"style|3d 22|fill|3a 20 23|ffffff|22|"; nocase; distance:0; content:"transform"; nocase; distance:0; pcre:"/^=\s*\x22\s*[^\s\x22\x28]{1000}/iR"; sid:100258; rev:8;)
alert http any any -> any any (msg:"Possible Microsoft Office Word 2007 sprmCMajority Buffer Overflow Attempt"; flow:established,to_client; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|47 CA FF|"; content:"|3E C6 FF|"; distance:0; isdataat:84,relative; content:!"|0A|"; within:84; sid:100259; rev:5;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Datime.dll ActiveX - CLSID 1"; flow:established,from_server; content:"33FDA1EA-80DF-11d2-B263-00A0C90D6111"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*33FDA1EA-80DF-11d2-B263-00A0C90D6111/i"; sid:100260; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Datime.dll ActiveX - CLSID 2"; flow:established,from_server; content:"476c391c-3e0d-11d2-b948-00c04fa32195"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*476c391c-3e0d-11d2-b948-00c04fa32195/i"; sid:100261; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Dell IT Assistant ActiveX - CLSID"; flow:established,from_server; content:"6286EF1A-B56E-48EF-90C3-743410657F3C"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*6286EF1A-B56E-48EF-90C3-743410657F3C/i"; sid:100262; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HP Easy Printer Care Software ActiveX - CLSID"; flow:established,from_server; content:"466576F3-19B6-4FF1-BD48-3E0E1BFB96E9"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*466576F3-19B6-4FF1-BD48-3E0E1BFB96E9/i"; sid:100263; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HP Photo Creative ActiveX - CLSID 1"; flow:established,from_server; content:"3EEEBC9A-580F-46EF-81D9-55510266413D"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*3EEEBC9A-580F-46EF-81D9-55510266413D/i"; sid:100264; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HP Photo Creative ActiveX - CLSID 2"; flow:established,from_server; content:"EE5E14B0-4ABF-409E-9C39-74F3D35BD85A"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*EE5E14B0-4ABF-409E-9C39-74F3D35BD85A/i"; sid:100265; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HP Photo Creative ActiveX - CLSID 3"; flow:established,from_server; content:"b34b19f4-7ebe-46cb-807c-746e72ebb4b6"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*b34b19f4-7ebe-46cb-807c-746e72ebb4b6/i"; sid:100266; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HP Photo Creative ActiveX - CLSID 4"; flow:established,from_server; content:"7a7b986c-31e9-4286-88ca-b9dc481ca989"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*7a7b986c-31e9-4286-88ca-b9dc481ca989/i"; sid:100267; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HP Photo Creative ActiveX - CLSID 5"; flow:established,from_server; content:"8290cb76-9f61-458b-ad2c-3f6fd2e8cd7d"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*8290cb76-9f61-458b-ad2c-3f6fd2e8cd7d/i"; sid:100268; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HP Photo Creative ActiveX - CLSID 6"; flow:established,from_server; content:"dd7b057d-9020-4630-baf8-7a0cda04588d"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*dd7b057d-9020-4630-baf8-7a0cda04588d/i"; sid:100269; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HP Photo Creative ActiveX - CLSID 7"; flow:established,from_server; content:"FC7F9CC6-E049-4698-8A25-59AD87C7DCE2"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*FC7F9CC6-E049-4698-8A25-59AD87C7DCE2/i"; sid:100270; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Yahoo CD Player ActiveX - CLSID"; flow:established,from_server; content:"5622772D-6C27-11D3-95E5-006008D14F3B"; nocase; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*5622772D-6C27-11D3-95E5-006008D14F3B/i"; sid:100271; rev:2;)
alert http any any -> any any (msg:"NETBIOS Microsoft Windows OLE Automation Remote Code Execution"; flow:from_server,established; flowbits:isset,ETPRO.WMF; content:"|6C 74|"; content:"|D7 CD C6 9A|"; distance:6; within:4; byte_test:4,<,0x003C,-8,relative,little; sid:100272; rev:2;)
alert http any any -> any any (msg:"CVE 2015-0042 MS15-009 IE CGeneratedSvgTreeNode UAF"; flow:established,from_server; content:"altGlyph"; fast_pattern; nocase; content:"marker"; distance:0; nocase; content:"InsertOrderedList"; distance:0; nocase; content:"document.getElementsByTagNameNS("; nocase; distance:0; pcre:"/\s*marker[^)]*\)/R"; sid:100273; rev:5;)
alert http any any -> any any (msg:"CVE 2015-0046 MS15-009 IE Type Confusion"; flow:established,from_server; content:".setAttribute("; nocase; content:"884E2049-217D-11DA-B2A4-000E7BBB2B09"; nocase; fast_pattern:6,20; distance:0; content:"document.body.swapNode("; nocase; distance:0; pcre:"/[\s]*(?P<objname>\w+?)\s*\).*?(?P=objname)\[\s*\'\s*0\s*\'/Rsi"; sid:100274; rev:8;)
alert http any any -> any any (msg:"CVE 2015-0048 MS15-009 IE UAF"; flow:established,from_server; content:"url()"; nocase; fast_pattern:only; pcre:"/document.createElement\(\s*[\x22\x27]\s*textarea\s*[\x22\x27]\s*\)/i"; pcre:"/([\s\r\n]*?\w+\.(?:dataSrc|id|innerHTML|onvolumechange)\s*=\s*1\s*\x3b){4}/si"; pcre:"/\.style\.setProperty\(\s*[\x22\x27]list-style[\x22\x27]\s*,\s*[\x22\x27]url\(\)[\x22\x27]/i"; sid:100275; rev:6;)
alert http any any -> any any (msg:"Microsoft Excel file download - SET 1"; flow:established,from_server; flowbits:isset,OLE.CompoundFile; content:"|09 08 10 00 00 06 05 00|"; content:"|57006F0072006B0062006F006F006B00|"; fast_pattern:only; flowbits:set,ETPRO.Microsoft.Excel; flowbits:noalert; sid:100276; rev:6;)
alert http any any -> any any (msg:"Microsoft Excel file download - SET 2"; flow:established,from_server; content:"|0d 0a 0d 0a D0 CF 11 E0 A1 B1 1A E1|"; content:"|09 08 10 00 00 06 05 00|"; distance:504; within:8; pcre:"/^[\x10\x1F\x22\x23\x28\x29][\x00\x02]/R"; flowbits:set,ETPRO.Microsoft.Excel; flowbits:noalert; sid:100277; rev:6;)
alert http any any -> any any (msg:"Microsoft Excel Malformed CatSerRange Record Vulnerability"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|20 10 08 00|"; byte_test:2,>,0,0,relative,little; byte_test:2,<,42000,-2,relative,little; byte_test:1,&,0x80,3,relative,little; sid:100278; rev:6;)
alert http any any -> any any (msg:"Microsoft Excel malformed Selection (type 0x1D) BIFF record"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|1D 00|"; byte_test:1,>=,0,2,relative,little; byte_test:1,<=,3,-1,relative,little; byte_test:2,>,0x559,6,relative,little; flowbits:unset,OLE.CompoundFile; sid:100279; rev:4;)
alert http any any -> any any (msg:"Microsoft Excel Malformed SupBook Record Vulnerability"; flow:from_server; flowbits:isset,ETPRO.Microsoft.Excel; content:"|AE 01 04 00|"; byte_test:2,>,300,2,relative,little; byte_test:2,<,400,2,relative,little; sid:100280; rev:4;)
alert http any any -> any any (msg:"Microsoft Excel OBJ Records Vulnerability"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|5d 00|"; content:"|15 00 12 00|"; distance:2; within:4; byte_test:2,>,0x20,0,relative,little; sid:100281; rev:4;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Anti-Cross Site Scripting Library Vulnerability 1"; flow:from_server,established; content:"style"; nocase; content:"|5c 2c 22|"; distance:0; fast_pattern; pcre:"/style\s*=[^>]*\x5c\x2c\x22/i"; sid:100282; rev:4;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via doc"; flow:from_server,established; flowbits:isset,http.doc.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; sid:100283; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via docx"; flow:from_server,established; flowbits:isset,http.docx.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; sid:100284; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via rtf"; flow:from_server,established; flowbits:isset,http.rtf.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; sid:100285; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via xls"; flow:from_server,established; flowbits:isset,http.xls.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; sid:100286; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via xlsx"; flow:from_server,established; flowbits:isset,http.xlsx.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; sid:100287; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via xlt"; flow:from_server,established; flowbits:isset,http.xlt.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; sid:100288; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Potential Use-After-Free Heap Overflow attempt (Exploit Specific)"; flow:from_server,established; content:"heapLib.ie|28|"; content:"|2e|push|28|document|2e|createElement|28 27|div|27 29 29|"; distance:0; content:"unescape|28|"; distance:0; sid:100289; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer selection.empty Use After Free"; flow:from_server,established; content:"expression"; nocase; content:"|28|document.selection.empty|28 29 29|"; within:28; sid:100290; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Time Element Memory Corruption 2"; flow:from_server,established; content:"schemas|2d|microsoft|2d|com"; content:"time"; distance:0; content:"|23|default|23|time2"; nocase; distance:0; content:"contenteditable"; distance:0; content:"true"; distance:0; pcre:"/\x3a\s*(animate|animateColor|animateMotion|set|switch|transitionFilter)/iR"; sid:100291; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption"; flow:from_server,established; flowbits:isset,http.doc.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; sid:100292; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via doc 2"; flow:from_server,established; flowbits:isset,http.doc.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge\x2eScriptBridge/i"; sid:100293; rev:4;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via docx 2"; flow:from_server,established; flowbits:isset,http.docx.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge\x2eScriptBridge/i"; sid:100294; rev:4;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via docx"; flow:from_server,established; flowbits:isset,http.docx.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; sid:100295; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via rtf 2"; flow:from_server,established; flowbits:isset,http.rtf.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge.ScriptBridge/i"; sid:100296; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via rtf"; flow:from_server,established; flowbits:isset,http.rtf.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; sid:100297; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xls 2"; flow:from_server,established; flowbits:isset,http.xls.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge\x2eScriptBridge/i"; sid:100298; rev:4;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xls"; flow:from_server,established; flowbits:isset,http.xls.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; sid:100299; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xlsx 2"; flow:from_server,established; flowbits:isset,http.xlsx.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge.ScriptBridge/i"; sid:100300; rev:5;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xlsx"; flow:from_server,established; flowbits:isset,http.xlsx.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; sid:100301; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xlt 2"; flow:from_server,established; flowbits:isset,http.xlt.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge.ScriptBridge/i"; sid:100302; rev:4;)
alert http any any -> any any (msg:"Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xlt"; flow:from_server,established; flowbits:isset,http.xlt.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; sid:100303; rev:3;)
alert http any any -> any any (msg:"Microsoft Office Powerpoint OEPlaceholderAtom placementId Parameter Handling Remote Code Execution"; flow:from_server,established; flowbits:isset,ETPRO.PPT_MAGIC; content:"|00 00 c3 0b|"; byte_test:2,=,8,0,relative,little; byte_test:2,>,7,0,relative,little; byte_test:2,<,0xffffffff,-2,relative,little; byte_test:1,>,0,0,relative,little; byte_test:1,<=,0x1a,-1,relative,little; sid:100304; rev:3;)
alert http any any -> any any (msg:"Microsoft Powerpoint TextHeaderAtom Record Attempt"; flow:from_server,established; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|0f 00 0d f0|"; content:"|00 00 9f 0f 04 00 00 00|"; distance:0; byte_test:4,>,8,0,relative,little; sid:100305; rev:3;)
alert http any any -> any any (msg:"Microsoft Windows Fax Services Cover Page Editor Double Free Memory Corruption (Published Exploit) Flowbit Set"; flow:from_server,established; flowbits:isset,ETPRO.MSCOV; content:"DrawText"; content:"|42 00 55 00 47 00 04 00 EA FE FF FF|"; nocase; sid:100306; rev:4;)
alert http any any -> any any (msg:"Microsoft Windows LNK File Code Execution"; flow:from_server,established; content:"|0a 4C 00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46|"; content:"|20 20 EC 21 EA 3A 69 10 A2 DD 08 00 2B 30 30 9D|"; distance:0; sid:100307; rev:3;)
alert http any any -> any any (msg:"MS15-018 Internet Explorer Elevation of Privilege Vulnerability CVE-2015-1622"; flow:from_server,established; content:"url(data|3a|text/plain,"; fast_pattern:only; content:"document.body.appendChild(document.createElement("; nocase; content:"body.offsetTop"; content:"text/css|22|>"; pcre:"/[^/]*#(?P<id>\w+)\s+{\s*display:\s*list-item\s*\x3b\s*}[^/]*#(?P=id):after[^}]+block[^}]+content:\s*url\(data:text\/plain.*\.appendChild\(document.createElement.*\.id\s*=\s*\x22?(?P=id).*?body.offsetTop/Rsi"; sid:100308; rev:4;)
alert http any any -> any any (msg:"MS15-018 Internet Explorer Elevation of Privilege Vulnerability CVE-2015-1623"; flow:from_server,established; content:"MutationObserver("; fast_pattern:only; content:"childList"; content:"characterData"; content:"characterDataOldValue"; content:"location.reload()"; content:"text/javascript"; pcre:"/[^/]*var\s+(?P<mo_name>[^ =]+)\s*=\s*new\s*MutationObserver\(\s*function\(\s*\).*(?P=mo_name).observe\(.*\.insertAdjacentText\((?:\x22|\x27)\s*afterEnd.*]\.replaceNode\(.*document.getSelection\(\).*\.adoptNode\(/Rsi"; sid:100309; rev:3;)
alert http any any -> any any (msg:"MSIE Layout Memory Corruption Attack 2"; flow:from_server,established; content:"|2e|layoutgridchar"; nocase; pcre:"/\s*\x3d\s*\x22[1-9][0-9]{4}/Ri"; sid:100310; rev:3;)
alert http any any -> any any (msg:"Possible CVE-2015-0018 MS15-009 IE UAF"; flow:established,from_server; content:"onload=document.write(|22 22|)"; nocase; fast_pattern:only; pcre:"/<script[^\w]{2,}?\/script>.*<\/\s*head/is"; pcre:"/<embed[^\w]{2,}?\/\s*embed>/i"; sid:100311; rev:4;)
alert http any any -> any any (msg:"Possible CVE-2015-0036 MS15-009 IE Index OOB"; flow:established,from_server; content:"dximagetransform.microsoft.shadow"; nocase; fast_pattern:only; pcre:"/direction\s*=\s*(?:[2][1-9]\d{8}|[3-9]\d{9}|\d{11}})/"; sid:100312; rev:7;)
alert http any any -> any any (msg:"Possible CVE-2015-0039 MS15-009 IE UAF"; flow:established,to_client; content:"msHyphens"; nocase; fast_pattern:only; content:"outlineStyle"; nocase; content:"inherit"; nocase; pcre:"/\.style\[\s*[\x22\x27]\s*msHyphens\s*[\x22\x27]\s*\]\s*=\s*[\x22\x27]\s*auto/i"; pcre:"/\.style\[\s*[\x22\x27]\s*outlineStyle\s*[\x22\x27]\s*\]\s*=\s*[\x22\x27]\s*ridge/i"; pcre:"/\.replaceAdjacentText\(\s*[\x22\x27]\s*afterBegin\s*[\x22\x27]\s*,\s*[\x22\x27]\s*inherit/i"; sid:100313; rev:5;)
alert http any any -> any any (msg:"Windows Media ASF File Download SET"; flow:established,from_server; flowbits:set,ETPRO.MS_ASF; flowbits:noalert; content:"|30 26 B2 75 8E 66 CF 11 A6 D9 00 AA 00 62 CE 6C|"; sid:100314; rev:4;)
alert http any any -> any any (msg:"Windows Media Remote Code Execution"; flow:established,from_server; flowbits:isset,ETPRO.MS_ASF; content:"|B7 BE 35 11 39 3A 8A 47 98 D9 15 C7 6B 00 EB 69|"; sid:100315; rev:2;)
alert http any any -> any any (msg:"Internet Explorer CTableRowCellsCollectionCacheItem.GetNext Memory Use-After-Free Attempt"; flow:established,to_client; content:"document.getElementById|28 27|tableid|27 29|.cloneNode"; nocase; content:"cells.urns"; nocase; distance:0; content:"cells.item"; nocase; distance:0; sid:100316; rev:3;)
alert http any any -> any any (msg:"PNG large colour depth download attempt"; flow:from_server,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:1,>,16,8,relative; sid:100317; rev:5;)
alert http any any -> any any (msg:"WEB_SERVER Microsoft Report Viewer control Cross-Site Scripting 2"; flow:established,to_server; content:"POST"; http_method; content:"ReportViewerWebControl.axd"; content:"TimerMethod"; http_client_body; pcre:"/TimerMethod\x3d.+(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|alert|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange|style\x3D)/i"; sid:100318; rev:3;)
alert http any any -> any any (msg:"WEB_SERVER Microsoft Report Viewer control Cross-Site Scripting"; flow:established,to_server; content:"ReportViewerWebControl.axd"; content:"TimerMethod"; pcre:"/TimerMethod\x3d.+(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|alert|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange|style\x3D)/Ui"; sid:100319; rev:8;)
alert http any any -> any any (msg:"NTLM ASN.1 vulnerability scan attempt"; flow:to_server,established; content:"Authorization|3A| Negotiate YIQAAABiBoMAAAYrBgEFBQKgggBTMIFQoA4wDAYKKwYBBAGCNwICCqM"; http_header; sid:100320; rev:11;)
alert http any any -> any $HTTP_PORTS (msg:"WEB_SERVER Microsoft SharePoint Server 2007 _layouts/help.aspx Cross Site Scripting Attempt"; flow:established,to_server; uricontent:"/_layouts/help.aspx"; nocase; uricontent:"cid0="; nocase; pcre:"/cid0\x3d.+(script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange)/Ui"; sid:100321; rev:5;)
alert http any $HTTP_PORTS -> any any (msg:"Possible Internet Explorer srcElement Memory Corruption Attempt"; flow:established,to_client; content:"document.createEventObject"; nocase; content:".innerHTML"; within:100; nocase; content:"window.setInterval"; distance:0; nocase; content:"srcElement"; fast_pattern; nocase; distance:0; sid:100322; rev:5;)
alert http any any -> any any (msg:"CVE-2013-1331 Microsoft Office PNG Exploit plugin-detect script access"; flow:established,from_client; content:"/vw.php?i="; fast_pattern:only; pcre:"/\/vw\.php\?i=[a-fA-F0-9]+?\-[a-fA-F0-9]+?$/U"; sid:100323; rev:6;)
alert http any any -> any any (msg:"Microsoft Word mso.dll LsCreateLine Memory Corruption (Published Exploit) DOC DOWNLOAD"; flow:to_server,established; content:"GET"; http_method; nocase; content:".doc"; fast_pattern:only; nocase; pcre:"/\.doc$/Ui"; flowbits:set,http.doc.download; flowbits:noalert; sid:100324; rev:3;)
alert http any any -> any any (msg:"NETBIOS Microsoft Windows OLE Automation Remote Code Execution SET"; flow:to_server,established; content:".wmf"; nocase; flowbits:set,ETPRO.WMF; flowbits:noalert; sid:100325; rev:2;)
alert http any any -> any any (msg:"TROJAN Win32.AutoRun.cedq Checkin"; flow:to_server,established; content:"GET"; nocase; http_method; content:"sknock.php?affid="; nocase; content:"&data=version=9|7c|Started"; nocase; sid:100326; rev:4;)
alert http any any -> any any (msg:"TROJAN Win32/Wecorl.gen!A Download"; flow:to_server,established; content:"/mimi.1268772"; fast_pattern:only; content:!"User-Agent|3a| "; http_header; pcre:"/\/mimi\.1268772$/U"; sid:100327; rev:2;)
alert http any any -> any any (msg:"Insecure Library Loading Request (.dll)"; flow:to_server,established; content:"/.dll"; nocase; content:"GET"; http_method; pcre:"/\/\.dll$/Ui"; sid:100328; rev:8;)
alert http any any -> any any (msg:"Microsoft Active Accessibility oleacc.dll Insecure Library Loading Code Execution - WebDAV"; flow:to_server; content:"|2f|oleacc.dll"; nocase; content:"GET"; http_method; content:"HTTP"; nocase; sid:100329; rev:4;)
alert http any any -> any any (msg:"Microsoft Address Book Insecure msoeres32.dll Library Loading"; flow:to_server,established; content:"/msoeres32.dll"; sid:100330; rev:4;)
alert http any any -> any any (msg:"Microsoft Address Book wab32res.dll Insecure Library Loading"; flow:to_server,established; content:"/wab32res.dll"; sid:100331; rev:6;)
alert http any any -> any any (msg:"Microsoft Excel Workspace docx download"; flow:to_server,established; content:".docx"; nocase; flowbits:set,http.docx.download; flowbits:noalert; sid:100332; rev:2;)
alert http any any -> any any (msg:"Microsoft Excel Workspace rtf download"; flow:to_server,established; content:".rtf"; nocase; flowbits:noalert; flowbits:set,http.rtf.download; sid:100333; rev:2;)
alert http any any -> any any (msg:"Microsoft Excel Workspace xlsx download"; flow:to_server,established; content:".xlsx"; nocase; flowbits:noalert; flowbits:set,http.xlsx.download; sid:100334; rev:2;)
alert http any any -> any any (msg:"Microsoft Excel Workspace xlt download"; flow:to_server,established; content:".xlt"; nocase; flowbits:noalert; flowbits:set,http.xlt.download; sid:100335; rev:2;)
alert http any any -> any any (msg:"Microsoft Internet Connection Signup Wizard smmscrpt.dll Insecure Library Loading"; flow:to_server,established; content:"/smmscrpt.dll"; sid:100336; rev:3;)
alert http any any -> any any (msg:"Microsoft Internet Explorer 8 IESHIMS.DLL Insecure Library Loading"; flow:to_server; content:"GET"; http_method; content:"/IESHIMS.DLL"; nocase; sid:100337; rev:4;)
alert http any any -> any any (msg:"Microsoft Office Groove 2007 Insecure Library Loading Code Execution"; flow:to_server,established; content:"/mso.dll"; nocase; content:"GET"; http_method; sid:100338; rev:6;)
alert http any any -> any any (msg:"Microsoft Powerpoint digest.dll Insecure Library Loading"; flow:to_server,established; content:"/digest.dll"; sid:100339; rev:4;)
alert http any any -> any any (msg:"Microsoft Powerpoint msapsspc.dll Insecure Library Loading"; flow:to_server,established; content:"/msapsspc.dll"; sid:100340; rev:4;)
alert http any any -> any any (msg:"Microsoft Powerpoint msnsspc.dll Insecure Library"; flow:to_server,established; content:"/msnsspc.dll"; sid:100341; rev:4;)
alert http any any -> any any (msg:"Microsoft Powerpoint pp4x322.dll Insecure Library Loading"; flow:to_server,established; content:"/pp4x322.dll"; nocase; content:"GET"; http_method; sid:100342; rev:4;)
alert http any any -> any any (msg:"Microsoft Powerpoint pp7x32.dll Insecure Library Loading"; flow:to_server,established; content:"/pp7x32.dll"; nocase; content:"GET"; http_method; sid:100343; rev:4;)
alert http any any -> any any (msg:"Microsoft Powerpoint schannel.dll Insecure Library Loading"; flow:to_server,established; content:"/schannel.dll"; nocase; content:"GET"; http_method; sid:100344; rev:4;)
alert http any any -> any any (msg:"Microsoft Windows Backup Manager fveapi.dll Insecure Library Loading fveapi.dll"; flow:to_server,established; content:"/fveapi.dll"; sid:100345; rev:5;)
alert http any any -> any any (msg:"Microsoft Windows Data Access Components Insecure Library Loading Attempt"; flow:to_server,established; content:"GET"; http_method; content:"BIDLAB.DLL"; nocase; sid:100346; rev:4;)
alert http any any -> any any (msg:"Microsoft Windows Media Encoder PRX File msxml.dll Insecure Library Loading"; flow:to_server,established; content:"/msxml.dll"; sid:100347; rev:4;)
alert http any any -> any any (msg:"Telnet Handler Code Execution Vulnerability Attempt WEBDAV PROPFIND telnet.exe"; flow:to_server; content:"PROPFIND"; http_method; content:"telnet.exe"; sid:100348; rev:2;)
alert http any any -> any any (msg:"Windows Media Player ehtrace.dll Insecure Library Loading"; flow:to_server,established; content:"/ehtrace.dll"; nocase; content:"GET"; http_method; sid:100349; rev:5;)
alert http any any -> any any (msg:"WEB_SERVER Microsoft Remote Desktop Web Access ReturnUrl XSS Attempt"; flow:established,to_server; content:"/RDWeb/Pages/"; content:"/login.aspx?"; content:"ReturnUrl="; content:"|22|"; sid:100350; rev:6;)
alert http any any -> any any (msg:"TROJAN Conficker/KernelBot/MS08-067 related Trojan Checkin"; flow:established,to_server; content:"GET"; http_method; nocase; content:"/kernel/zz.htm?"; content:"Ver="; sid:100351; rev:12;)
alert http any any -> any any (msg:"TROJAN Conficker/MS08-067 Worm Traffic Outbound"; flowbits:isset,ET.ms08067_header; flow:established,to_server; content:"If-None-Match|3A| |22|60794|2D|12b3|2D|e4169440|22|"; nocase; sid:100352; rev:8;)
alert http any any -> any any (msg:"TROJAN Suspicious Accept-Language HTTP Header, zh-cn, likely Kernelbot/Conficker Trojan Related"; flow:established,to_server; content:"Accept-Language|3A| zh|2D|cn"; http_header; flowbits:set,ET.ms08067_header; flowbits:noalert; sid:100353; rev:8;)
alert http any any -> any any (msg:"Likely MS12-004 midiOutPlayNextPolyEvent Heap Overflow Midi Filename Requested baby.mid"; flow:established,to_server; content:"/baby.mid"; sid:100354; rev:3;)
alert http any any -> any any (msg:"Microsoft Visio 2003 mfc71enu.dll DLL Loading Arbitrary Code Execution Attempt"; flow:established,to_server; content:"/mfc71"; nocase; pcre:"/mfc71[a-z]{2,3}\x2Edll/Ui"; sid:100355; rev:2;)
alert tcp any 139 -> any any (msg:"NETBIOS Microsoft Windows LNK File Code Execution SMB"; flow:from_server,established; content:"|ff|SMB|2e 00 00 00 00|"; offset:4; depth:9; content:"|4C 00 00 00 01 14 02 00|"; distance:32; within:64; content:"|00 00 00 00 C0 00 00 00 00 00 00 46|"; within:12; content:"|20 20 EC 21 EA 3A 69 10 A2 DD 08 00 2B 30 30 9D|"; distance:0; sid:100358; rev:2;)
alert tcp any 445 -> any any (msg:"NETBIOS Microsoft Windows LNK File Code Execution SMB-DS"; flow:from_server,established; content:"|ff|SMB|2e 00 00 00 00|"; offset:4; depth:9; content:"|4C 00 00 00 01 14 02 00|"; distance:32; within:64; fast_pattern; content:"|00 00 00 00 C0 00 00 00 00 00 00 46|"; within:12; content:"|20 20 EC 21 EA 3A 69 10 A2 DD 08 00 2B 30 30 9D|"; distance:0; sid:100359; rev:1;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (16)"; flow:established,to_server; content:"|0B|"; offset:2; depth:1; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; sid:100360; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (17)"; flow:established,to_server; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"..|5C|..|5C|"; sid:100361; rev:6;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (18)"; flow:established,to_server; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"../../"; sid:100362; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (19)"; flow:established,to_server; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|"; sid:100363; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (20)"; flow:established,to_server; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|"; sid:100364; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (27)"; flow:established,to_server; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"..|5C|..|5C|"; sid:100365; rev:6;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (28)"; flow:established,to_server; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"../../"; sid:100366; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (29)"; flow:established,to_server; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|"; sid:100367; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (30)"; flow:established,to_server; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|"; sid:100368; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (11)"; flow:established,to_server; content:"|0B|"; offset:2; depth:1; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; sid:100369; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (12)"; flow:established,to_server; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|5C|..|5C|"; sid:100370; rev:6;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (13)"; flow:established,to_server; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"/../"; sid:100371; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (14)"; flow:established,to_server; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|"; sid:100372; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (15)"; flow:established,to_server; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|"; sid:100373; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (22)"; flow:established,to_server; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|5C|..|5C|"; sid:100374; rev:6;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (23)"; flow:established,to_server; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"/../"; sid:100375; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (24)"; flow:established,to_server; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|"; sid:100376; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (25)"; flow:established,to_server; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|"; sid:100377; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 - Known Exploit Instance (2)"; flow:established,to_server; content:"|00 2e 00 2e 00 2f 00 2e 00 2e 00 2f 00 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 87|"; sid:100378; rev:5;)
alert tcp any any -> any 88 (msg:"Possible CVE-2014-6324 Priv escalation attempt"; flow:established,to_server; content:"|00 80|"; content:"|30 05 a0 03 01 01 00|"; distance:4; within:7; fast_pattern; content:"|06|krbtgt"; nocase; distance:0; sid:100379; rev:2;)
alert tcp any 1745 -> any any (msg:"Microsoft Forefront Threat Management Gateway Client Remote Code Execution"; flow:from_server,established; content:"|00 52 57 53|"; depth:4; content:"|0f|"; offset:16; depth:1; byte_jump:4,281,big; content:!"|00|"; distance:-4; within:71; sid:100380; rev:1;)
alert tcp any 445 -> any any (msg:"NETBIOS Microsoft Windows SMB Client Race Condition Remote Code Execution"; flow:to_client,established; content:"|ff 53 4d 42 72|"; offset:4; depth:5; content:"|00 00 00 00|"; distance:0; within:4; byte_test:4,<,4356,30,relative,little; sid:100381; rev:2;)
alert tcp any any -> any 1024: (msg:"NETBIOS DCERPC Workstation Service direct service bind attempt"; flow:to_server,established; content:"|05 00 0B|"; depth:3; byte_test:1,&,16,1,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:29; sid:100382; rev:7;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC CoGetInstanceFromFile little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|05|"; depth:1; byte_test:1,&,16,3,relative; content:"|00|"; offset:1; depth:1; content:"|01 00|"; distance:19; within:2; byte_test:4,>,128,20,relative,little; sid:100383; rev:6;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC CoGetInstanceFromFile overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,128,20,relative; sid:100384; rev:4;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC irot bind attempt"; flow:established,to_server; content:"|05|"; depth:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100385; rev:3;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC IrotIsRunning attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_test:4,>,128,0,relative; sid:100386; rev:4;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC IrotIsRunning little endian attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_test:4,>,128,0,little,relative; sid:100387; rev:4;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC irot little endian bind attempt"; flow:established,to_server; content:"|05|"; depth:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100388; rev:3;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC LSASS bind attempt"; flow:to_server,established; content:"|05|"; depth:1; content:"|00|"; within:1; distance:1; byte_test:1,&,1,0,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:29; flowbits:set,netbios.lsass.bind.attempt; flowbits:noalert; sid:100389; rev:8;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC LSASS direct bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB"; depth:4; offset:4; nocase; content:"|05|"; content:"|0B|"; within:1; distance:1; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:29; flowbits:set,netbios.lsass.bind.attempt; flowbits:noalert; sid:100390; rev:8;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC msqueue bind attempt"; flow:to_server,established; content:"|05|"; depth:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100391; rev:4;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC msqueue little endian bind attempt"; flow:to_server,established; content:"|05|"; depth:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100392; rev:4;)
alert tcp any any -> any 135 (msg:"NETBIOS DCERPC Remote Activation bind attempt"; flow:to_server,established; content:"|05|"; content:"|0B|"; within:1; distance:1; byte_test:1,&,1,0,relative; content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W"; within:16; distance:29; tag:session,5,packets; sid:100393; rev:16;)
alert tcp any any -> any 139 (msg:"NETBIOS NETBIOS SMB DCERPC NetrpPathCanonicalize request (possible MS06-040)"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB|25|"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00|"; within:9; distance:4; content:"|1f 00|"; distance:20; within:2; sid:100394; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS NII Microsoft ASN.1 Library Buffer Overflow Exploit"; flow: to_server,established; content:"|A1 05 23 03 03 01 07|"; sid:100395; rev:6;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB DCERPC PnP bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00 0B|"; within:10; distance:4; byte_test:1,&,16,1,relative; content:"|40 4E 9F 8D 3D A0 CE 11 8F 69 08 00 3E 30 05 1B|"; flowbits:set,netbios.pnp.bind.attempt; flowbits:noalert; sid:100396; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB DCERPC PnP QueryResConfList exploit attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00 00|"; within:10; distance:4; nocase; content:"|36 00|"; within:2; distance:19; pcre:"/(\x00\\\x00.*?){2}\x00{2}\xFF{2}.{128,}[\x04-\xFF][\x00-\xFF]{3}\x00{4}$/Rs"; flowbits:isset,netbios.pnp.bind.attempt; sid:100397; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft SMB NetLogon UUID detected Big Endian SET"; flow:to_server,established; content:"|ff|SMB"; content:"|05 00 0b|"; distance:0; byte_test:1,!&,0x10,1,relative; content:"|12345678 1234 abcd ef00 01234567cffb|"; distance:29; flowbits:set,smb.netlogon.uuid.detected; flowbits:noalert; sid:100398; rev:2;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft SMBv2 Transaction Parsing Vulnerability SMB"; flow:to_server,established; content:"|fe|SMB"; byte_test:2,=,9,8,relative,little; byte_jump:2,0,relative,little; byte_test:2,>,256,-4,relative,little; byte_test:2,>,256,-2,relative,little; sid:100399; rev:3;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB CoGetInstanceFromFile andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,128,20,relative; sid:100400; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB CoGetInstanceFromFile little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,128,20,relative; sid:100401; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB CoGetInstanceFromFile little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,128,20,relative; sid:100402; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB CoGetInstanceFromFile overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,128,20,relative; sid:100403; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB CoGetInstanceFromFile unicode andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,256,20,relative; sid:100404; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB CoGetInstanceFromFile unicode little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,256,20,relative; sid:100405; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB CoGetInstanceFromFile unicode little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,256,20,relative; sid:100406; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB CoGetInstanceFromFile unicode overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,256,20,relative; sid:100407; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB DCERPC LSASS bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00 0B|"; within:10; distance:4; byte_test:1,&,16,1,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:29; flowbits:set,netbios.lsass.bind.attempt; flowbits:noalert; sid:100408; rev:8;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB DCERPC LSASS direct bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB"; depth:4; offset:4; nocase; content:"|05|"; content:"|0B|"; within:1; distance:1; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:29; flowbits:set,netbios.lsass.bind.attempt; flowbits:noalert; sid:100409; rev:7;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB DCERPC LSASS DsRolerUpgradeDownlevelServer exploit attempt"; flow:to_server,established; flowbits:isset,netbios.lsass.bind.attempt; content:"|FF|SMB"; depth:4; offset:4; nocase; content:"|05|"; distance:59; content:"|00|"; within:1; distance:1; content:"|09 00|"; within:2; distance:19; sid:100410; rev:10;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB DCERPC Workstation Service bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00 0B|"; within:10; distance:4; byte_test:1,&,16,1,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:29; sid:100411; rev:7;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB DCERPC Workstation Service unicode bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,&,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 05 00 0B|"; within:15; distance:4; byte_test:1,&,16,1,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:29; sid:100412; rev:7;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB irot andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100413; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB irot bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100414; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB IrotIsRunning andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100415; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB IrotIsRunning attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100416; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB IrotIsRunning little endian andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100417; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB IrotIsRunning little endian attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100418; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB IrotIsRunning unicode andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100419; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB IrotIsRunning unicode attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100420; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB IrotIsRunning unicode little endian andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100421; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB IrotIsRunning unicode little endian attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100422; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB irot little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100423; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB irot little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100424; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB irot unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100425; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB irot unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100426; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB irot unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100427; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB irot unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100428; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrconnect andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,52,0,relative; sid:100429; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrconnect little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,52,0,relative; sid:100430; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrconnect little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,52,0,relative; sid:100431; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrconnect overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,52,0,relative; sid:100432; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrconnect unicode andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,104,0,relative; sid:100433; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrconnect unicode little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,104,0,relative; sid:100434; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrconnect unicode little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,104,0,relative; sid:100435; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrconnect unicode overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,104,0,relative; sid:100436; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrpc andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100437; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrpc bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100438; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrpc little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100439; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrpc little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100440; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrpc unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100441; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrpc unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100442; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrpc unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100443; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB llsrpc unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100444; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB msqueue andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100445; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB msqueue bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100446; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB msqueue little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100447; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB msqueue little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100448; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB msqueue unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100449; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB msqueue unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100450; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB msqueue unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100451; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB msqueue unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100452; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB OpenKey overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.winreg; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 0F|"; within:2; distance:19; byte_test:2,>,1024,20,relative; sid:100453; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB Session Setup NTMLSSP andx asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"s"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:4,&,2147483648,21,relative,little; content:!"NTLMSSP"; within:7; distance:27; asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048; sid:100454; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB Session Setup NTMLSSP unicode andx asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"s"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:4,&,2147483648,21,relative,little; content:!"NTLMSSP"; within:7; distance:27; asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048; sid:100455; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB Session Setup NTMLSSP unicode asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMBs"; within:5; distance:3; byte_test:1,&,128,6,relative; byte_test:4,&,2147483648,48,relative,little; content:!"NTLMSSP"; within:7; distance:54; asn1:double_overflow, bitstring_overflow, relative_offset 54, oversize_length 2048; sid:100456; rev:7;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100457; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg andx bind attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.winreg; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; sid:100458; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100459; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg bind attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.winreg; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; content:"|05|"; distance:4; within:1; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; sid:100460; rev:6;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100461; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100462; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100463; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg unicode andx bind attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.winreg; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; sid:100464; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100465; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg unicode bind attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.winreg; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; content:"|05|"; distance:4; within:1; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; sid:100466; rev:6;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100467; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS SMB winreg unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100468; rev:4;)
alert tcp any any -> any 3389 (msg:"DOS Microsoft Remote Desktop Protocol (RDP) maxChannelIds DoS Attempt"; flow:to_server,established; content:"|03 00|"; depth:2; content:"|e0|"; distance:3; within:1; content:"|03 00|"; distance:0; content:"|f0|"; distance:3; within:1; content:"|7f 65|"; distance:1; within:2; content:"|04 01 01 04 01 01 01 01 ff 30|"; distance:3; within:10; content:"|02|"; distance:1; within:1; byte_test:1,<,0x80,0,relative,big; byte_jump:1,0,relative; byte_test:1,<,0x06,-1,relative,big; sid:100469; rev:15;)
alert tcp any any -> any 3389 (msg:"DOS Microsoft Remote Desktop Protocol (RDP) maxChannelIds DoS Attempt Negative INT"; flow:to_server,established; content:"|03 00|"; depth:2; content:"|e0|"; distance:3; within:1; content:"|03 00|"; distance:0; content:"|f0|"; distance:3; within:1; content:"|7f 65|"; distance:1; within:2; content:"|04 01 01 04 01 01 01 01 ff 30|"; distance:3; within:10; content:"|02|"; distance:1; within:1; byte_test:1,<,0x80,0,relative,big; byte_test:1,&,0x80,1,relative,big; sid:100470; rev:13;)
alert tcp any any -> any 3389 (msg:"DOS Microsoft Remote Desktop Protocol (RDP) maxChannelIds Integer indef DoS Attempt"; flow:to_server,established; content:"|03 00|"; depth:2; content:"|e0|"; distance:3; within:1; content:"|03 00|"; distance:0; content:"|f0|"; distance:3; within:1; content:"|7f 65|"; distance:1; within:2; content:"|04 01 01 04 01 01 01 01 ff 30|"; distance:3; within:10; content:"|02|"; distance:1; within:1; byte_test:1,>,0x80,0,relative; byte_test:1,<,0xFF,0,relative; byte_jump:1,0,relative, post_offset -128; byte_jump:1,-1,relative; byte_test:1,<,0x06,-1,relative,big; sid:100471; rev:1;)
alert tcp any any -> any 3389 (msg:"DOS Microsoft Remote Desktop Protocol (RDP) maxChannelIds Negative Integer indef DoS Attempt"; flow:to_server,established; content:"|03 00|"; depth:2; content:"|e0|"; distance:3; within:1; content:"|03 00|"; distance:0; content:"|f0|"; distance:3; within:1; content:"|7f 65|"; distance:1; within:2; content:"|04 01 01 04 01 01 01 01 ff 30|"; distance:3; within:10; content:"|02|"; distance:1; within:1; byte_test:1,>,0x80,0,relative; byte_test:1,<,0xFF,0,relative; byte_jump:1,0,relative, post_offset -128; byte_jump:1,-1,relative; byte_test:1,&,0x80,-1,relative,big; sid:100472; rev:1;)
alert tcp any any -> any 42 (msg:"WINS overflow attempt"; flow:to_server,established; byte_test:1,&,64,6; byte_test:1,&,32,6; byte_test:1,&,16,6; byte_test:1,&,8,6; pcre:!"/^.{8}(\x05\x37(\x1E[\x90-\xFF]|[\x1F-\x2F].|\x30[\x00-\x70])|\x00\x00\x00[\x00-\x65]|\x02\x68\x05\xC0)/s"; sid:100473; rev:7;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft SRV2.SYS SMB Negotiate ProcessID Function Table Dereference"; flow:to_server,established; content:"|FF 53 4d 42 72|"; offset:4; depth:5; content:!"|00 00|"; distance:7; within:2; sid:100474; rev:1;)
alert tcp any any -> any 445 (msg:"NETBIOS MS04-007 Kill-Bill ASN1 exploit attempt"; flow: established,to_server; content:"CCCC|20f0fd7f|SVWf"; sid:100475; rev:7;)
alert tcp any any -> any 445 (msg:"NETBIOS NETBIOS SMB-DS DCERPC NetrpPathCanonicalize request (possible MS06-040)"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB|25|"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00|"; within:9; distance:4; content:"|1f 00|"; distance:20; within:2; sid:100476; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC PnP bind attempt"; flow:to_server,established; content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|"; within:12; distance:5; nocase; content:"|05|"; within:1; distance:2; content:"|0B|"; within:1; distance:1; content:"|40 4E 9F 8D 3D A0 CE 11 8F 69 08 00 3E 30 05 1B|"; flowbits:set,netbios.pnp.bind.attempt; flowbits:noalert; sid:100477; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC PnP HOD bind attempt"; flow:to_server,established; content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|"; within:12; distance:5; nocase; content:"|05|"; within:1; distance:4; content:"|0B|"; within:1; distance:1; content:"|40 4E 9F 8D 3D A0 CE 11 8F 69 08 00 3E 30 05 1B|"; flowbits:set,netbios.pnp.bind.attempt; flowbits:noalert; sid:100478; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC PnP QueryResConfList exploit attempt"; flow:to_server,established; content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|"; within:12; distance:5; nocase; content:"|36 00|"; within:2; distance:26; pcre:"/(\x00\\\x00.*?){2}\x00{2}\xFF{2}.{128,}[\x04-\xFF][\x00-\xFF]{3}\x00{4}$/Rs"; flowbits:isset,netbios.pnp.bind.attempt; sid:100479; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB Trans2 Query_Fs_Attribute_Info SrvSmbQueryFsInformation Pool Buffer Overflow"; flow:to_server,established; content:"|ff 53 4d 42 32|"; offset:4; depth:5; content:"|00 00 00 00|"; distance:0; within:4; content:"|00 00|"; distance:30; within:2; content:"|00 03 00|"; distance:19; within:3; sid:100480; rev:2;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft SMBv2 Transaction Parsing Vulnerability SMB-DS"; flow:to_server; content:"|fe|SMB"; byte_test:2,=,9,8,relative,little; byte_jump:2,0,relative,little; byte_test:2,>,256,-4,relative,little; byte_test:2,>,256,-2,relative,little; sid:100481; rev:3;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,128,20,relative; sid:100482; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,128,20,relative; sid:100483; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,128,20,relative; sid:100484; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,128,20,relative; sid:100485; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile unicode andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,256,20,relative; sid:100486; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile unicode little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,256,20,relative; sid:100487; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile unicode little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,256,20,relative; sid:100488; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile unicode overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,256,20,relative; sid:100489; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC ISystemActivator bind attempt"; flow:to_server,established; content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|"; within:12; distance:5; nocase; content:"|05|"; within:1; content:"|0B|"; within:1; distance:1; byte_test:1,&,1,0,relative; content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F"; within:16; distance:29; flowbits:set,dce.isystemactivator.bind.call.attempt; sid:100491; rev:12;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC ISystemActivator unicode bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,&,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 05 00 0B|"; within:15; distance:4; byte_test:1,&,16,1,relative; content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F"; within:16; distance:29; flowbits:set,dce.isystemactivator.bind.call.attempt; sid:100492; rev:8;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC LSASS bind attempt"; flow:to_server,established; content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|"; within:12; distance:5; nocase; content:"|05|"; within:1; distance:2; content:"|0B|"; within:1; distance:1; byte_test:1,&,1,0,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:29; flowbits:set,netbios.lsass.bind.attempt; flowbits:noalert; sid:100493; rev:8;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC LSASS direct bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB"; depth:4; offset:4; nocase; content:"|05|"; content:"|0B|"; within:1; distance:1; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:29; flowbits:set,netbios.lsass.bind.attempt; flowbits:noalert; sid:100494; rev:7;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC LSASS unicode bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 05 00 0B|"; within:15; distance:4; byte_test:1,&,16,1,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:29; flowbits:set,netbios.lsass.bind.attempt; flowbits:noalert; sid:100495; rev:8;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC Messenger Service buffer overflow attempt"; flow:to_server,established; content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|"; within:12; distance:5; nocase; content:"|04 00|"; within:2; byte_test:1,>,15,2,relative; byte_jump:4,86,little,align,relative; byte_jump:4,8,little,align,relative; byte_test:4,>,1024,0,little,relative; sid:100496; rev:10;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC Remote Activation bind attempt"; flow:to_server,established; content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|"; within:12; distance:5; nocase; content:"|05|"; within:1; content:"|0B|"; within:1; distance:1; byte_test:1,&,1,0,relative; content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W"; within:16; distance:29; tag:session,5,packets; sid:100497; rev:15;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC Workstation Service bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00 0B|"; within:10; distance:4; byte_test:1,&,16,1,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:29; sid:100498; rev:8;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS DCERPC Workstation Service unicode bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,&,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 05 00 0B|"; within:15; distance:4; byte_test:1,&,16,1,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:29; sid:100499; rev:9;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS irot andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100500; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS irot bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100501; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS IrotIsRunning andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100502; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS IrotIsRunning attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100503; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS IrotIsRunning little endian andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100504; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS IrotIsRunning little endian attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100505; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS IrotIsRunning unicode andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100506; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS IrotIsRunning unicode attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100507; rev:6;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS IrotIsRunning unicode little endian andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100508; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS IrotIsRunning unicode little endian attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; sid:100509; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS irot little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100510; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS irot little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100511; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS irot unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100512; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS irot unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100513; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS irot unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100514; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS irot unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; sid:100515; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrconnect andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,52,0,relative; sid:100516; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrconnect little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,52,0,relative; sid:100517; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrconnect little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,52,0,relative; sid:100518; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrconnect overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,52,0,relative; sid:100519; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrconnect unicode andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,104,0,relative; sid:100520; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrconnect unicode little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,104,0,relative; sid:100521; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrconnect unicode little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,104,0,relative; sid:100522; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrconnect unicode overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.llsrpc; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 00|"; within:2; distance:19; byte_test:4,>,104,0,relative; sid:100523; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrpc andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100524; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrpc bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100525; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrpc little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100526; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrpc little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100527; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrpc unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100528; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrpc unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100529; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrpc unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100530; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS llsrpc unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:29; flowbits:set,smb.tree.bind.llsrpc; sid:100531; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS msqueue andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100532; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS msqueue bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100533; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS msqueue little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100534; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS msqueue little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100535; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS msqueue unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100536; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS msqueue unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100537; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS msqueue unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100538; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS msqueue unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; content:"|05|"; distance:4; within:1; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q"; within:16; distance:29; flowbits:set,smb.tree.bind.msqueue; flowbits:noalert; sid:100539; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS OpenKey unicode little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.winreg; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|0F 00|"; within:2; distance:19; byte_test:2,>,2048,20,relative,little; sid:100540; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS Session Setup NTMLSSP asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMBs"; within:5; distance:3; byte_test:1,!&,128,6,relative; byte_test:4,&,2147483648,48,relative,little; content:!"NTLMSSP"; within:7; distance:54; asn1:double_overflow, bitstring_overflow, relative_offset 54, oversize_length 2048; sid:100541; rev:21;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS Session Setup NTMLSSP unicode asn1 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMBs"; within:5; distance:3; byte_test:1,&,128,6,relative; byte_test:4,&,2147483648,48,relative,little; content:!"NTLMSSP"; within:7; distance:54; asn1:double_overflow, bitstring_overflow, relative_offset 54, oversize_length 2048; sid:100542; rev:7;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg andx bind attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.winreg; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; sid:100543; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100544; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg bind attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.winreg; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; content:"|05|"; distance:4; within:1; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; sid:100545; rev:9;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100546; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100547; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100548; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg unicode andx bind attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.winreg; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; content:"|05|"; distance:4; within:1; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; sid:100549; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100550; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg unicode bind attempt"; flow:established,to_server; flowbits:isset,smb.tree.create.winreg; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; content:"|05|"; distance:4; within:1; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; sid:100551; rev:9;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100552; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS SMB-DS winreg unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; isdataat:4,relative; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:29; flowbits:set,smb.tree.bind.winreg; flowbits:noalert; sid:100553; rev:4;)
alert tcp any any -> any 139 (msg:"xp_sprintf possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|p|00|r|00|i|00|n|00|t|00|f|00|"; offset:32; nocase; sid:100554; rev:10;)
alert tcp any any -> any 139 (msg:"NETBIOS xp_reg* registry access"; flow:to_server,established; content:"x|00|p|00|_|00|r|00|e|00|g|00|"; depth:32; offset:32; nocase; sid:100555; rev:12;)
alert tcp any any -> any 139 (msg:"SQL xp_printstatements possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|r|00|i|00|n|00|t|00|s|00|t|00|a|00|t|00|e|00|m|00|e|00|n|00|t|00|s|00|"; offset:32; nocase; sid:100556; rev:10;)
alert tcp any any -> any 1433 (msg:"NETBIOS xp_reg* - registry access"; flow:to_server,established; content:"x|00|p|00|_|00|r|00|e|00|g|00|"; nocase; sid:100557; rev:11;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Internet Explorer Tabular DataURL ActiveX Control Memory Corruption Attempt"; flow:established,to_client; content:"333C7BC4-460F-11D0-BC04-0080C7055A83"; nocase; content:"DataURL"; nocase; distance:0; content:"value=|22|"; nocase; distance:0; isdataat:100,relative; content:!"|0A|"; within:100; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*333C7BC4-460F-11D0-BC04-0080C7055A83/si"; sid:100558; rev:8;)
alert tcp any $HTTP_PORTS -> any any (msg:"Exploit MS05-002 Malformed .ANI stack overflow attack"; flow: to_client,established; content:"RIFF"; content:"ACON"; distance: 8; content:"anih"; distance: 160; byte_test:4,>,36,0,relative,little; sid:100559; rev:6;)
alert tcp any $HTTP_PORTS -> any any (msg:"Internet_Explorer Use after free Vuln Addref ActiveX CLSID"; flow:from_server,established; content:"0E92978A-036B-4353-AFE1-7A8F2129C6C3"; nocase; content:"0E92978A-036B-4353-AFE1-7A8F2129C6C3"; nocase; distance:0; content:"CLSID"; nocase; pcre:"/CLSID[\s\x3a\x7b]*0E92978A-036B-4353-AFE1-7A8F2129C6C3/i"; sid:100560; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"Internet_Explorer Use after free Vuln Addref ActiveX ProgID"; flow:from_server,established; content:"Pkmaxctl.VocabCtl.1"; nocase; content:"Pkmaxctl.VocabCtl.1"; nocase; distance:0; content:"Object"; nocase; pcre:"/(ActiveX|Create)Object/i"; sid:100561; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Office PowerPoint Download Verification"; flow:from_server,established; flowbits:isset,ETPRO.FILE_PPT; content:"|D0 CF 11 E0 A1 B1 1A E1|"; flowbits:set,ETPRO.PPT_MAGIC; flowbits:noalert; sid:100562; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows Fax Services Cover Page Editor Flowbit Set"; flow:from_server,established; content:"FAXCOVER-VER"; flowbits:set,ETPRO.MSCOV; flowbits:noalert; sid:100563; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows Fax Services Cover Page Editor Heap Buffer Overflow (Published Exploit)"; flow:from_server,established; flowbits:isset,ETPRO.MSCOV; content:"CDrawPoly"; content:"|8f 41 41 41|"; distance:52; within:4; sid:100564; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 10"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"maxp"; byte_test:4,>,0x7fffffff,8,relative; sid:100565; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 11"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"name"; byte_test:4,>,0x7fffffff,4,relative; sid:100566; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 12"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"name"; byte_test:4,>,0x7fffffff,8,relative; sid:100567; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 13"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"OS/2"; byte_test:4,>,0x7fffffff,4,relative; sid:100568; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 14"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"OS/2"; byte_test:4,>,0x7fffffff,8,relative; sid:100569; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 15"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"post"; byte_test:4,>,0x7fffffff,4,relative; sid:100570; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 16"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"post"; byte_test:4,>,0x7fffffff,8,relative; sid:100571; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 1"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"cmap"; byte_test:4,>,0x7fffffff,4,relative; sid:100572; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 2"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"cmap"; byte_test:4,>,0x7fffffff,8,relative; sid:100573; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 3"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"head"; byte_test:4,>,0x7fffffff,4,relative; sid:100574; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 4"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"head"; byte_test:4,>,0x7fffffff,8,relative; sid:100575; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 5"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"hhea"; byte_test:4,>,0x7fffffff,4,relative; sid:100576; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 6"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"hhea"; byte_test:4,>,0x7fffffff,8,relative; sid:100577; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 7"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"hmtx"; byte_test:4,>,0x7fffffff,4,relative; sid:100578; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 8"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"hmtx"; byte_test:4,>,0x7fffffff,8,relative; sid:100579; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows OpenType Font Validation Integer Overflow 9"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"maxp"; byte_test:4,>,0x7fffffff,4,relative; sid:100580; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"AVI RIFF Chunk Access Flowbit Set"; flow:established,to_client; flowbits:set,ET.AVI.RIFF.Chunk; content:"|52 49 46 46|"; content:"|41 56 49 20|"; distance:4; within:4; flowbits:noalert; sid:100581; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"DXF Extension File Detection Access Flowbit Set"; flow:established,to_client; flowbits:set,DXF.Ext.Access; content:"|20 20 30|"; content:"|0A 53 45 43 54 49 4F 4E|"; within:10; content:"|20 20 32|"; within:5; content:"|48 45 41 44 45 52|"; distance:0; content:"|0a|"; within:2; flowbits:noalert; sid:100582; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Office Visio DXF File Processing Remote Code Execution"; flow:established,to_client; flowbits:isset,DXF.Ext.Access; content:"|0A 45 4E 44 53 45 43|"; content:!"|0a|"; within:2; byte_test:1,>,81,2,relative; sid:100583; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"Microsoft Windows MPEG Layer-3 Audio Decoder Buffer Overflow"; flow:established,to_client; flowbits:isset,ET.AVI.RIFF.Chunk; content:"|73 74 72 66|"; content:"|93 00 00 00|"; distance:8; within:4; sid:100584; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"MS10-090 IE CSS Exploit Metasploit POC Specific Unicoded"; flow:to_client,established; content:"|40 00 69 00 6d 00 70 00 6f 00 72 00 74 00|"; content:"|40 00 69 00 6d 00 70 00 6f 00 72 00 74 00|"; distance:0; content:"|40 00 69 00 6d 00 70 00 6f 00 72 00 74 00|"; distance:0; pcre:"/@\x00i\x00m\x00p\x00o\x00r\x00t\x00\x20.{4,20}[^\x00\w\s.]/sG"; sid:100585; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Address Book msoeres32.dll Insecure Library Loading - SMB Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"m|00|s|00|o|00|e|00|r|00|e|00|s|00|3|00|2|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:25; sid:100586; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Address Book msoeres32.dll Insecure Library Loading - SMB-DS ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"msoeres32.dll"; nocase; distance:79; within:13; sid:100587; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS Insecure Library Loading .dll SMB ASCII"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"|5c|.dll"; nocase; distance:79; within:5; sid:100588; rev:6;)
alert tcp any any -> any 139 (msg:"NETBIOS Insecure Library Loading .dll SMB Unicode"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"|5c 00 2e 00|d|00|l|00|l|00|"; nocase; distance:79; within:10; sid:100589; rev:7;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Active Accessibility oleacc.dll Insecure Library Loading Code Execution - SMB ASCII"; flow:to_server; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"|5c|oleacc.dll"; nocase; distance:79; sid:100590; rev:3;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Active Accessibility oleacc.dll Insecure Library Loading Code Execution - SMB Unicode"; flow:to_server; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"|5c 00|o|00|l|00|e|00|a|00|c|00|c|00|.|00|d|00|l|00|l"; nocase; distance:79; sid:100591; rev:3;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Address Book msoeres32.dll Insecure Library Loading - SMB ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"msoeres32.dll"; nocase; distance:79; within:13; sid:100592; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Address Book wab32res.dll Insecure Library Loading - SMB ASCII"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"wab32res.dll"; nocase; distance:79; sid:100593; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Address Book wab32res.dll Insecure Library Loading - SMB Unicode"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"w|00|a|00|b|00|3|00|2|00|r|00|e|00|s|00 2e 00|d|00|l|00|l"; nocase; distance:79; sid:100594; rev:6;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Internet Connection Signup Wizard smmscrpt.dll Insecure Library Loading - SMB ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"smmscrpt.dll"; nocase; distance:79; within:12; sid:100595; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Internet Connection Signup Wizard smmscrpt.dll Insecure Library Loading - SMB Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"s|00|m|00|m|00|s|00|c|00|r|00|p|00|t|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:23; sid:100596; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Internet Explorer 8 IESHIMS.DLL Insecure Library Loading SMB ASCII"; flow:to_server; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"IESHIMS.DLL"; nocase; distance:79; sid:100597; rev:1;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Internet Explorer 8 IESHIMS.DLL Insecure Library Loading SMB Unicode"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"i|00|e|00|s|00|h|00|i|00|m|00|s|00|.|00|d|00|l|00|l"; nocase; distance:79; sid:100598; rev:2;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Internet Explorer url.dll Telnet Handler Insecure Exe Loading - SMB ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; byte_test:2,!&,0x8000,5,relative,little; content:"|5C|telnet|2E|exe"; nocase; distance:79; sid:100599; rev:2;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Internet Explorer url.dll Telnet Handler Insecure Exe Loading - SMB Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; byte_test:2,&,0x8000,5,relative,little; content:"|5C 00|t|00|e|00|l|00|n|00|e|00|t|00 2E 00|e|00|x|00|e|00|"; nocase; distance:79; sid:100600; rev:2;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Office Groove 2007 Insecure Library Loading Code Execution SMB ASCII"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"mso.dll"; nocase; distance:79; sid:100601; rev:2;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Office Groove 2007 Insecure Library Loading Code Execution SMB Unicode"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"m|00|s|00|o|00|.|00|d|00|l|00|l"; nocase; distance:79; sid:100602; rev:2;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint digest.dll Insecure Library Loading - SMB ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"digest.dll"; nocase; distance:79; within:10; sid:100603; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint digest.dll Insecure Library Loading - SMB Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"d|00|i|00|g|00|e|00|s|00|t|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:19; sid:100604; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint msapsspc.dll Insecure Library Loading - SMB ASCII"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"msapsspc.dll"; nocase; distance:79; within:12; sid:100605; rev:3;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint msapsspc.dll Insecure Library Loading - SMB Unicode"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"m|00|s|00|a|00|p|00|s|00|s|00|p|00|c|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:23; sid:100606; rev:3;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint msnsspc.dll Insecure Library - SMB ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"msnsspc.dll"; nocase; distance:79; within:11; sid:100607; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint msnsspc.dll Insecure Library - SMB Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"m|00|s|00|n|00|s|00|s|00|p|00|c|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:21; sid:100608; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint pp4x322.dll Insecure Library Loading - SMB ASCII"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"pp4x322.dll"; nocase; distance:79; within:11; sid:100609; rev:3;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint pp4x322.dll Insecure Library Loading - SMB Unicode"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"p|00|p|00|4|00|x|00|3|00|2|00|2|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:21; sid:100610; rev:3;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint pp7x32.dll Insecure Library Loading - SMB ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"pp7x32.dll"; nocase; distance:79; within:64; sid:100611; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint pp7x32.dll Insecure Library Loading - SMB Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"p|00|p|00|7|00|x|00|3|00|2|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:100; sid:100612; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint schannel.dll Insecure Library Loading - SMB ASCII"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"schannel.dll"; nocase; distance:79; within:12; sid:100613; rev:3;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Powerpoint schannel.dll Insecure Library Loading - SMB Unicode"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"s|00|c|00|h|00|a|00|n|00|n|00|e|00|l|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:23; sid:100614; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows Backup Manager fveapi.dll Insecure Library Loading - SMB ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"fveapi.dll"; nocase; distance:79; within:10; sid:100615; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows Backup Manager fveapi.dll Insecure Library Loading - SMB Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"f|00|v|00|e|00|a|00|p|00|i|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:19; sid:100616; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows Data Access Components Insecure Library Loading - SMB ASCII"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"BIDLAB.DLL"; nocase; distance:79; sid:100617; rev:2;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows Data Access Components Insecure Library Loading - SMB Unicode"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"b|00|i|00|d|00|l|00|a|00|b|00 2e 00|d|00|l|00|l"; nocase; distance:79; sid:100618; rev:2;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows Media Encoder PRX File msxml.dll Insecure Library Loading - SMB ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"msxml.dll"; nocase; distance:79; within:9; sid:100619; rev:5;)
alert tcp any any -> any 139 (msg:"NETBIOS Microsoft Windows Media Encoder PRX File msxml.dll Insecure Library Loading - SMB Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"m|00|s|00|x|00|m|00|l|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:17; sid:100620; rev:4;)
alert tcp any any -> any 139 (msg:"NETBIOS Windows Media Player ehtrace.dll Insecure Library Loading Code Execution SMB ASCII"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"ehtrace.dll"; nocase; distance:79; sid:100621; rev:2;)
alert tcp any any -> any 139 (msg:"NETBIOS Windows Media Player ehtrace.dll Insecure Library Loading Code Execution SMB Unicode"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"e|00|h|00|t|00|r|00|a|00|c|00|e|00|.|00|d|00|l|00|l"; nocase; distance:79; sid:100622; rev:2;)
alert tcp any any -> any 445 (msg:"NETBIOS Insecure Library Loading .dll SMB-DS ASCII"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"|5c|.dll"; nocase; distance:79; within:5; sid:100623; rev:8;)
alert tcp any any -> any 445 (msg:"NETBIOS Insecure Library Loading .dll SMB-DS Unicode"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"|5c 00 2e 00|d|00|l|00|l|00|"; nocase; distance:79; within:10; sid:100624; rev:7;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Active Accessibility oleacc.dll Insecure Library Loading Code Execution - SMB-DS ASCII"; flow:to_server; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"|5c|oleacc.dll"; nocase; distance:79; sid:100625; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Active Accessibility oleacc.dll Insecure Library Loading Code Execution - SMB-DS Unicode"; flow:to_server; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"|5c 00|o|00|l|00|e|00|a|00|c|00|c|00|.|00|d|00|l|00|l"; nocase; distance:79; sid:100626; rev:3;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Address Book msoeres32.dll Insecure Library Loading  - SMB-DS Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"m|00|s|00|o|00|e|00|r|00|e|00|s|00|3|00|2|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:25; sid:100627; rev:6;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Address Book wab32res.dll Insecure Library Loading - SMB-DS ASCII"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"wab32res.dll"; nocase; distance:79; sid:100628; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Address Book wab32res.dll Insecure Library Loading - SMB-DS Unicode"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"w|00|a|00|b|00|3|00|2|00|r|00|e|00|s|00 2e 00|d|00|l|00|l"; nocase; distance:79; sid:100629; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Internet Connection Signup Wizard smmscrpt.dll Insecure Library Loading - SMB-DS ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"smmscrpt.dll"; nocase; distance:79; within:12; sid:100630; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Internet Connection Signup Wizard smmscrpt.dll Insecure Library Loading  - SMB-DS Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"s|00|m|00|m|00|s|00|c|00|r|00|p|00|t|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:23; sid:100631; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Internet Explorer 8 IESHIMS.DLL Insecure Library Loading SMB-DS ASCII"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"IESHIMS.DLL"; nocase; distance:79; sid:100632; rev:2;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Internet Explorer 8 IESHIMS.DLL Insecure Library Loading SMB-DS Unicode"; flow:to_server; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"i|00|e|00|s|00|h|00|i|00|m|00|s|00|.|00|d|00|l|00|l"; nocase; distance:79; sid:100633; rev:1;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Internet Explorer url.dll Telnet Handler Insecure Exe Loading - SMB-DS ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; byte_test:2,!&,0x8000,5,relative,little; content:"|5C|telnet|2E|exe"; nocase; distance:79; sid:100634; rev:2;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Internet Explorer url.dll Telnet Handler Insecure Exe Loading - SMB-DS Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; byte_test:2,&,0x8000,5,relative,little; content:"|5C 00|t|00|e|00|l|00|n|00|e|00|t|00 2E 00|e|00|x|00|e|00|"; nocase; distance:79; sid:100635; rev:2;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Office Groove 2007 Insecure Library Loading Code Execution SMB-DS ASCII"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"mso.dll"; nocase; distance:79; sid:100636; rev:1;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Office Groove 2007 Insecure Library Loading Code Execution SMB-DS Unicode"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"m|00|s|00|o|00|.|00|d|00|l|00|l"; nocase; distance:79; sid:100637; rev:1;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint digest.dll Insecure Library Loading - SMB-DS ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"digest.dll"; nocase; distance:79; within:10; sid:100638; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint digest.dll Insecure Library Loading - SMB-DS Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"d|00|i|00|g|00|e|00|s|00|t|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:19; sid:100639; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint msapsspc.dll Insecure Library Loading - SMB-DS ASCII"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"msapsspc.dll"; nocase; distance:79; within:12; sid:100640; rev:3;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint msapsspc.dll Insecure Library Loading - SMB-DS Unicode"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"m|00|s|00|a|00|p|00|s|00|s|00|p|00|c|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:23; sid:100641; rev:3;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint msnsspc.dll Insecure Library - SMB-DS ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"msnsspc.dll"; nocase; distance:79; within:11; sid:100642; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint msnsspc.dll Insecure Library - SMB-DS Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"m|00|s|00|n|00|s|00|s|00|p|00|c|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:21; sid:100643; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint pp4x322.dll Insecure Library Loading - SMB-DS ASCII"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"pp4x322.dll"; nocase; distance:79; within:11; sid:100644; rev:3;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint pp4x322.dll Insecure Library Loading - SMB-DS Unicode"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"p|00|p|00|4|00|x|00|3|00|2|00|2|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:21; sid:100645; rev:3;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint pp7x32.dll Insecure Library Loading - SMB-DS ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"pp7x32.dll"; nocase; distance:79; within:64; sid:100646; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint pp7x32.dll Insecure Library Loading - SMB-DS Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"p|00|p|00|7|00|x|00|3|00|2|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:100; sid:100647; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint schannel.dll Insecure Library Loading - SMB-DS ASCII"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"schannel.dll"; nocase; distance:79; within:12; sid:100648; rev:3;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Powerpoint schannel.dll Insecure Library Loading - SMB-DS Unicode"; flow:to_server; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"s|00|c|00|h|00|a|00|n|00|n|00|e|00|l|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:23; sid:100649; rev:3;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows Backup Manager fveapi.dll Insecure Library Loading - SMB-DS ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"fveapi.dll"; nocase; distance:79; within:10; sid:100650; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows Backup Manager fveapi.dll Insecure Library Loading  - SMB-DS Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"f|00|v|00|e|00|a|00|p|00|i|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:19; sid:100651; rev:5;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows Data Access Components Insecure Library Loading - SMB-DS ASCII"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"BIDLAB.DLL"; nocase; distance:79; sid:100652; rev:2;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows Data Access Components Insecure Library Loading - SMB-DS Unicode"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"b|00|i|00|d|00|l|00|a|00|b|00 2e 00|d|00|l|00|l"; nocase; distance:79; sid:100653; rev:2;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows Media Encoder PRX File msxml.dll Insecure Library Loading - SMB-DS ASCII"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"msxml.dll"; nocase; distance:79; within:9; sid:100654; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows Media Encoder PRX File msxml.dll Insecure Library Loading  - SMB-DS Unicode"; flow:to_server,established; content:"|FF|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"m|00|s|00|x|00|m|00|l|00 2e 00|d|00|l|00|l"; nocase; distance:79; within:17; sid:100655; rev:4;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows OLE Automation Remote Code Execution SMB-DS ASCII"; flow:to_server,established; content:"|FF|SMB|A2|"; byte_test:1,!&,128,6,relative; content:".wmf|00|"; fast_pattern; nocase; distance:0; flowbits:set,ETPRO.WMF; flowbits:noalert; sid:100656; rev:2;)
alert tcp any any -> any 445 (msg:"NETBIOS Microsoft Windows OLE Automation Remote Code Execution SMB-DS Unicode"; flow:to_server,established; content:"|FF|SMB|A2|"; byte_test:1,&,128,6,relative; content:".|00|w|00|m|00|f|00 00 00|"; nocase; distance:0; flowbits:set,ETPRO.WMF; flowbits:noalert; sid:100657; rev:1;)
alert tcp any any -> any 445 (msg:"NETBIOS Windows Media Player ehtrace.dll Insecure Library Loading Code Execution SMB-DS ASCII"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,!&,0x80,6,relative; content:"ehtrace.dll"; nocase; distance:79; sid:100658; rev:2;)
alert tcp any any -> any 445 (msg:"NETBIOS Windows Media Player ehtrace.dll Insecure Library Loading Code Execution SMB-DS Unicode"; flow:to_server,established; content:"|ff|SMB|a2|"; offset:4; depth:5; byte_test:1,&,0x80,6,relative; content:"e|00|h|00|t|00|r|00|a|00|c|00|e|00|.|00|d|00|l|00|l"; nocase; distance:79; sid:100659; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Microsoft Office Insecure Library Loading WebDAV PROPFIND pptimpconv.dll"; flow:to_server; content:"PROPFIND"; http_method; content:"pptimpconv.dll"; sid:100660; rev:4;)
alert tcp any any -> any $HTTP_PORTS (msg:"Microsoft Windows Movie Maker Insecure Library Loading WebDAV GET hhctrl.ocx"; flow:to_server,established; content:"System32|5c|hhctrl.ocx"; content:"GET"; http_method; nocase; sid:100661; rev:3;)
alert tcp any any -> any $HTTP_PORTS (msg:"Microsoft Windows Movie Maker Insecure Library Loading WebDAV PROPFIND hhctrl.ocx"; flow:to_server,established; content:"System32|5c|hhctrl.ocx"; nocase; content:"PROPFIND"; http_method; sid:100662; rev:3;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SPECIFIC_APPS Microsoft Forefront Unified Access Gateway Signurl.asp Cross-Site Scripting"; flow:to_server,established; content:"/internalsite/signurl.asp"; nocase; content:"SignUrl"; nocase; content:"<script"; sid:100663; rev:3;)
alert udp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (10)"; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|"; sid:100664; rev:5;)
alert udp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (1)"; content:"|0B|"; offset:2; depth:1; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; sid:100665; rev:5;)
alert udp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (2)"; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"..|5C|..|5C|"; sid:100666; rev:6;)
alert udp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (3)"; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"../../"; sid:100667; rev:5;)
alert udp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (4)"; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|"; sid:100668; rev:5;)
alert udp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (5)"; content:"|1F 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|"; sid:100669; rev:5;)
alert udp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (7)"; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"..|5C|..|5C|"; sid:100670; rev:6;)
alert udp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (8)"; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"../../"; sid:100671; rev:5;)
alert udp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 (9)"; content:"|20 00|"; content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|"; content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|"; sid:100672; rev:5;)
alert udp any any -> any 139 (msg:"NETBIOS Microsoft Windows NETAPI Stack Overflow Inbound - MS08-067 - Known Exploit Instance"; content:"|00 2e 00 2e 00 2f 00 2e 00 2e 00 2f 00 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 87|"; sid:100673; rev:5;)
alert udp any any -> any 1024: (msg:"NETBIOS DCERPC Workstation Service direct service access attempt"; content:"|04 00|"; depth:2; byte_test:1,&,16,2,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:22; sid:100674; rev:7;)
alert udp any any -> any 135 (msg:"NETBIOS DCERPC Messenger Service buffer overflow attempt"; content:"|04 00|"; depth:2; byte_test:1,>,15,2,relative; byte_jump:4,86,little,align,relative; byte_jump:4,8,little,align,relative; byte_test:4,>,1024,0,little,relative; sid:100675; rev:10;)
alert udp any any -> any 42 (msg:"NETBIOS WINS name query overflow attempt UDP"; byte_test:1,&,64,2; content:" "; offset:12; isdataat:56,relative; sid:100678; rev:4;)
alert udp any any -> any 5355 (msg:"Microsoft Windows LLMNR Request Stack Memory Corruption"; byte_test:1,!&,0x78,2; content:"|01 2e|"; offset:12; depth:2; content:"in-addr"; nocase; distance:0; content:"arpa|00 00 0c 00 01|"; nocase; distance:1; within:9; sid:100679; rev:1;)
alert ftp any any -> any any (msg:"Win32.Conficker.C Activity (FTP download)"; flow:to_server,established; content:"RETR"; nocase; content:"wmsoft"; nocase; distance:0; pcre:"/^RETR\s*wmsoft[0-9]+\x2eexe/smi"; sid:100681; rev:3;)
alert ftp any any -> any any (msg:"WORM Worm.Win32.Autorun.hi Checkin"; flow:to_server,established; flowbits:isset,ETPRO.worm.Autorun.hi; dsize:12; content:"RETR hosts|0d 0a|"; depth:12; flowbits:unset,ETPRO.worm.Autorun.hi; sid:100682; rev:2;)
alert ftp any any -> any any (msg:"WORM Worm.Win32.Autorun.hi Checkin - SET"; flow:to_server,established; content:"STOR Ip-"; depth:8; content:".LOG|0d 0a|"; within:32; flowbits:set,ETPRO.worm.Autorun.hi; flowbits:noalert; sid:100683; rev:2;)
alert ftp any any -> any any (msg:"WORM Worm.Win32.Ganelp.B Checkin 1"; flow:to_server,established; dsize:25; content:"STOR jrend/Ups/"; depth:15; content:"|0d 0a|"; distance:8; within:2; sid:100684; rev:2;)
alert ftp any any -> any any (msg:"WORM Worm.Win32.Ganelp.B Checkin 2"; flow:to_server,established; dsize:20; content:"USER dictio_802884|0d 0a|"; depth:20; sid:100685; rev:2;)
alert http any any -> any any (msg:"CURRENT_EVENTS Possible SandWorm INF Download"; flow:to_client,established; content:"Software|5c|Microsoft|5c|Windows|5c|CurrentVersion|5c|Run"; nocase; content:"7EBEFBC0-3200-11d2-B4C2-00A0C9697D17"; nocase; content:"ClassGuid"; nocase; content:"DefaultInstall"; nocase; sid:100686; rev:3;)
alert http any any -> any any (msg:"CURRENT_EVENTS Possible SandWorm INF Download (UNICODE)"; flow:to_client,established; content:"S|00|o|00|f|00|t|00|w|00|a|00|r|00|e|00 5c 00|M|00|i|00|c|00|r|00|o|00|s|00|o|00|f|00|t|00 5c 00|W|00|i|00|n|00|d|00|o|00|w|00|s|00 5c 00|C|00|u|00|r|00|r|00|e|00|n|00|t|00|V|00|e|00|r|00|s|00|i|00|o|00|n|00 5c 00|R|00|u|00|n|00|"; nocase; content:"7|00|E|00|B|00|E|00|F|00|B|00|C|00|0|00 2d 00|3|00|2|00|0|00|0|00 2d 00|1|00|1|00|d|00|2|00 2d 00|B|00|4|00|C|00|2|00 2d 00|0|00|0|00|A|00|0|00|C|00|9|00|6|00|9|00|7|00|D|00|1|00|7"; nocase; content:"C|00|l|00|a|00|s|00|s|00|G|00|u|00|i|00|d|00|"; nocase; content:"D|00|e|00|f|00|a|00|u|00|l|00|t|00|I|00|n|00|s|00|t|00|a|00|l|00|l|00|"; nocase; sid:100687; rev:3;)
alert http any any -> any any (msg:"Havex RAT CnC Server Response"; flow:established,from_server; content:"|3c 21 2d 2d|havexhavex|2d 2d 3e|"; sid:100689; rev:3;)
alert http any any -> any any (msg:"Havex RAT CnC Server Response HTML Tag"; flow:established,from_server; content:"|3c|mega http|2d|equiv|3d|"; sid:100690; rev:3;)
alert http any 1024: -> any $HTTP_PORTS (msg:"Stuxnet index.php"; flow:to_server,established; content:"/index.php?data=66a96e28"; nocase; sid:100691; rev:3;)
alert http any any -> any any (msg:"CURRENT_EVENTS BlackEnergy URI Struct Oct 17 2014 BE1"; flow:established,to_server; content:"/YXJyYWtpczAy/"; sid:100692; rev:2;)
alert http any any -> any any (msg:"CURRENT_EVENTS BlackEnergy URI Struct Oct 17 2014 BE2"; flow:established,to_server; content:"/aG91c2VhdHJlaWRlczk0/"; sid:100693; rev:2;)
alert http any any -> any any (msg:"CURRENT_EVENTS BlackEnergy URI Struct Oct 17 2014 BE3"; flow:established,to_server; content:"/QmFzaGFyb2Z0aGVTYXJkYXVrYXJz/"; sid:100694; rev:2;)
alert http any any -> any any (msg:"CURRENT_EVENTS BlackEnergy URI Struct Oct 17 2014 BE4"; flow:established,to_server; content:"/U2FsdXNhU2VjdW5kdXMy/"; sid:100695; rev:2;)
alert http any any -> any any (msg:"CURRENT_EVENTS BlackEnergy URI Struct Oct 17 2014 BE5"; flow:established,to_server; content:"/ZXBzaWxvbmVyaWRhbmkw/"; sid:100696; rev:2;)
alert http any any -> any any (msg:"WORM Worm.Win32.Nokpuda.A Checkin"; flow:to_server,established; content:" Cy8oT "; http_header; pcre:"/\x0AUser-Agent\x3A \d+ Cy8oT \d+\x0D\x0A/Gi"; sid:100697; rev:2;)
alert http any any -> any any (msg:"Downadup/Conficker A or B Worm reporting"; flow:to_server,established; content:"/search?q="; pcre:"/\/search\?q=[0-9]{1,3}(&aq=7(\?[0-9a-f]{8})?)?$/U"; pcre:"/\x0d\x0aHost\x3a \d+\.\d+\.\d+\.\d+\x0d\x0a/"; sid:100700; rev:13;)
alert http any any -> any any (msg:"Win64/Havex Checkin"; flow:established,to_server; content:".php?id="; fast_pattern:only; content:!"Referer|3a|"; http_header; pcre:"/\.php\?id=\d{30}\w{6}-\d{2}-\d{3}-\d{9}$/U"; sid:100702; rev:2;)
alert http any any -> any any (msg:"WORM Rimecud Worm checkin"; flow:established,to_server; content:"GET"; http_method; content:"User-Agent|3a| Mozilla/3.0 (compatible|3b| Indy Library)"; http_header; content:"/taskx.txt"; fast_pattern; sid:100703; rev:2;)
alert http any any -> any any (msg:"WORM TheMoon.linksys.router 1"; flow:to_server,established; urilen:7; content:"GET"; http_method; content:"/HNAP1/"; pcre:"/Host\x3a (?:[0-9]{1,3}\.){3}[0-9]{1,3}/H"; sid:100704; rev:3;)
alert http any any -> any any (msg:"WORM TheMoon.linksys.router 2"; flow:to_server,established; content:"POST"; http_method; content:"/tmUnblock.cgi"; sid:100705; rev:3;)
alert http any any -> any any (msg:"WORM TheMoon.linksys.router 3"; flow:to_server,established; content:"POST"; http_method; content:"/hndUnblock.cgi"; sid:100706; rev:3;)
alert http any any -> any any (msg:"WORM W32/Rimecud /qvod/ff.txt Checkin"; flow:established,to_server; content:"/qvod/ff.txt"; sid:100707; rev:2;)
alert http any any -> any any (msg:"WORM W32/Rimecud wg.txt Checkin"; flow:established,to_server; content:"/wg.txt"; sid:100708; rev:2;)
alert http any any -> any $HTTP_PORTS (msg:"WORM Worm.Win32.Kelihos.A Checkin 1"; flow:to_server,established; content:"GET /"; nocase; depth:5; content:"|0D 0A 0D 0A 01 02 01 01 01 01 02 01|"; offset:32; depth:256; content:"|00 00 00 00 01|"; distance:4; within:5; sid:100709; rev:2;)
alert http any any -> any $HTTP_PORTS (msg:"WORM Worm.Win32.Soglueda.A Checkin"; flow:to_server,established; content:"POST"; http_method; content:"a="; nocase; depth:2; http_client_body; content:"Fecha "; nocase; content:" Hora "; nocase; distance:0; within:16; content:" Ventana|3a| "; nocase; distance:0; within:18; pcre:"/^Fecha \d{2}\x2f\d{2}\x2f\d{4} Hora \d{2}\x3a\d{2}\x3a\d{2} Ventana\x3a/mi"; sid:100710; rev:6;)
alert http any any -> any $HTTP_PORTS (msg:"WORM SDBot HTTP Checkin"; flow:established,to_server; content:"|0d 0a|User-Agent|3a| Mozilla/3.0 (compatible|3b| Indy Library)|0d 0a 0d 0a|quem=dodoi&tit="; content:"&txt="; distance:0; within:40; sid:100711; rev:4;)
alert http any any -> any $HTTP_PORTS (msg:"WORM Win32.Socks.s HTTP Post Checkin"; flow:established,to_server; content:"POST "; depth:5; uricontent:".php"; content:"|0d 0a 0d 0a|proc=[System Process]|0a|"; sid:100712; rev:4;)
alert icmp any any -> any any (msg:"PING CyberKit 2.2 Windows"; itype:8; content:"|AA AA AA AA AA AA AA AA AA AA AA AA AA AA AA AA|"; depth:32; sid:100713; rev:6;)
alert tcp any any -> any 3389 (msg:"WORM Worm.Win32.Morto.A Propagating via Windows Remote Desktop Protocol Flowbit Set"; flow:to_server,established; dsize:31; content:"|03 00 00 1F|"; depth:4; content:"mstshash=a|0D 0A|"; nocase; distance:15; within:12; flowbits:set,worm.win32.morto.a; flowbits:noalert; sid:100716; rev:1;)
alert tcp any any -> any 3389 (msg:"WORM Worm.Win32.Morto.A Propagating via Windows Remote Desktop Protocol"; flow:to_server,established; flowbits:isset,worm.win32.morto.a; dsize:406; content:"|03 00 01 96 02 F0 80|"; offset:0; depth:7; content:"Duca"; nocase; distance:137; within:4; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:148; within:64; content:"|01 00 00 00|rdpdr|00 00 00 00 00 80 80|"; distance:30; within:16; nocase; flowbits:unset,worm.win32.morto.a; sid:100717; rev:2;)
alert tcp any 1024: -> any any (msg:"WORM Worm.Win32.Imamihong.A Activity 1"; flow:from_server,established; flowbits:isset,ETPRO.Imamihong.A.TSL.a; dsize:4; content:"|29 E0 14 77|"; flowbits:unset,ETPRO.Imamihong.A.TSL.a; sid:100718; rev:1;)
alert tcp any 1024: -> any any (msg:"WORM Worm.Win32.Imamihong.A Activity 2"; flow:from_server,established; flowbits:isset,ETPRO.Imamihong.A.TSL.b; dsize:4; content:"|21 43 65 87|"; flowbits:unset,ETPRO.Imamihong.A.TSL.b; sid:100719; rev:1;)
alert tcp any [445,139] -> any any (msg:"CURRENT_EVENTS Possible SandWorm INF Download (SMB)"; flow:to_client,established; content:"Software|5c|Microsoft|5c|Windows|5c|CurrentVersion|5c|Run"; nocase; content:"7EBEFBC0-3200-11d2-B4C2-00A0C9697D17"; fast_pattern; nocase; content:"ClassGuid"; nocase; content:"DefaultInstall"; nocase; sid:100720; rev:2;)
alert tcp any [445,139] -> any any (msg:"CURRENT_EVENTS Possible SandWorm INF Download (SMB UNICODE)"; flow:to_client,established; content:"S|00|o|00|f|00|t|00|w|00|a|00|r|00|e|00 5c 00|M|00|i|00|c|00|r|00|o|00|s|00|o|00|f|00|t|00 5c 00|W|00|i|00|n|00|d|00|o|00|w|00|s|00 5c 00|C|00|u|00|r|00|r|00|e|00|n|00|t|00|V|00|e|00|r|00|s|00|i|00|o|00|n|00 5c 00|R|00|u|00|n|00|"; nocase; content:"7|00|E|00|B|00|E|00|F|00|B|00|C|00|0|00 2d 00|3|00|2|00|0|00|0|00 2d 00|1|00|1|00|d|00|2|00 2d 00|B|00|4|00|C|00|2|00 2d 00|0|00|0|00|A|00|0|00|C|00|9|00|6|00|9|00|7|00|D|00|1|00|7"; fast_pattern; nocase; content:"C|00|l|00|a|00|s|00|s|00|G|00|u|00|i|00|d|00|"; nocase; content:"D|00|e|00|f|00|a|00|u|00|l|00|t|00|I|00|n|00|s|00|t|00|a|00|l|00|l|00|"; nocase; sid:100721; rev:3;)
alert tcp any any -> any 445 (msg:"Conficker.b Shellcode"; flow:established,to_server; content:"|e8 ff ff ff ff c2|_|8d|O|10 80|1|c4|Af|81|9MSu|f5|8|ae c6 9d a0|O|85 ea|O|84 c8|O|84 d8|O|c4|O|9c cc|Ise|c4 c4 c4|,|ed c4 c4 c4 94|&<O8|92|\;|d3|WG|02 c3|,|dc c4 c4 c4 f7 16 96 96|O|08 a2 03 c5 bc ea 95|\;|b3 c0 96 96 95 92 96|\;|f3|\;|24 |i|95 92|QO|8f f8|O|88 cf bc c7 0f f7|2I|d0|w|c7 95 e4|O|d6 c7 17 cb c4 04 cb|{|04 05 04 c3 f6 c6 86|D|fe c4 b1|1|ff 01 b0 c2 82 ff b5 dc b6 1f|O|95 e0 c7 17 cb|s|d0 b6|O|85 d8 c7 07|O|c0|T|c7 07 9a 9d 07 a4|fN|b2 e2|Dh|0c b1 b6 a8 a9 ab aa c4|]|e7 99 1d ac b0 b0 b4 fe eb eb|"; sid:100722; rev:6;)
alert tcp any any -> any 3306 (msg:"MySQL Server for Windows Remote SYSTEM Level Exploit (Stuxnet Techique DUMP INTO executable)"; flow:to_server,established; content:"|03|"; offset:3; depth:4; content:"SELECT data FROM"; nocase; distance:0; content:"INTO DUMPFILE"; nocase; distance:0; content:"c|3a|/windows/system32/"; nocase; fast_pattern; content:".exe"; nocase; distance:0; pcre:"/SELECT data FROM [^\x20]+?\x20INTO DUMPFILE [\x27\x22]c\x3a\/windows\/system32\/[a-z0-9_-]+?\.exe[\x27\x22]/i"; sid:100723; rev:4;)
alert tcp any any -> any 3306 (msg:"MySQL Server for Windows Remote SYSTEM Level Exploit (Stuxnet Technique)"; flow:to_server,established; content:"|03|"; offset:3; depth:4; content:"INSERT INTO"; nocase; distance:0; content:"#pragma namespace("; nocase; distance:0; content:"|5c 5c 5c|.|5c 5c 5c 5c|root|5c 5c 5c 5c|"; nocase; distance:0; content:"__EventFilter"; nocase; distance:0; content:" __InstanceModificationEvent"; nocase; distance:0; content:"TargetInstance"; nocase; distance:0; content:"Win32_LocalTime"; nocase; distance:0; content:"ActiveScriptEventConsumer"; nocase; distance:0; content:"JScript"; nocase; distance:0; content:"WScript.Shell"; nocase; distance:0; content:"WSH.run"; nocase; distance:0; content:".exe"; distance:0; content:"__FilterToConsumerBinding"; pcre:"/WSH\.run\x28\x5c+?[\x22\x27][a-z0-9_-]+?\.exe/"; sid:100724; rev:3;)
alert tcp any any -> any 1024: (msg:"WORM Worm.Win32.Autorun.AAV Checkin"; flow:to_server,established; content:"UNIX UNIX |3A|"; offset:5; depth:128; nocase; pcre:"/USER \S+ UNIX UNIX \x3A/mi"; sid:100725; rev:1;)
alert tcp any any -> any 1024: (msg:"WORM Worm.Win32.Carrier.ih Checkin (hello)"; flow:to_server,established; dsize:12; content:"|5b|S|5d|hello|7c 5b|E|5d|"; depth:12; sid:100726; rev:1;)
alert tcp any any -> any 1024: (msg:"WORM Worm.Win32.Carrier.ih (infection)"; flow:to_server,established; content:"|5b|S|5d|USB|7c|Infected Drive "; depth:22; sid:100727; rev:2;)
alert tcp any any -> any 1024: (msg:"WORM Worm.Win32.Imamihong.A flowbits set 1"; flow:to_server,established; dsize:4; content:"|1a e2 68 54|"; flowbits:set,ETPRO.Imamihong.A.TSL.a; flowbits:noalert; sid:100728; rev:1;)
alert tcp any any -> any 1024: (msg:"WORM Worm.Win32.Imamihong.A flowbits set 1"; flow:to_server,established; dsize:4; content:"|EF 6D 51 23|"; flowbits:set,ETPRO.Imamihong.A.TSL.b; flowbits:noalert; sid:100729; rev:1;)
alert tcp any any -> any 1234 (msg:"WORM Worm.Win32.Slenfbot.G Checkin 1"; flow:to_server,established; content:"NICK NEW-["; depth:10; nocase; pcre:"/^\S{3}|[0123]\d|\S{0,8}|\d{3,6}\x5D/Ri"; sid:100730; rev:1;)
alert tcp any any -> any 1234 (msg:"WORM Worm.Win32.Slenfbot.G Checkin 2"; flow:to_server,established; content:"PASS xxx|0D|"; depth:9; nocase; flowbits:set,ETPRO.slenfbot_g_pass; flowbits:noalert; sid:100731; rev:1;)
alert tcp any any -> any 1234 (msg:"WORM Worm.Win32.Slenfbot.G Checkin 3"; flow:to_server,established; flowbits:isset,ETPRO.slenfbot_g_pass; content:"NICK ["; depth:6; pcre:"/^\S{3}|[0123]\d|\S{0,8}|\d{3,6}\x5D/Ri"; flowbits:unset,ETPRO.slenfbot_g_pass; sid:100732; rev:1;)
alert tcp any any -> any any (msg:"WORM W32/Njw0rm CnC Beacon"; flow:established,to_server; content:"lv0njxq80"; depth:9; content:"njxq80"; distance:0; sid:100733; rev:3;)
alert tcp any any -> any $HTTP_PORTS (msg:"WORM Possible Worm Sohanad.Z or Other Infection Request for setting.nql"; flow:established,to_server; content:"/setting.nql"; nocase; sid:100734; rev:3;)
alert tls any any -> any any (msg:"BlackEnergy SSL Cert"; flow:from_server,established; content:"|16|"; content:"|0b|"; within:8; content:"|09 00 9a ba cb 13 6d 76 5b 79|"; distance:0; fast_pattern; content:"|55 04 06|"; distance:0; content:"|02|XX"; distance:1; within:3; content:"|55 04 07|"; distance:0; content:"|0c|Default City"; distance:1; within:13; content:"|55 04 0a|"; distance:0; content:"|13|Default Company Ltd"; distance:1; within:20; sid:100735; rev:2;)
alert tls any any -> any any (msg:"BlackEnergy SSL Cert"; flow:from_server,established; content:"|55 04 07|"; content:"|0c|Default City"; distance:1; within:13; content:"|55 04 0b|"; distance:0; content:"|07|NETWORK"; distance:1; within:8; content:"|55 04 03|"; distance:0; content:"|0d|144.76.119.48"; distance:1; within:14; fast_pattern; sid:100736; rev:2;)
alert udp any any -> any 1434 (msg:"WORM Slammer Worm propagation attempt OUTBOUND"; content:"|04|"; depth:1; content:"|81 F1 03 01 04 9B 81 F1|"; content:"sock"; content:"send"; sid:100737; rev:8;)
alert http any any -> any any (msg:"NETWORK Incoming Masscan detected"; flow:established,to_server; content:"User-Agent|3A| masscan/"; http_header; sid:100739; rev:3;)
alert http any any -> any any (msg:"ColdFusion administrator access"; flow:established,to_server; content:"GET"; http_method; nocase; content:"/CFIDE/administrator"; nocase; sid:100740; rev:5;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt In HTTP Headers Line Continuation Evasion CRLF"; flow:to_server,established; content:"|28 29 0d 0a 20 7b|"; fast_pattern:only; sid:100741; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt In HTTP Headers Line Continuation Evasion LF"; flow:to_server,established; content:"|28 29 0a 20 7b|"; fast_pattern:only; sid:100742; rev:2;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in Client Body 2"; flow:established,to_server; content:"|25|28|25|29|25|20|25|7b|25|20"; http_client_body; fast_pattern:only; pcre:"/(:?(:?\x5e|%5e)|(:?[=?&]|\x25(:?3d|3f|26)))\s*?(:?%28|\x28)(:?%29|\x29)(:?%20|\x20)(:?%7b|\x7b)(:?%20|\x20)/Pi"; sid:100743; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in Client Body 3"; flow:established,to_server; content:"()|25|20|25|7b"; http_client_body; fast_pattern:only; pcre:"/(:?(?:\x5e|%5e)|([=?&]|\x25(?:3d|3f|26)))\s*?\(\)(?:%20|\x20)(?:%7b|\x7b)/Pi"; sid:100744; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in Client Body"; flow:established,to_server; content:"|28 29 20 7b|"; http_client_body; fast_pattern:only; pcre:"/(?:^|[=?&])\s*?\x28\x29\x20\x7b/P"; sid:100745; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in Headers"; flow:established,to_server; content:"|28 29 20 7b|"; http_header; fast_pattern:only; sid:100746; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP Cookie"; flow:established,to_server; content:"|28 29 20 7b|"; http_cookie; sid:100747; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 10"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|{%20"; nocase; fast_pattern; within:8; sid:100748; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 11"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|%7b|20|"; nocase; fast_pattern; within:8; sid:100749; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 12"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|%7b%20"; nocase; fast_pattern; within:10; sid:100750; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 13"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20{|20|"; nocase; fast_pattern; within:8; sid:100751; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 14"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20{%20"; nocase; fast_pattern; within:10; sid:100752; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 15"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20%7b|20|"; nocase; fast_pattern; within:10; sid:100753; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 16"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20%7b%20"; nocase; fast_pattern; within:12; sid:100754; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 17"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|{|20|"; nocase; fast_pattern; within:7; sid:100755; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 18"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|{%20"; nocase; fast_pattern; within:9; sid:100756; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 19"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|%7b|20|"; nocase; fast_pattern; within:9; sid:100757; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 1"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|{|20|"; nocase; fast_pattern; within:9; sid:100758; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 20"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|%7b%20"; nocase; fast_pattern; within:11; sid:100759; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 21"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20{|20|"; nocase; fast_pattern; within:9; sid:100760; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 22"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20{%20"; nocase; fast_pattern; within:11; sid:100761; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 23"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20%7b|20|"; nocase; fast_pattern; within:11; sid:100762; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 24"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20%7b%20"; nocase; fast_pattern; within:13; sid:100763; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 25"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()|20|{%20"; nocase; fast_pattern; within:7; sid:100764; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 26"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()|20|%7b|20|"; nocase; fast_pattern; within:7; sid:100765; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 27"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()|20|%7b%20"; nocase; fast_pattern; within:9; sid:100766; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 28"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()%20{|20|"; nocase; fast_pattern; within:7; sid:100767; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 29"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()%20%7b|20|"; nocase; fast_pattern; within:9; sid:100768; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 2"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|{%20"; nocase; fast_pattern; within:11; sid:100769; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 30"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()%20%7b%20"; nocase; fast_pattern; within:11; sid:100770; rev:3;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 3"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|%7b|20|"; nocase; fast_pattern; within:11; sid:100771; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 4"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|%7b%20"; nocase; fast_pattern; within:13; sid:100772; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 5"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20{|20|"; nocase; fast_pattern; within:11; sid:100773; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 6"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20{%20"; nocase; fast_pattern; within:13; sid:100774; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 7"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20%7b|20|"; nocase; fast_pattern; within:13; sid:100775; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 8"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20%7b%20"; nocase; fast_pattern; within:15; sid:100776; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in HTTP URLENCODE Generic 9"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|{|20|"; nocase; fast_pattern; within:6; sid:100777; rev:4;)
alert http any any -> any any (msg:"CVE-2014-6271 Attempt in URI"; flow:established,to_server; content:"|28 29 20 7b|"; fast_pattern:only; pcre:"/[=?&\x2f]\s*?\x28\x29\x20\x7b/U"; sid:100778; rev:4;)
alert http any any -> any any (msg:"CURRENT_EVENTS Possible ZyXELs ZynOS Configuration Download Attempt (Contains Passwords)"; flow:established,to_server; urilen:6; content:"/rom-0"; nocase; sid:100779; rev:2;)
alert http any any -> any any (msg:"GET with HTML tag in start of URI seen with PHPMyAdmin scanning"; flow:established,to_server; content:"<title>"; depth:7; content:"GET"; http_method; sid:100782; rev:2;)
alert http any any -> any any (msg:"Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)"; flow:to_server,established; content:"|0d 0a|User-Agent|3a| Mozilla/5.0 (compatible|3b| Nmap Scripting Engine"; nocase; sid:100783; rev:4;)
alert http any any -> any any (msg:"Tomcat admin-blank login credentials"; flow:to_server,established; content:"/manager/html"; nocase; content:"|0d 0a|Authorization|3a| Basic YWRtaW46|0d 0a|"; http_header; flowbits:set,ET.Tomcat.login.attempt; sid:100784; rev:7;)
alert http any any -> any any (msg:"Tomcat Web Application Manager scanning"; flow:established,to_server; content:"GET"; http_method; content:"/manager/html"; nocase; fast_pattern; content:"User-Agent|3a| Mozilla/3.0 (compatible|3b| Indy Library)|0d 0a|"; http_header; content:"|0d 0a|Authorization|3a| Basic"; http_header; sid:100785; rev:8;)
alert http any any -> any any (msg:"ZmEu Scanner User-Agent Inbound"; flow:established,to_server; content:"User-Agent|3a| ZmEu"; http_header; sid:100786; rev:2;)
alert http any any -> any any (msg:"Muieblackcat scanner"; flow:established,to_server; content:"GET /muieblackcat HTTP/1.1"; depth:26; sid:100787; rev:3;)
alert http any any -> any any (msg:"PHP Attack Tool Morfeus F Scanner"; flow:established,to_server; content:"|0d 0a|User-Agent|3a| Morfeus"; nocase; sid:100788; rev:11;)
alert http any any -> any $HTTP_PORTS (msg:"Tomcat upload from external source"; flow:to_server,established; flowbits:isset,ET.Tomcat.login.attempt; content:"POST "; nocase; depth:5; uricontent:"/manager/html/upload"; nocase; sid:100790; rev:4;)
alert http any any -> any any (msg:"WordPress xmlrpc.php wp.getUsersBlogs Flowbit Set"; flow:established,to_server; content:"/xmlrpc.php"; nocase; fast_pattern:only; flowbits:set,ET.XMLRPC.PHP; flowbits:noalert; sid:100791; rev:3;)
alert http any any -> any any (msg:"DFind w00tw00t GET-Requests"; flow:established,to_server; content:"GET"; nocase; http_method; content:"/w00tw00t."; nocase; sid:100796; rev:7;)
alert http any any -> any any (msg:"IIS 8.3 Filename With Wildcard (Possible File/Dir Bruteforce)"; flow:established,to_server; content:"~1"; fast_pattern:only; pcre:"/([\*\?]~1|~1\.?[\*\?]|\/~1\/)/U"; sid:100797; rev:3;)
alert http any any -> any any (msg:"Apache Struts OGNL Command Execution CVE-2013-2251 redirect"; flow:established,to_server; content:".action"; content:"redirect|3a|"; http_client_body; content:"{"; http_client_body; distance:0; pcre:"/\bredirect\x3a/P"; sid:100798; rev:4;)
alert tcp any any -> any 1194 (msg:"OpenVPN CVE-2014-6271 attempt"; flow:to_server,established; content:"|20|"; depth:1; content:"|28 29 20 7b|"; fast_pattern:only; sid:100806; rev:2;)
alert tcp any any -> any 21 (msg:"Pure-FTPd CVE-2014-6271 attempt"; flow:to_server,established; content:"|28 29 20 7b 20|"; fast_pattern:only; sid:100807; rev:1;)
alert tcp any any -> any [25,587] (msg:"Postfix CVE-2014-6271 attempt"; flow:to_server,established; content:"|28 29 20 7b|"; fast_pattern:only; pcre:"/^[a-z-]+\s*?\x3a\s*?[^\r\n]*?\x28\x29\x20\x7b/mi"; sid:100808; rev:3;)
alert tcp any any -> any [25,587] (msg:"Qmail CVE-2014-6271 Mail From attempt"; flow:to_server,established; content:"|28 29 20 7b|"; fast_pattern:only; pcre:"/^mail\s*?from\s*?\x3a\s*?[^\r\n]*?\x28\x29\x20\x7b/mi"; sid:100809; rev:2;)
alert tcp any any -> any [5060,5061] (msg:"CVE-2014-6271 Attempt Against SIP Proxy"; flow:to_server,established; content:"|28 29 20 7b|"; fast_pattern:only; sid:100812; rev:2;)
alert tcp any any -> any any (msg:"CURRENT_EVENTS TLS HeartBeat Request (Client Initiated) fb set"; flow:established,to_server; content:"|18 03|"; depth:2; byte_test:1,<,4,2; flowbits:isnotset,ET.HB.Response.CI; flowbits:set,ET.HB.Request.CI; flowbits:noalert; sid:100813; rev:4;)
alert tcp any any -> any any (msg:"CURRENT_EVENTS TLS HeartBeat Request (Server Initiated) fb set"; flow:established,from_server; content:"|18 03|"; depth:2; byte_test:1,<,4,2; flowbits:isnotset,ET.HB.Response.SI; flowbits:set,ET.HB.Request.SI; flowbits:noalert; sid:100814; rev:3;)
alert tcp any any -> any $HTTP_PORTS (msg:"CVE-2014-6271 Attempt in HTTP Version Number"; flow:established,to_server; content:"|20 28 29 20 7b|"; fast_pattern:only; pcre:"/^[^\s]+\s+[^\s]+\s+\x28\x29\x20\x7b[^\r\n]*?\r?$/m"; sid:100817; rev:3;)
alert tcp any 53 -> any any (msg:"CVE-2014-6271 exploit attempt via malicious DNS"; byte_test:1,&,128,4; content:"|28 29 20 7b|"; fast_pattern:only; sid:100818; rev:1;)
alert tcp any any -> any 1024: (msg:"Linux/DDoS.M GETLOCALIP command"; flow:established,to_client; content:"GETLOCALIP "; depth:11; flowbits:isset,ET.lizkebab; sid:100819; rev:1;)
alert tcp any any -> any 1024: (msg:"Linux/DDoS.M JUNK command"; flow:established,to_client; content:"JUNK "; depth:5; flowbits:isset,ET.lizkebab; sid:100820; rev:1;)
alert tcp any any -> any 1024: (msg:"Linux/DDoS.M KILLATTK command"; flow:established,to_client; content:"KILLATTK "; depth:9; flowbits:isset,ET.lizkebab; sid:100821; rev:1;)
alert tcp any any -> any 1024: (msg:"Linux/DDoS.M LOLNOGTFO command"; flow:established,to_client; content:"LOLNOGTFO "; depth:10; flowbits:isset,ET.lizkebab; sid:100822; rev:2;)
alert tcp any any -> any 1024: (msg:"Linux/DDoS.M SCANNER command"; flow:established,to_client; content:"SCANNER "; depth:8; pcre:"/^(?:ON|OFF)/R"; flowbits:isset,ET.lizkebab; sid:100823; rev:1;)
alert tcp any any -> any 3389 (msg:"MS Terminal Server User A Login, possible Morto inbound"; flow:to_server,established; content:"|03 00 00|"; depth:3; content:"|e0 00 00 00 00 00|"; offset:5; depth:6; content:"Cookie|3a| mstshash=a|0d 0a|"; nocase; sid:100828; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot Execute Shell Command CnC Server Message"; flow:established,to_client; content:"! SH"; depth:4; pcre:"/^[^\r\n]+?\n$/R"; sid:100831; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot Get Bot IP CnC Server Message"; flow:established,to_client; dsize:13; content:"! GETLOCALIP|0A|"; depth:13; sid:100832; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot HOLD TCP Flood CnC Server Message"; flow:established,to_client; content:"! HOLD "; depth:7; pcre:"/\x21\x20HOLD\x20\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}/"; sid:100833; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot Kill Attack CnC Server Message"; flow:established,to_client; dsize:11; content:"! KILLATTK|0A|"; depth:11; sid:100834; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot Ping CnC Server Message"; flow:established,to_client; dsize:7; content:"! PING|0A|"; depth:7; sid:100835; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot Random Byte Flood CnC Server Message"; flow:established,to_client; content:"! JUNK "; depth:7; pcre:"/\x21\x20JUNK\x20\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}/"; sid:100836; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot Scanner CnC Server Message"; flow:established,to_client; dsize:12<>15; content:"! SCANNER "; depth:10; pcre:"/\x21\x20SCANNER\x20(ON|OFF)\x0A/"; sid:100837; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot TCP Flood CnC Server Message"; flow:established,to_client; content:"! TCP "; depth:6; pcre:"/\x21\x20TCP\x20\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}/"; sid:100838; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot Terminate Process CnC Server Message"; flow:established,to_client; dsize:12; content:"! LOLNOGTFO|0A|"; depth:12; sid:100839; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot UDP Flood CnC Server Message"; flow:established,to_client; content:"! UDP "; depth:6; pcre:"/\x21\x20UDP\x20\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}/"; sid:100840; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"Tomcat admin-admin login credentials"; flow:to_server,established; uricontent:"/manager/html"; nocase; content:"|0d 0a|Authorization|3a| Basic YWRtaW46YWRtaW4=|0d 0a|"; flowbits:set,ET.Tomcat.login.attempt; sid:100841; rev:6;)
alert tcp any any -> any any (msg:"Linux/DDoS.M distributed via CVE-2014-6271 Checkin"; flow:established,to_server; content:"BUILD "; depth:6; pcre:"/^(?:MIPS(?:EL)?|POWERPC|ARM|X86)\x0a$/R"; flowbits:set,ET.lizkebab; sid:100850; rev:2;)
alert tcp any any -> any any (msg:"Linux/ShellshockCampaign.DDOSBot Reporting IP"; flow:established,to_server; dsize:<24; content:"My IP|3A| "; depth:7; pcre:"/My\x20IP\x3A\x20\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x0A/"; sid:100851; rev:1;)
alert udp any 67 -> any 68 (msg:"CVE-2014-6271 exploit attempt via malicious DHCP ACK"; content:"|02 01|"; depth:2; content:"|28 29 20 7b|"; fast_pattern:only; sid:100856; rev:4;)
alert udp any any -> any 1194 (msg:"OpenVPN CVE-2014-6271 attempt"; flow:to_server; content:"|20|"; depth:1; content:"|28 29 20 7b|"; fast_pattern:only; sid:100857; rev:2;)
alert udp any any -> any [5060,5061] (msg:"CVE-2014-6271 Attempt Against SIP Proxy"; flow:to_server; content:"|28 29 20 7b|"; fast_pattern:only; sid:100858; rev:3;)
alert udp any 53 -> any any (msg:"CVE-2014-6271 malicious DNS response"; byte_test:1,&,128,2; content:"|28 29 20 7b|"; fast_pattern:only; sid:100859; rev:1;)
alert tcp any any -> any 1521 (msg:"Oracle Database TNS Detected"; flow:to_server,established; content:"DESCRIPTION"; depth:100; nocase; flowbits:set,oracle.connect; flowbits:noalert; sid:100865; rev:2;)
alert tcp any any -> any 25 (msg:"SMTP AUTH CMD FIND"; flow:to_server,established; flowbits:set,smtp_login; flowbits:noalert; content:"AUTH|20|"; nocase; offset:0; depth:5; sid:100872; rev:2;)
alert tcp any 25 -> any any (msg:"SMTP Authentication Success"; flow:to_client,established; flowbits:unset,smtp_login; flowbits:noalert; content:"235|20|"; nocase; offset:0; depth:4; sid:100873; rev:2;)
alert tcp any any -> any 110 (msg:"POP3 PASS CMD FIND"; flow:to_server,established; flowbits:set,pop3_login; flowbits:noalert; content:"PASS|20|"; nocase; offset:0; depth:5; sid:100876; rev:2;)
alert tcp any any -> any 110 (msg:"POP3 APOP CMD FIND"; flow:to_server,established; flowbits:set,pop3_login; flowbits:noalert; content:"APOP|20|"; nocase; offset:0; depth:5; sid:100877; rev:2;)
alert tcp any 110 -> any any (msg:"POP3 Authentication Success"; flow:to_client,established; flowbits:unset,pop3_login; flowbits:noalert; content:"+OK|20|"; nocase; offset:0; depth:4; sid:100878; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"HTTP /etc/passwd access attempt"; flow:to_server,established; content:"/etc/passwd"; nocase; sid:100883; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"HTTP /etc/shadow access attempt"; flow:to_server,established; content:"/etc/shadow"; nocase; sid:100884; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"HTTP JavaScript Obfuscation Detected"; flow:to_client,established; content:"<script"; nocase; content:"unescape"; nocase; pcre:"/(eval|unescape)\s*\(\s*unescape\s*\(/ism"; sid:100885; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"HTTP JavaScript Obfuscation Detected"; flow:to_client,established; content:"<script"; nocase; content:"unescape|28|"; nocase; content:"string|2e|fromcharcode|28|"; nocase; sid:100886; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"HTTP JavaScript Obfuscation Detected"; flow:to_client,established; content:"<script"; nocase; content:"fromCharCode"; nocase; pcre:"/new\s+ActiveXObject\s*\(\s*String\.fromCharCode\s*\(/ism"; sid:100887; rev:2;)
alert tcp any any -> any 7168 (msg:"Billgates botnet command and control channel traffic"; flow:to_server; content:"|b6 b6 b6 b6 b6 b6 b6 b6|"; depth:50; content:"gffc"; depth:50; sid:100892; rev:2;)
alert tcp any any -> any 36667 (msg:"Billgates botnet command and control channel traffic"; flow:to_server; content:"buyaocaowo"; depth:100; sid:100893; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER SHOW VARIABLES SQL Injection Attempt"; flow:established,to_server; content:"SHOW"; nocase; content:"VARIABLES"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?SHOW\s+VARIABLES\b/Ui"; sid:100894; rev:4;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER SHOW VARIABLES SQL Injection Attempt"; flow:established,to_server; content:"SHOW"; nocase; http_client_body; content:"VARIABLES"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?SHOW\b[^\x26\x3d]*?VARIABLES\b/Pi"; sid:100895; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER SHOW VARIABLES SQL Injection Attempt"; flow:established,to_server; content:"SHOW"; nocase; http_cookie; content:"VARIABLES"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?SHOW\b[^\x26\x3d]*?VARIABLES\b/Ci"; sid:100896; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER SHOW TABLES SQL Injection Attempt"; flow:established,to_server; content:"SHOW"; nocase; content:"TABLES"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?SHOW\s+TABLES\b/Ui"; sid:100897; rev:4;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER SHOW TABLES SQL Injection Attempt"; flow:established,to_server; content:"SHOW"; nocase; http_client_body; content:"TABLES"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?SHOW\b[^\x26\x3d]*?TABLES\b/Pi"; sid:100898; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER SHOW TABLES SQL Injection Attempt"; flow:established,to_server; content:"SHOW"; nocase; http_cookie; content:"TABLES"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?SHOW\b[^\x26\x3d]*?TABLES\b/Ci"; sid:100899; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible GRANT TO SQL Injection Attempt"; flow:established,to_server; content:"GRANT"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?GRANT\b[^\x26\x3d]*?TO\b/Ui"; sid:100900; rev:3;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible GRANT TO SQL Injection Attempt"; flow:established,to_server; content:"GRANT"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?GRANT\b[^\x26\x3d]*?TO\b/Pi"; sid:100901; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible GRANT TO SQL Injection Attempt"; flow:established,to_server; content:"GRANT"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?GRANT\b[^\x26\x3d]*?TO\b/Ci"; sid:100902; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible ALTER SQL Injection Attempt"; flow:to_server,established; content:"ALTER"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?ALTER\s+(database|proc|table|column)/Ui"; sid:100903; rev:5;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible ALTER SQL Injection Attempt"; flow:established,to_server; content:"ALTER"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?ALTER\b[^\x26\x3d]*?(database|proc|table|column)/Pi"; sid:100904; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible ALTER SQL Injection Attempt"; flow:established,to_server; content:"ALTER"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?ALTER\b[^\x26\x3d]*?(database|proc|table|column)/Ci"; sid:100905; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible CREATE SQL Injection Attempt"; flow:to_server,established; content:"CREATE"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?CREATE\s+(database|proc|table)/Ui"; sid:100906; rev:6;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible CREATE SQL Injection Attempt"; flow:established,to_server; content:"CREATE"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?CREATE\b[^\x26\x3d]*?(database|proc|table)/Pi"; sid:100907; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible CREATE SQL Injection Attempt"; flow:established,to_server; content:"CREATE"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?CREATE\b[^\x26\x3d]*?(database|proc|table)/Ci"; sid:100908; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible DROP SQL Injection Attempt"; flow:to_server,established; content:"DROP"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?DROP\s+(database|proc|table|column)/Ui"; sid:100909; rev:5;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible DROP SQL Injection Attempt"; flow:established,to_server; content:"DROP"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?DROP\b[^\x26\x3d]*?(database|proc|table|column)/Pi"; sid:100910; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible DROP SQL Injection Attempt"; flow:established,to_server; content:"DROP"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?DROP\b[^\x26\x3d]*?(database|proc|table|column)/Ci"; sid:100911; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt DELETE FROM"; flow:established,to_server; content:"DELETE"; nocase; content:"FROM"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?DELETE\s+FROM\b/Ui"; sid:100912; rev:12;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt DELETE FROM"; flow:established,to_server; content:"DELETE"; nocase; http_client_body; content:"FROM"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?DELETE\b[^\x26\x3d]*?FROM\b/Pi"; sid:100913; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt DELETE FROM"; flow:established,to_server; content:"DELETE"; nocase; http_cookie; content:"FROM"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?DELETE\b[^\x26\x3d]*?FROM\b/Ci"; sid:100914; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt INSERT INTO"; flow:established,to_server; content:"INSERT"; nocase; content:"INTO"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?INSERT\s+INTO\b/Ui"; sid:100915; rev:11;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt INSERT INTO"; flow:established,to_server; content:"INSERT"; nocase; http_client_body; content:"INTO"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?INSERT\b[^\x26\x3d]*?INTO\b/Pi"; sid:100916; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt INSERT INTO"; flow:established,to_server; content:"INSERT"; nocase; http_cookie; content:"INTO"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?INSERT\b[^\x26\x3d]*?INTO\b/Ci"; sid:100917; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt UPDATE SET"; flow:established,to_server; content:"UPDATE"; nocase; content:"SET"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?UPDATE\b[^\x26\x3d]*?SET\b/Ui"; sid:100918; rev:13;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt UPDATE SET"; flow:established,to_server; content:"UPDATE"; nocase; http_client_body; content:"SET"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?UPDATE\b[^\x26\x3d]*?SET\b/Pi"; sid:100919; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt UPDATE SET"; flow:established,to_server; content:"UPDATE"; nocase; http_cookie; content:"SET"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?UPDATE\b[^\x26\x3d]*?SET\b/Ci"; sid:100920; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt SELECT FROM"; flow:established,to_server; content:"SELECT"; nocase; content:"FROM"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?SELECT\b[^\x26\x3d]*?FROM\b/Ui"; sid:100921; rev:11;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt SELECT FROM"; flow:established,to_server; content:"SELECT"; nocase; http_client_body; content:"FROM"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?SELECT\b[^\x26\x3d]*?FROM\b/Pi"; sid:100922; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt SELECT FROM"; flow:established,to_server; content:"SELECT"; nocase; http_cookie; content:"FROM"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?SELECT\b[^\x26\x3d]*?FROM\b/Ci"; sid:100923; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt UNION SELECT"; flow:established,to_server; content:"UNION"; nocase; content:"SELECT"; nocase; pcre:"/[\x3d\x3b\x22\x27][^\x26\x3d]*?UNION\b[^\x26\x3d]*?SELECT\b/Ui"; sid:100924; rev:12;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt UNION SELECT"; flow:established,to_server; content:"UNION"; nocase; http_client_body; content:"SELECT"; nocase; http_client_body; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?UNION\b[^\x26\x3d]*?SELECT\b/Pi"; sid:100925; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt UNION SELECT"; flow:established,to_server; content:"UNION"; nocase; http_cookie; content:"SELECT"; nocase; http_cookie; pcre:"/(\x3d|\x3b|\x22|\x27|\x29|%3d|%3b|%22|%27|%29)[^\x26\x3d]*?UNION\b[^\x26\x3d]*?SELECT\b/Ci"; sid:100926; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt OR"; flow:established,to_server; content:"|20|OR|20|"; nocase; pcre:"/\x3d[^\x26\x3d]*?[\x22\x27\x29][^\x26\x3d]*?\s+OR\s+\d+\s*\x3d/Ui"; sid:100927; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt OR"; flow:established,to_server; content:"|20|OR|20|"; nocase; http_client_body; pcre:"/\x3d[^\x26\x3d]*?[\x22\x27\x29][^\x26\x3d]*?\s+OR\s+\d+\s*\x3d/Pi"; sid:100928; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt OR"; flow:established,to_server; content:"%20OR%20"; nocase; http_client_body; pcre:"/(\x3d|%3d)[^\x26]*?(\x22|\x27|\x29|%22|%27|%29)[^\x26]*?%20OR(%20)+\d+(%20|\s)*(\x3d|%3d)/Pi"; sid:100929; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt AND"; flow:established,to_server; content:"|20|AND|20|"; nocase; pcre:"/\x3d[^\x26\x3d]*?[\x22\x27\x29][^\x26\x3d]*?\s+AND\s+\d+\s*\x3d/Ui"; sid:100930; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt AND"; flow:established,to_server; content:"|20|AND|20|"; nocase; http_client_body; pcre:"/\x3d[^\x26\x3d]*?[\x22\x27\x29][^\x26\x3d]*?\s+AND\s+\d+\s*\x3d/Pi"; sid:100931; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt AND"; flow:established,to_server; content:"%20AND%20"; nocase; http_client_body; pcre:"/(\x3d|%3d)[^\x26]*?(\x22|\x27|\x29|%22|%27|%29)[^\x26]*?%20AND(%20)+\d+(%20|\s)*(\x3d|%3d)/Pi"; sid:100932; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"WEB_SERVER Possible SQL Injection Attempt xp_cmdshell"; flow:established,to_server; content:"master|2e|dbo|2e|xp_cmdshell"; nocase; http_client_body; pcre:"/(\x3b|%3b).*?exec\b.*?master\x2edbo\x2exp_cmdshell/Pi"; sid:100933; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - <script"; flow:to_server,established; content:"script"; nocase; pcre:"/(\x3c|%3c|%253c)(%00)*script\b/Ii"; sid:100934; rev:7;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - <script"; flow:to_server,established; content:"script"; nocase; http_client_body; pcre:"/(\x3c|%3c|%253c)(%00)*script\b/Pi"; sid:100935; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - Alert"; flow:to_server,established; content:"alert|28|"; nocase; pcre:"/[\x22\x27\x29\x3b\x3c\x3e]+[^\x26]*?alert\x28/Ui"; sid:100936; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - Alert"; flow:to_server,established; content:"alert"; nocase; http_client_body; pcre:"/([\x22\x27\x29\x3b\x3c\x3e]|%22|%27|%29|%3b|%3c|%3e)+[^\x26]*?\balert(\x28|%28)/Pi"; sid:100937; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - Event function"; flow:to_server,established; content:"|20|on"; nocase; pcre:"/=[^\x26]*?[\x22\x27\x3c\x3e]+[^\x26]*?\bon(mouse[a-z]+|key[a-z]+|load|unload|dragdrop|blur|focus|click|dblclick|submit|reset|select|change)\b[^\x26]*?=/Ui"; sid:100938; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - Event function"; flow:to_server,established; content:"|22|on"; nocase; pcre:"/=[^\x26]*?[\x22\x27\x3c\x3e]+[^\x26]*?\bon(mouse[a-z]+|key[a-z]+|load|unload|dragdrop|blur|focus|click|dblclick|submit|reset|select|change)\b[^\x26]*?=/Ui"; sid:100939; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - Event function"; flow:to_server,established; content:"|27|on"; nocase; pcre:"/=[^\x26]*?[\x22\x27\x3c\x3e]+[^\x26]*?\bon(mouse[a-z]+|key[a-z]+|load|unload|dragdrop|blur|focus|click|dblclick|submit|reset|select|change)\b[^\x26]*?=/Ui"; sid:100940; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - <frame or <iframe"; flow:to_server,established; content:"frame"; nocase; pcre:"/\x3c[i]?frame\b[^\x26]*?src\b/Ui"; sid:100941; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - <frame or <iframe"; flow:to_server,established; content:"frame"; nocase; http_client_body; pcre:"/(\x3c|%3c)[i]?frame\b[^\x26]*?src\b/Pi"; sid:100942; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - <img"; flow:to_server,established; content:"<img"; nocase; pcre:"/\x3cimg\b[^\x26]*?src\b/Ui"; sid:100943; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - <embed"; flow:to_server,established; content:"<embed"; nocase; pcre:"/\x3cembed\b[^\x26]*?src\b/Ui"; sid:100944; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"Cross Site Scripting Attempt - <embed"; flow:to_server,established; content:"embed"; nocase; http_client_body; pcre:"/(\x3c|%3c)embed\b[^\x26]*?src\b/Pi"; sid:100945; rev:1;)
alert http any any -> any any (msg:"Win32.SpyEye.cuk Checkin"; flow:established,from_server; flowbits:isset,ETPRO_SPYEYE; content:"|2a 2f|"; content:"bank"; nocase; distance:0; content:"bank"; distance:0; flowbits:unset,ETPRO_SPYEYE; sid:100949; rev:3;)
alert http any any -> any any (msg:"OneLouder EXE download possibly installing Zeus P2P"; flow:to_client,established; flowbits:isset,ET.OneLouder.Header; content:"|0d 0a 0d 0a|MZ"; byte_jump:4,60,little,from_beginning; content:"PE|00 00|"; within:4; sid:100950; rev:5;)
alert http any any -> any any (msg:"OneLouder EXE download possibly installing Zeus P2P"; flow:to_client,established; flowbits:isset,ET.OneLouderHeader; content:"|0d 0a 0d 0a|MZ"; content:"PE|00 00|"; fast_pattern:only; sid:100951; rev:5;)
alert http any any -> any any (msg:"Zeus/Citadel Control Panel Access (Inbound)"; flow:established,to_server; content:".php?m=login"; fast_pattern:only; nocase; content:"user="; depth:5; http_client_body; nocase; content:"pass="; http_client_body; nocase; sid:100953; rev:8;)
alert http any any -> any any (msg:"Zeus Spam Campaign pdf.exe In ZIP - 26th Feb 2014"; flow:established,to_client; content:"|0d 0a 0d 0a|PK"; content:"pdf.exe"; distance:42; within:500; sid:100954; rev:4;)
alert http any any -> any 1024: (msg:"Pakes/Cutwail/Kobcka Checkin Detected High Ports"; flow:established,to_server; content:"/?bot_id=0&mode=1"; fast_pattern:only; sid:100957; rev:7;)
alert http any any -> any any (msg:"Win32.Chir.B Checkin"; flow:established,to_server; content:"GET"; http_method; content:"NSIS_Inetc (Mozilla)"; http_header; fast_pattern:only; content:!"Referer|3a 20|"; http_header; content:"funnel="; content:"detected_products="; content:"channel="; sid:100958; rev:2;)
alert http any any -> any any (msg:"Alureon CnC Beacon"; flow:established,to_server; content:"POST"; http_method; content:!"Referer|3a|"; http_header; content:!"Accept"; http_header; content:!"Content-Type"; http_header; content:!"Cookie|3a|"; content:"MSIE"; http_header; pcre:"/^[\x20-\x7e\r\n]{0,20}[^\x20-\x7e\r\n]/P"; pcre:"/^User-Agent\x3a[^\r\n]+\r\nHost\x3a[^\r\n]+\r\nContent-Length\x3a\x20\d{2,3}\r\n(?:Cache-Control|Pragma)\x3a[^\r\n]+\r\n(?:\r\n)?$/Hmi"; content:".php|20|HTTP/1.1|0d 0a|User-"; fast_pattern:only; sid:100959; rev:4;)
alert http any any -> any any (msg:"Alureon.EC.134 Checkin"; flow:to_server,established; content:"/dx.php?i="; content:"&a="; content:"&f="; sid:100960; rev:2;)
alert http any any -> any any (msg:"Autorun.ajbk/Alureon.J Checkin"; flow:established,to_server; content:"POST"; nocase; http_method; content:"/cgi-bin/generatorx"; content:" HTTP/1.0|0d 0a|Content-Length|3a| "; content:"|0d 0a 0d 0a|"; within:10; sid:100961; rev:4;)
alert http any any -> any any (msg:"Backdoor/Win32.ZAccess Checkin"; flow:established,to_server; content:".php?m="; fast_pattern:only; content:"&s="; content:"&v="; pcre:"/\.php\?m=([a-f0-9]{2}\x2d){5}[a-f0-9]{2}/Ui"; content:"User-Agent|3a| "; http_header; content:!"Mozilla"; within:7; http_header; sid:100962; rev:2;)
alert http any any -> any any (msg:"Downloader (P2P Zeus dropper UA)"; flow:established,to_server; content:"User-Agent|3a| Opera10"; http_header; sid:100963; rev:2;)
alert http any any -> any any (msg:"Olmarik/Alureon Checkin"; flow:established,to_server; content:".php?i="; content:"&a="; content:"&f="; content:"&x64="; fast_pattern; content:"&os="; content:!"User-Agent|3a| "; http_header; sid:100964; rev:2;)
alert http any any -> any any (msg:"SpyEye Checkin version unknown"; flow:established,to_server; content:"POST"; nocase; http_method; content:".php"; content:"data=3M7S34"; fast_pattern; http_client_body; depth:11; content:!"Referer|3a 20|"; http_header; content:!"|0d 0a|Accept"; http_header; sid:100965; rev:3;)
alert http any any -> any any (msg:"Spyeye/PWS.Spysweep Checkin"; flow:to_server,established; content:"POST"; nocase; http_method; content:"/gate.php"; content:"data="; http_client_body; pcre:"/data=[a-z0-9\/\+]{236}/iP"; sid:100966; rev:6;)
alert http any any -> any any (msg:"TDSS.aifh/Alureon Checkin"; flow:established,to_server; content:"POST"; nocase; http_method; content:"/nfoc.php"; content:"POST /nfoc.php HTTP/1.0|0d 0a|"; depth:25; content:!"User-Agent|3a|"; sid:100967; rev:4;)
alert http any any -> any any (msg:"TDSS.xcn Checkin"; flow:to_server,established; content:"/index1.php?ver="; content:"&p="; content:"&id="; sid:100968; rev:2;)
alert http any any -> any any (msg:"Trojan.Win32.TDSS.bsqo Checkin"; flow:established,to_server; content:"POST"; nocase; http_method; urilen:7; content:"/kx.php"; content:"Content-Type|3a| application/x-www-form"; depth:36; http_header; content:!"User-Agent|3a| "; http_header; content:!"Accept|3a| "; http_header; content:"SIY1"; depth:4; fast_pattern; http_client_body; sid:100970; rev:3;)
alert http any any -> any any (msg:"Trojan.Win32.TDSS.iqjw Checkin"; flow:established,to_server; content:"/knock"; content:".php?log="; distance:0; content:"stage="; fast_pattern; content:"error="; content:"os="; pcre:"/\/knock(\d+)?\x2ephp\x3flog\x3d(Start(Dllx32)?|CONFIG_(DLL_OK|CFG_OK)|LoaderMon(Start|End|Dll|LoadDriver))/U"; sid:100971; rev:3;)
alert http any any -> any any (msg:"Variant.TDss.24 Checkin"; flow:to_server,established; content:"?type="; content:"&sid="; content:"&sw="; content:"&osfwtype="; sid:100972; rev:1;)
alert http any any -> any any (msg:"Win32/Alureon.BV / Trojan.TDss.FJ Checkin"; flow:to_server,established; content:"/seneka/engine/engine.php?d="; sid:100973; rev:2;)
alert http any any -> any any (msg:"Win32/Alureon.CO Checkin"; flow:to_server,established; content:"POST"; http_method; nocase; content:"/k.php"; content:!"User-Agent|3a| "; http_header; content:"SIY1"; fast_pattern; depth:4; http_client_body; pcre:"/\/k\.php$/U"; sid:100974; rev:2;)
alert http any any -> any any (msg:"Win32/Alureon.DA Checkin"; flow:established,to_server; content:"GET"; http_method; content:"/page"; content:"/setup"; fast_pattern; distance:1; within:6; pcre:"/\/page\d\/setup\d+?$/U"; content:"User-Agent|3a| "; http_header; depth:12; content:!"Accept|3a|"; http_header; sid:100975; rev:2;)
alert http any any -> any any (msg:"Win32/Alureon.FL Checkin"; flow:to_server,established; content:"/testadd.php?aid="; content:"/testadd.php?aid="; content:"&sid="; content:"&bid="; content:"&mode="; sid:100976; rev:2;)
alert http any any -> any any (msg:"Win32/Alureon.GD Checkin"; flow:to_server,established; content:"/tasktest/"; fast_pattern:only; content:"/?c="; pcre:"/^\/tasktest\/\d\/\x3fc\x3d\d+?$/Ui"; content:!"Accept|3a| "; http_header; content:!"Referer"; http_header; sid:100977; rev:4;)
alert http any any -> any any (msg:"Win32/Alureon.V exe download 1"; flow:established,to_server; content:"/bpfull/bpfull.exe"; sid:100978; rev:4;)
alert http any any -> any any (msg:"Win32/Alureon.V exe download 2"; flow:established,to_server; content:"/e4u.exe"; nocase; sid:100979; rev:3;)
alert http any any -> any any (msg:"Win32/Chir.D Checkin"; flow:to_server,established; content:"POST"; http_method; nocase; content:"User-Agent|3a| Mozilla/5.0 (Windows|3b| U|3b| Windows NT 6.0|3b|"; http_header; content:"name=|22|address|22|"; http_client_body; content:"|22|clientID|22|"; fast_pattern:only; http_client_body; content:"|22|branch|22|"; http_client_body; content:"|22|cmd|22|"; http_client_body; content:"|22|key|22|"; http_client_body; sid:100980; rev:2;)
alert http any any -> any any (msg:"Win32.SpyEye.cuk Checkin flowbit SET"; flow:established,to_server; content:"POST"; nocase; http_method; content:!"User-Agent|3a 20|"; http_header; content:"|00 2e 00|e|00|x|00|e|00|"; fast_pattern; http_client_body; flowbits:set,ETPRO_SPYEYE; flowbits:noalert; sid:100982; rev:4;)
alert http any any -> any any (msg:"Win32.SpyEyes.arbc Checkin 1"; flow:established,to_server; content:"POST"; http_method; content:".php"; content:"c="; depth:2; http_client_body; content:"&il="; distance:0; http_client_body; content:"&u="; distance:0; http_client_body; content:"&d="; distance:0; http_client_body; content:"&ut="; distance:0; http_client_body; content:"&wv="; http_client_body; fast_pattern:only; content:!"Referer|3a|"; http_header; pcre:"/\.php$/U"; sid:100983; rev:2;)
alert http any any -> any any (msg:"Win32.SpyEyes.arbc Checkin 2"; flow:established,to_server; content:"POST"; http_method; content:".php"; content:"c="; depth:2; http_client_body; content:"&u="; distance:0; http_client_body; content:"&d="; distance:0; http_client_body; content:"&msg="; http_client_body; fast_pattern:only; content:!"Referer|3a|"; http_header; pcre:"/\.php$/U"; sid:100984; rev:2;)
alert http any any -> any any (msg:"Win32/Spy.SpyEye.B Checkin"; flow:to_server,established; content:"/websitechk.php"; content:!"User-Agent|3a|"; http_header; content:"name=|22|bot_guid|22|"; http_client_body; content:"name=|22|bot_version|22|"; http_client_body; sid:100985; rev:2;)
alert http any any -> any any (msg:"Win32/Tedroo.A/Grum Checkin"; flow:to_server,established; content:"/spm/s_get_host.php?ver="; sid:100986; rev:4;)
alert http any any -> any any (msg:"Zeroaccess Variant 1"; flow:established,to_server; content:"GET"; http_method; content:"mYWlkP"; fast_pattern:only; content:"HTTP/1.0"; content:!"Referer|3a 20|"; http_header; pcre:"/^\/[\da-zA-Z]+?(?:mYWlkP|ZhaWQ9|JmFpZD)[\da-zA-Z]+?(?:JnNpZD|ZzaWQ9|mc2lkP)[\da-zA-Z]+?(?:mb3M|Jm9z|Zvcz)/U"; sid:100987; rev:2;)
alert http any any -> any any (msg:"Zeroaccess Variant 2"; flow:established,to_server; content:"GET"; http_method; content:"ZhaWQ9"; fast_pattern:only; content:"HTTP/1.0"; content:!"Referer|3a 20|"; http_header; pcre:"/^\/[\da-zA-Z]+?(?:mYWlkP|ZhaWQ9|JmFpZD)[\da-zA-Z]+?(?:JnNpZD|ZzaWQ9|mc2lkP)[\da-zA-Z]+?(?:mb3M|Jm9z|Zvcz)/U"; sid:100988; rev:2;)
alert http any any -> any any (msg:"Zeroaccess Variant 3"; flow:established,to_server; content:"GET"; http_method; content:"JmFpZD"; fast_pattern:only; content:"HTTP/1.0"; content:!"Referer|3a 20|"; http_header; pcre:"/^\/[\da-zA-Z]+?(?:mYWlkP|ZhaWQ9|JmFpZD)[\da-zA-Z]+?(?:JnNpZD|ZzaWQ9|mc2lkP)[\da-zA-Z]+?(?:mb3M|Jm9z|Zvcz)/U"; sid:100989; rev:3;)
alert http any any -> any any (msg:"Zeus/Carberp.C/Zbot.6/Gbot.vzf Checkin"; flow:established,to_server; content:"POST"; http_method; nocase; content:"aaaaaa"; depth:8; pcre:"/^\/[a-z]aaaaaa[a-z]{9,55}\.(doc|phtml|tpl|pl|7z|rar|rtf|php3|cgi|phtm)$/U"; sid:100990; rev:2;)
alert http any any -> any any (msg:"Zeus Checkin"; flow:established,to_server; urilen:19; content:".php?f="; offset:2; depth:7; content:"&e=2"; fast_pattern; offset:14; depth:4; pcre:"/^\/[a-z]\.php\?f\x3d[a-f0-9]{5}&e\x3d2$/Ui"; sid:100991; rev:2;)
alert http any any -> any any (msg:"ZEUS Retrieving configuration file"; flow:to_server,established; content:"POST"; nocase; http_method; content:" HTTP/1.1|0d 0a|Accept|3a 20 2a 2f 2a 0d 0a|Content-Type|3a| application/x-www-form-urlencoded|0d 0a|Connection|3a| Close|0d 0a|User-Agent|3a| Mozilla/4.0 "; content:"|0d 0a|Host|3a| "; distance:0; content:"Content-Length|3a 20|"; distance:0; content:"|0d 0a|Cache-Control|3a| no-cache|0d 0a 0d 0a|"; distance:0; content:"id="; depth:3; http_client_body; content:"&hash="; distance:0; http_client_body; sid:100992; rev:6;)
alert http any any -> any any (msg:"Zeus variant C2"; flow:to_server,established; content:"POST"; http_method; urilen:8; content:"/updatec"; fast_pattern:only; content:"Accept-Encoding|3a 0d 0a|"; content:!"Referer|3a 20|"; http_header; content:!"User-Agent|3a 20|"; http_header; sid:100993; rev:2;)
alert http any any -> any any (msg:"Grum/Tedroo Spambot Data in User-Agent"; flow:established,to_server; content:"User-Agent|3a| id="; nocase; http_header; content:"smtp="; within:100; nocase; http_header; sid:100995; rev:5;)
alert http any any -> any any (msg:"Alureon Checkin"; flow:established,to_server; content:"POST"; http_method; content:"winver="; depth:7; http_client_body; content:"&ver="; distance:0; http_client_body; content:!"User-Agent|3a|"; http_header; content:!"Referer|3a|"; http_header; pcre:"/^winver=\d+&ver=\d+$/P"; sid:100996; rev:2;)
alert http any any -> any any (msg:"FlashBack Mac OSX malware Checkin"; flow:to_server,established; content:"GET"; nocase; http_method; content:"/aaupdate/"; fast_pattern; content:"User-Agent|3a| "; http_header; content:!"Mozilla"; within:7; http_header; content:!"|0d 0a|"; within:124; http_header; sid:100997; rev:5;)
alert http any any -> any any (msg:"TDSS Download (codec.exe)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"/codec.exe"; nocase; sid:101000; rev:6;)
alert http any any -> any any (msg:"TDSS Download (pcdef.exe)"; flow:established,to_server; content:"GET"; http_method; content:"/pcdef.exe"; nocase; sid:101001; rev:5;)
alert http any any -> any any (msg:"Mac Flashback Checkin 1"; flow:established,to_server; content:"GET"; http_method; content:"/owncheck/"; sid:101002; rev:2;)
alert http any any -> any any (msg:"Mac Flashback Checkin 2"; flow:established,to_server; content:"GET"; http_method; content:"/scheck/"; pcre:"/^User-Agent\x3a\s*?[A-Za-z0-9+\/=]+?\r?$/Hm"; sid:101003; rev:6;)
alert http any any -> any any (msg:"OSX/Flashback.K first execution checkin"; flow:established,to_server; content:"/stat_svc/"; pcre:"/\/stat_svc\/$/U"; sid:101004; rev:4;)
alert http any any -> any any (msg:"OSX/Flashback.K/I reporting failed infection"; flow:established,to_server; content:"/stat_n/"; pcre:"/\/stat_n\/$/U"; sid:101005; rev:4;)
alert http any any -> any any (msg:"OSX/Flashback.K/I reporting successful infection 2"; flow:established,to_server; content:"/stat_u/"; pcre:"/\/stat_u\/$/U"; sid:101006; rev:4;)
alert http any any -> any any (msg:"OSX/Flashback.K/I reporting successful infection"; flow:established,to_server; content:"/stat_d/"; pcre:"/\/stat_d\/$/U"; sid:101007; rev:4;)
alert http any any -> any any (msg:"OSX/Flashback.K/I User-Agent"; flow:established,to_server; content:" WOW64|3b| rv|3a|9.0.1|3b| sv|3a|"; http_header; content:" id|3a|"; http_header; within:6; sid:101008; rev:4;)
alert http any any -> any any (msg:"Pakes/Cutwail/Kobcka Checkin URL"; flow:established,to_server; content:"/firstrun.php?product="; nocase; content:"&aff="; nocase; content:"&update="; nocase; content:"User-Agent|3a| Mozilla|0d 0a|"; http_header; sid:101009; rev:6;)
alert http any any -> any any (msg:"TDSS Base64 Encoded Command 1"; flow:established,to_server; content:"Q21kRXhl"; sid:101012; rev:2;)
alert http any any -> any any (msg:"TDSS Base64 Encoded Command 2"; flow:established,to_server; content:"bWRFeGVj"; sid:101013; rev:2;)
alert http any any -> any any (msg:"TDSS Base64 Encoded Command 3"; flow:established,to_server; content:"ZEV4ZWN"; sid:101014; rev:2;)
alert http any any -> any any (msg:"TDSS Trojan GET with xxxx_ string"; flow:established,to_server; content:"/xxxx_"; pcre:"/\/xxxx_\d+\//U"; sid:101015; rev:4;)
alert http any any -> any any (msg:"TDSS User-Agent CMD"; flow:established,to_server; content:" (compatible|3b| MSIE 1.0|3b| Windows NT|3b| "; http_header; fast_pattern:16,20; sid:101016; rev:7;)
alert http any any -> any any (msg:"Zeus GameOver Connectivity Check 2"; flow:established,to_server; urilen:1; content:"Connection|3a 20|Close"; http_header; fast_pattern:only; content:"Host|3a 20|windowsupdate.microsoft.com|0d 0a|"; http_header; content:!"Accept|3a 20|"; http_header; content:!"Referer|3a 20|"; http_header; sid:101017; rev:2;)
alert http any any -> any any (msg:"PRG/wnspoem/Zeus InfoStealer Trojan Config Download"; flow:established; content:"/cfg.bin"; nocase; fast_pattern; content:"GET"; http_method; nocase; content:"no-cache|0d 0a|"; http_header; nocase; pcre:"/\/cfg\.bin$/Ui"; sid:101018; rev:11;)
alert http any any -> any any (msg:"Probable OneLouder downloader (Zeus P2P)"; flow:to_server,established; content:"GET"; http_method; content:"/11"; fast_pattern; depth:3; content:!"Referer|3a| "; http_header; content:!"Accept-Language|3a| "; http_header; content:" MSIE "; http_header; pcre:"/^\/1+$/U"; sid:101019; rev:4;)
alert http any any -> any any (msg:"Probable OneLouder downloader (Zeus P2P)"; flow:to_server,established; content:"GET"; http_method; urilen:2<>5; content:!"Referer|3a| "; http_header; content:!"Accept-Language|3a| "; http_header; content:" MSIE "; http_header; fast_pattern:only; pcre:"/^\/(?P<n>\d)(?P=n){1,2}$/U"; flowbits:set,ET.Onelouder.bin; flowbits:noalert; sid:101020; rev:3;)
alert http any any -> any any (msg:"Probable OneLouder downloader (Zeus P2P)"; flow:to_server,established; content:"GET"; http_method; urilen:4; content:"/222"; fast_pattern:only; content:!"Referer|3a| "; http_header; content:!"Accept-Language|3a| "; http_header; content:" MSIE "; http_header; sid:101021; rev:3;)
alert http any any -> any any (msg:"Probable OneLouder downloader (Zeus P2P)"; flow:to_server,established; content:"GET"; http_method; urilen:4; content:"/333"; fast_pattern:only; content:!"Referer|3a| "; http_header; content:!"Accept-Language|3a| "; http_header; content:" MSIE "; http_header; sid:101022; rev:5;)
alert http any any -> any any (msg:"Probable OneLouder downloader (Zeus P2P)"; flow:to_server,established; urilen:1<>7; content:!"Accept-Language|3a| "; http_header; content:!"Referer|3a| "; http_header; content:"|20|MSIE|20|"; http_header; fast_pattern:only; pcre:"/\/\d+$/U"; flowbits:set,ET.OneLouderHeader; flowbits:noalert; sid:101023; rev:6;)
alert http any any -> any any (msg:"Rootkit TDSS/Alureon Checkin 2"; flow:established,to_server; content:"/dx.php?i="; content:"&x64="; content:"os="; content:"&a="; content:"&f="; pcre:"/dx\.php\?i=[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}&a=/Ui"; sid:101025; rev:3;)
alert http any any -> any any (msg:"SpamTool.Win32.Agent.gy/Grum/Tedroo Or Similar HTTP Checkin"; flow:established,to_server; content:"?id="; nocase; content:"&tick="; nocase; content:"&ver="; nocase; content:"&smtp="; nocase; sid:101026; rev:5;)
alert http any any -> any any (msg:"SpyEye C&C Check-in URI"; flow:established,to_server; content:"guid="; content:"ver="; content:"stat="; fast_pattern; content:"ie="; content:"os="; pcre:"/(\?|&)guid=[^!&]+?\!/U"; sid:101027; rev:6;)
alert http any any -> any any (msg:"SpyEye Checkin version 1.3.25 or later 2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"data=6Prm67"; depth:11; http_client_body; sid:101028; rev:5;)
alert http any any -> any any (msg:"SpyEye Checkin version 1.3.25 or later 3"; flow:established,to_server; content:"POST"; http_method; nocase; content:"data=mIqWm8"; http_client_body; depth:11; sid:101029; rev:6;)
alert http any any -> any any (msg:"SpyEye Checkin version 1.3.25 or later"; flow:established,to_server; content:"POST"; nocase; http_method; content:"data=vK6yv+"; http_client_body; sid:101030; rev:4;)
alert http any any -> any any (msg:"SpyEye HTTP Library Checkin"; flow:established,to_server; content:"POST"; http_method; content:"form-data|3b 20|name=|22|sid|22|"; http_client_body; content:"form-data|3b 20|name=|22|ping|22|"; http_client_body; content:"form-data|3b 20|name=|22|guid|22|"; http_client_body; content:"form-data|3b 20|name=|22|GB|22 3b 20|filename=|22|GB.TXT|22|"; http_client_body; fast_pattern; sid:101031; rev:4;)
alert http any any -> any any (msg:"SpyEye Post_Express_Label ftpgrabber check-in"; flow:established,to_server; content:"grabbers.php"; content:"&module=ftpgrabber"; http_client_body; content:!"Referer|3a| "; http_header; sid:101032; rev:3;)
alert http any any -> any any (msg:"TDSS/TDL/Alureon MBR rootkit Checkin"; flow:established,to_server; urilen:16<>402; content:"GET"; nocase; http_method; content:"Accept-Language|3a| "; http_header; depth:17; content:!"Accept|3a| "; http_header; content:"User-Agent|3a| Mozilla/4.0 |28|compatible|3b| MSIE"; fast_pattern:23,18; http_header; content:"Host|3a| "; distance:0; http_header; content:"|3a| no-cache"; distance:0; http_header; pcre:"/^\/[a-z0-9+\/=]{16,400}$/Ui"; sid:101033; rev:18;)
alert http any any -> any any (msg:"Upatre Downloader 2p (Zeus) May 07 2014"; flow:to_server,established; content:"2p/"; fast_pattern:only; content:!"Accept-Language"; http_header; content:!"Referer|3A|"; http_header; pcre:"/\/p?2p\/[a-z]{3}$/U"; sid:101034; rev:5;)
alert http any any -> any any (msg:"W32/Zeus.BitcoinMiner Variant CnC Beacon"; flow:established,to_server; content:"POST"; http_method; content:"sysin="; fast_pattern; depth:6; http_client_body; content:"?user="; nocase; content:"&type="; nocase; content:"&id="; nocase; content:!"Referer|3A|"; http_header; sid:101035; rev:2;)
alert http any any -> any any (msg:"W32/Zeus.InfoStealer Infection Campaign Heap.exe Request"; flow:established,to_server; content:"/heap.exe"; fast_pattern:only; sid:101036; rev:3;)
alert http any any -> any any (msg:"W32/Zeus.InfoStealer Infection Campaign Kia.exe Request"; flow:established,to_server; content:"/kia.exe"; fast_pattern:only; sid:101037; rev:3;)
alert http any any -> any any (msg:"W32/Zeus.InfoStealer Infection Campaign Pdf.exe Request"; flow:established,to_server; content:"/pdf.exe"; fast_pattern:only; sid:101038; rev:3;)
alert http any any -> any any (msg:"W32/Zeus.InfoStealer Infection Campaign Wav.exe Request"; flow:established,to_server; content:"/wav.exe"; fast_pattern:only; sid:101039; rev:3;)
alert http any any -> any any (msg:"Zbot downloader Installing Zeus"; flow:to_server,established; content:".exe"; http_uri; fast_pattern:only; content:"Accept|3a 20|*/*|0d 0a|Accept-Language|3a 20|"; depth:30; http_header; content:"|0d 0a|User-Agent|3a 20|Mozilla/4.0 (compatible|3b| MSIE 7.0|3b| Windows NT 6.0|3b 29 0d 0a|Host|3a| "; distance:0; http_header; pcre:"/User-Agent: [^\r]*\r\nHost: [^\r]*\r\nCache-Control: no-cache\r\n\r\n$/H"; sid:101041; rev:2;)
alert http any any -> any any (msg:"ZeroAccess Checkin"; flow:established,to_server; content:"GET"; http_method; content:"/counter.img?theme="; fast_pattern:only; content:"&digits="; content:"&siteId="; content:"User-Agent|3a| Opera/9 (Windows NT"; http_header; sid:101042; rev:3;)
alert http any any -> any any (msg:"ZeroAccess HTTP GET request"; flow:established,to_server; content:"GET"; http_method; nocase; content:"?w="; fast_pattern:only; content:"&i="; content:"&v="; content:"Host|3a 20|"; depth:6; http_header; content:"Connection|3a 20|close|0d 0a|Cookie|3a 20|"; http_header; content:!"Accept"; http_header; pcre:"/\/\d{10}\?w=\d{3}&i=\d{6,10}&v=\d\.\d$/U"; sid:101043; rev:3;)
alert http any any -> any any (msg:"ZeroAccess/Max++ Rootkit C&C Activity 1"; flow:established,to_server; content:".php?w="; content:"&i="; content:"&a="; pcre:"/\.php\?w=\d+&i=[0-9a-f]{32}&a=\d+$/U"; sid:101044; rev:2;)
alert http any any -> any any (msg:"ZeroAccess/Max++ Rootkit C&C Activity 2"; flow:established,to_server; content:".php?w="; content:"&fail="; content:"&i="; pcre:"/\.php\?w=\d+&fail=\d+&i=[0-9a-f]{32}$/U"; sid:101045; rev:2;)
alert http any any -> any any (msg:"ZeroAccess P2P Module v6 Reporting"; flow:to_server,established; content:"dj02LjAmaWQ9"; offset:13; depth:12; content:!"Referer|3a|"; http_header; sid:101046; rev:2;)
alert http any any -> any any (msg:"Zeus/Aeausuc P2P Variant Retrieving Peers List"; flow:established,to_server; content:"POST"; nocase; http_method; content:"/gameover"; pcre:"/gameover(\d+)?\.php/U"; content:" HTTP/1.1|0d 0a|Accept|3a| */*|0d 0a|X-ID|3a|"; sid:101047; rev:9;)
alert http any any -> any any (msg:"Zeus Bot GET to Bing checking Internet connectivity"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET / HTTP/1.1|0d 0a|Accept|3a| */*|0d 0a|Connection|3a| Close|0d 0a|User-Agent|3a| "; depth:60; content:"|0d 0a|Host|3a| www.bing.com"; distance:0; content:!"|0d 0a|Referer|3a| "; nocase; content:"|3a| no-cache"; sid:101048; rev:3;)
alert http any any -> any any (msg:"Zeus Bot GET to Google checking Internet connectivity"; flow:established,to_server; content:"GET"; http_method; nocase; content:" HTTP/1."; content:"|0d 0a|Accept|3a| */*|0d 0a|Connection|3a| Close|0d 0a|User-Agent|3a| "; distance:1; within:46; content:"|0d 0a|Host|3a| "; distance:0; content:!"|0d 0a|Referer|3a| "; nocase; http_header; content:"/webhp"; sid:101049; rev:7;)
alert http any any -> any any (msg:"Zeus Bot GET to Google checking Internet connectivity using proxy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"/webhp"; content:"Accept|3a| */*|0d 0a|Pragma|3a| no-cache|0d 0a|User-Agent|3a| "; depth:43; http_header; content:"|0d 0a|Host|3a| "; distance:0; http_header; content:!"Referer|3a| "; sid:101050; rev:4;)
alert http any any -> any any (msg:"Zeus Bot Request to CnC 2"; flow:to_server,established; content:"GET"; nocase; http_method; content:"Accept|3a| */*|0d 0a|If-None-Match|3a| "; fast_pattern; depth:28; http_header; content:"Cache-Control|3a| no-cache|0d 0a|User-Agent|3a| Mozilla"; distance:0; http_header; content:"Connection|3a| Close|0d 0a 0d 0a|"; distance:0; http_header; sid:101051; rev:8;)
alert http any any -> any any (msg:"Zeus Bot Request to CnC"; flow:established,to_server; content:"GET / HTTP/1.1|0d 0a|Accept|3a| */*|0d 0a|Connection|3a| Close|0d 0a|User-Agent|3a| "; depth:60; content:"|0d 0a|Host|3a| "; distance:0; content:!"|0d 0a|Referer|3a| "; nocase; content:"|3a| no-cache"; http_header; content:!"/webhp"; content:!"Host|3a| login.live.com|0d 0a|"; http_header; content:!"www.bing.com"; http_header; content:!"yandex.ru|0d 0a|"; http_header; content:!"yandex.ru|0d 0a|"; http_header; sid:101052; rev:20;)
alert http any any -> any any (msg:"Zeus Checkin Header Pattern"; flow:established,to_server; content:"POST"; nocase; http_method; content:"HTTP/1.1|0d 0a|Accept|3a 20|*/*|0d 0a|X-ID|3a 20|"; fast_pattern:23,6; pcre:"/^X-ID\x3a\x20\d+\r?$/Hm"; sid:101053; rev:6;)
alert http any any -> any any (msg:"Zeus.Downloader Campaign Second Stage Executable Request 10/4/2014"; flow:established,to_server; urilen:<11; content:"/2p/"; content:".exe"; fast_pattern; pcre:"/^\x2F2p\x2F[a-z]{1,2}\.exe$/U"; sid:101055; rev:3;)
alert http any any -> any any (msg:"Zeus.Downloader Campaign Second Stage Executable Request"; flow:established,to_server; content:"2p/"; content:".exe"; fast_pattern; pcre:"/\/p?2p\/[0-9]{1,2}\.exe$/U"; sid:101056; rev:5;)
alert http any any -> any any (msg:"Zeus.Downloader Campaign Unknown Initial CnC Beacon 10/4/2014"; flow:established,to_server; content:"POST"; http_method; content:"/ccc/tab.php"; fast_pattern:only; pcre:"/Host\x3A\x20\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}/H"; sid:101057; rev:3;)
alert http any any -> any any (msg:"Zeus.Downloader Campaign Unknown Initial CnC Beacon"; flow:established,to_server; content:"POST"; http_method; content:"/ppp/ta.php"; fast_pattern:only; pcre:"/Host\x3A\x20\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}/H"; sid:101058; rev:4;)
alert http any any -> any any (msg:"Zeus GameOver Checkin"; flow:established,to_server; content:"POST"; http_method; content:"Host|3a| default"; http_header; fast_pattern:only; content:"X-ID|3a 20|"; http_header; pcre:"/^Host\x3a\x20default(?:\x3a\d{1,5})?\r?$/Hmi"; sid:101059; rev:2;)
alert http any any -> any any (msg:"ZeuS - ICE-IX cid= in cookie"; content:"POST"; nocase; http_method; content:"Cookie|3a| cid="; http_header; pcre:"/^\d{4}\r$/RHm"; sid:101060; rev:6;)
alert http any any -> any any (msg:"Zeus POST Request to CnC - cookie variation"; flow:established,to_server; content:"POST"; nocase; http_method; content:"|20|HTTP/1."; content:"|0d 0a|Accept|3a 20|*/*|0d 0a|Accept-Language|3a 20|en-us|0d 0a|Cookie|3a 20|cid="; distance:1; within:51; content:"User-Agent|3a 20|Mozilla"; distance:0; content:"Host|3a 20|"; distance:0; content:"Content-Length|3a 20|"; distance:0; content:!"0"; within:1; content:"Connection|3a| Keep-Alive|0d 0a|"; distance:0; content:"|3a| no-cache|0d 0a 0d 0a|"; distance:0; sid:101061; rev:3;)
alert http any any -> any any (msg:"Zeus POST Request to CnC sk1 and bn1 post parameters"; flow:established,to_server; content:"POST"; nocase; http_method; content:"bn1="; depth:4; http_client_body; fast_pattern; content:"&sk1="; http_client_body; pcre:"/&sk1=[A-F0-9]{30}/P"; sid:101062; rev:5;)
alert http any any -> any any (msg:"ZeuS Ransomware win_unlock"; flow:established,to_server; content:"/locker/lock.php?id="; sid:101063; rev:4;)
alert http any any -> any any (msg:"Zeus/Reveton checkin to /images.rar"; flow:established,to_server; content:"/images.rar"; fast_pattern; depth:11; content:"User-Agent|3a 20|Internet Explorer"; http_header; content:!"Referer|3a 20|"; http_header; pcre:"/^Host\x3a (\d+\.){3}\d+$/Dm"; sid:101064; rev:3;)
alert http any any -> any any (msg:"Zeus User-Agent(z00sAgent)"; flow:to_server,established; content:"User-Agent|3a| z00sAgent"; fast_pattern:12,9; http_header; sid:101065; rev:2;)
alert http any any -> any any (msg:"Win32.Tdss User Agent Detected (Mozzila)"; flow:established,to_server; content:"User-Agent\: Mozzila"; http_header; sid:101066; rev:3;)
alert http any any -> any $HTTP_PORTS (msg:"CURRENT_EVENTS Possible Cutwail Redirect to Magnitude EK"; flow:established,to_server; urilen:15; content:"/messag_id.html"; fast_pattern:only; sid:101067; rev:3;)
alert tcp any any -> any any (msg:"P2P Zeus Response From CnC"; flow:established,from_server; content:"|E5 AA C0 31|"; depth:4; content:"|5B 74|"; distance:5; within:2; content:"|C1|"; distance:4; within:2; sid:101068; rev:4;)
alert tcp any any -> any any (msg:"Probable OneLouder downloader (Zeus P2P) exe download"; flow:established,to_client; flowbits:isset,ET.Onelouder.bin; content:"MZ"; byte_jump:4,58,relative,little; content:"PE|00 00|"; distance:-64; within:4; sid:101069; rev:2;)
alert tcp any any -> any 25 (msg:"USPS SPAM Inbound possible spyeye trojan"; flow:established,to_server; content:"Content-Disposition|3A| attachment|3b|"; nocase; content:"filename=|22|USPS_"; nocase; content:".zip|22|"; nocase; sid:101070; rev:2;)
alert tcp any any -> any 1024: (msg:"SpyEyes FTP Channel"; flow:to_server,established; dsize:<150; content:"FTP NAME "; depth:9; content:"|21|"; within:50; content:"|21|"; within:50; content:"|0d 0a|"; within:30; sid:101074; rev:3;)
alert tcp any any -> any 1024: (msg:"SpyEye Socks Channel Checkin"; flow:to_server,established; dsize:<150; content:"SOCKS NAME "; depth:11; content:"|21|"; within:50; content:"|21|"; within:50; content:"|0d 0a|"; within:30; sid:101075; rev:4;)
alert tcp any any -> any any (msg:"P2P Zeus or ZeroAccess Request To CnC"; flow:established,to_server; dsize:20; content:"|E5 AA C0 31|"; depth:4; content:"|5B 74 08 4D 9B 39 C1|"; distance:5; within:7; sid:101076; rev:9;)
alert tcp any any -> any any (msg:"Spyeye Data Exfiltration 0"; flow:established,to_server; content:"|B4 B4 B4 B4 BC BF BF BF BF BD BD BD BD B3 B3 B3 B3|"; offset:5; depth:17; sid:101077; rev:4;)
alert tcp any any -> any any (msg:"Spyeye Data Exfiltration 1"; flow:established,to_server; content:"|40 40 40 40 48 4B 4B 4B 4B 49 49 49 49 47 47 47 47|"; offset:5; depth:17; sid:101078; rev:4;)
alert tcp any any -> any any (msg:"Spyeye Data Exfiltration 2"; flow:established,to_server; content:"|0B 0B 0B 0B 03 00 00 00 00 02 02 02 02 0C 0C 0C 0C|"; offset:5; depth:17; sid:101079; rev:4;)
alert tcp any any -> any any (msg:"Spyeye Data Exfiltration 3"; flow:established,to_server; content:"|AC AC AC AC A4 A7 A7 A7 A7 A5 A5 A5 A5 AB AB AB AB|"; offset:5; depth:17; sid:101080; rev:3;)
alert tcp any any -> any any (msg:"Spyeye Data Exfiltration 4"; flow:established,to_server; content:"|DD DD DD DD D5 D6 D6 D6 D6 D4 D4 D4 D4 DA DA DA DA|"; offset:5; depth:17; sid:101081; rev:3;)
alert tcp any any -> any any (msg:"Spyeye Data Exfiltration 5"; flow:established,to_server; content:"|7A 7A 7A 7A 72 71 71 71 71 73 73 73 73 7D 7D 7D 7D|"; offset:5; depth:17; sid:101082; rev:3;)
alert tcp any any -> any any (msg:"Spyeye Data Exfiltration 6"; flow:established,to_server; content:"|B5 B5 B5 B5 BD BE BE BE BE BC BC BC BC B2 B2 B2 B2|"; offset:5; depth:17; sid:101083; rev:3;)
alert tcp any any -> any any (msg:"Spyeye Data Exfiltration 7"; flow:established,to_server; content:"|6F 6F 6F 6F 67 64 64 64 64 66 66 66 66 68 68 68 68|"; offset:5; depth:17; sid:101084; rev:3;)
alert tcp any any -> any any (msg:"Spyeye Data Exfiltration 8"; flow:established,to_server; content:"|B4 B4 B4 B4 BC BF BF BF BF BD BD BD BD B3 B3 B3 B3|"; offset:5; depth:17; sid:101085; rev:3;)
alert tcp any any -> any any (msg:"Spyeye Data Exfiltration 9"; flow:established,to_server; content:"|0F 0F 0F 0F 07 04 04 04 04 06 06 06 06 08 08 08 08|"; offset:5; depth:17; sid:101086; rev:3;)
alert tcp any any -> any any (msg:"Zbot/Zeus HTTP POST"; flow:to_server,established; content:"POST"; depth:4; http_method; content:".php?"; content:"zip="; content:"type="; content:"name="; content:"q="; content:"item="; content:"id="; content:"rdp="; sid:101092; rev:6;)
alert tcp any any -> any any (msg:"Zbot/Zeus or Related Infection Checkin"; flow:established,to_server; content:"btn="; content:"q="; content:"SOFT"; http_client_body; sid:101093; rev:8;)
alert tcp any any -> any $HTTP_PORTS (msg:"Zeus GameOver Connectivity Check"; flow:established,to_server; urilen:1; content:"|3b| MSIE "; fast_pattern:only; content:!"Accept-Encoding|3a 20|"; http_header; content:"Host|3a 20|www.google.com|0d 0a|"; http_header; pcre:"/^Accept\x3a\x20\*\/\*\r\nAccept-Language\x3a\x20[^\r\n]+\r\nUser-Agent\x3a\x20[^\r\n]+\sMSIE\s\d+\.\d+[^\r\n]+\r\nHost\x3a\x20www\.google\.com\r\nConnection\x3a\x20Close\r\n(?:\r\n)?$/H"; sid:101095; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"TDSServ or Tidserv variant Checkin"; flow:established,to_server; content:"GET"; depth:3; http_method; content:"/crcmds/main"; nocase; sid:101097; rev:4;)
alert tcp any any -> any $HTTP_PORTS (msg:"ZeuS Post to C&C footer.php"; flow:established,to_server; content:"/footer.php"; content:"POST"; http_method; content:!"Accept-"; http_header; sid:101098; rev:1;)
alert tls any any -> any any (msg:"ABUSE.CH SSL Fingerprint Blacklist Malicious SSL certificate detected (ZeuS C2)"; flow:established,from_server; content:"|06|lzx.su"; fast_pattern:only; tls.fingerprint:"79:67:bb:dd:e9:c1:17:46:8d:26:cd:de:db:20:e2:1c:46:63:bd:d7"; sid:101099; rev:2;)
alert tls any any -> any any (msg:"ABUSE.CH SSL Fingerprint Blacklist Malicious SSL certificate detected (ZeuS MITM)"; flow:established,from_server; content:"|55 04 03|"; content:"|15|daznukhurebkolsek.net"; distance:1; within:22; tls.fingerprint:"b6:d7:85:2a:e1:ca:32:5f:77:28:d4:64:12:44:8b:01:41:94:0b:c9"; sid:101100; rev:3;)
alert udp any 53 -> any any (msg:"DNS Reply Sinkhole FBI Zeus P2P 1 - 142.0.36.234"; content:"|00 01 00 01|"; content:"|00 04 8e 00 24 ea|"; distance:4; within:6; sid:101101; rev:1;)
alert udp any 1024: -> any 6000: (msg:"Zeus P2P CnC"; dsize:72; byte_extract:1,63,padding; byte_test:1,!=,0xff,71; byte_test:1,!=,0x00,71; byte_test:1,=,padding,64; byte_test:1,=,padding,65; byte_test:1,=,padding,66; byte_test:1,=,padding,67; byte_test:1,=,padding,68; byte_test:1,=,padding,69; byte_test:1,=,padding,70; byte_test:1,=,padding,71; sid:101104; rev:13;)
alert udp any any -> any 53 (msg:"TDSS DNS Based Internet Connectivity Check"; dsize:34; content:"|33 33 01 00 00 01 00 00 00 00 00 00 07|counter|05|yadro|02|ru|00 00 01 00 01|"; sid:101105; rev:1;)
alert udp any any -> any 53 (msg:"Zeus .ru CnC Domain Generation Algorithm (DGA) Lookup Detected"; byte_test:1,!&,0xF8,2; content:"|02|ru|00|"; fast_pattern:only; pcre:"/[^a-z0-9\-\.][a-z]{32,48}\x02ru\x00\x00/"; sid:101106; rev:3;)
alert udp any any -> any 53 (msg:"Lookup of Algorithm Generated Zeus CnC Domain (DGA)"; byte_test:1,!&,0xF8,2; content:"|02|ru|00|"; pcre:"/[a-z0-9]{33,}\x02ru\x00\x00/"; sid:101107; rev:7;)
alert udp any any -> any 53 (msg:"ZeroAccess udp traffic detected"; content:"|9e 98|"; offset:6; depth:2; dsize:20; sid:101108; rev:2;)
alert http any any -> any any (msg:"possible OneLouder header structure"; flow:to_server,established; content:"Mozilla/4.0 (compatible|3b| MSIE 7.0|3b| Windows NT 6.0|3b|)|0d 0a|Host|3a|"; http_header; fast_pattern:38,20; content:!"Accept-Encoding|3a|"; content:!"Referer"; http_header; flowbits:set,ET.OneLouder.Header; flowbits:noalert; sid:101112; rev:9;)
alert udp any 10000: -> any 10000: (msg:"nmap 指纹扫描(U1)"; dsize:300; content:"CCCCCCCCCCCCCCCCCCCC"; fast_pattern:only; content:"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"; depth:255; content:"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"; within:45; classtype:attempted-recon; sid:2018489; rev:3; metadata:created_at 2014_05_20, updated_at 2014_05_20;)
alert tcp any any -> any any (msg:"namp TCP扫描"; ack:0; flags:A,12; flow:stateless; reference:arachnids,28; classtype:attempted-recon; sid:2100628; rev:8; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert tcp any any -> any any (msg:"nmap 指纹扫描(T3)"; flags:SFPU; flow:stateless; reference:arachnids,05; classtype:attempted-recon; sid:2100629; rev:7; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert tcp any any -> any any (msg:"nmap XMAS扫描"; flow:stateless; flags:FPU,12; reference:arachnids,30; classtype:attempted-recon; sid:2101228; rev:8; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
alert pkthdr any any -> any any (msg:"IPv4 packet too small"; decode-event:ipv4.pkt_too_small; classtype:protocol-command-decode; sid:2200000; rev:2;)
alert pkthdr any any -> any any (msg:"IPv4 header size too small"; decode-event:ipv4.hlen_too_small; classtype:protocol-command-decode; sid:2200001; rev:2;)
alert pkthdr any any -> any any (msg:"IPv4 total length smaller than header size"; decode-event:ipv4.iplen_smaller_than_hlen; classtype:protocol-command-decode; sid:2200002; rev:2;)
alert pkthdr any any -> any any (msg:"IPv4 wrong IP version"; decode-event:ipv4.wrong_ip_version; classtype:protocol-command-decode; sid:2200011; rev:2;)
alert pkthdr any any -> any any (msg:"IPv6 packet too small"; decode-event:ipv6.pkt_too_small; classtype:protocol-command-decode; sid:2200012; rev:2;)
alert pkthdr any any -> any any (msg:"IPv6 wrong IP version"; decode-event:ipv6.wrong_ip_version; classtype:protocol-command-decode; sid:2200022; rev:2;)
alert pkthdr any any -> any any (msg:"ICMPv4 packet too small"; decode-event:icmpv4.pkt_too_small; classtype:protocol-command-decode; sid:2200023; rev:2;)
alert pkthdr any any -> any any (msg:"ICMPv4 unknown version"; decode-event:icmpv4.ipv4_unknown_ver; classtype:protocol-command-decode; sid:2200027; rev:2;)
alert pkthdr any any -> any any (msg:"ICMPv6 packet too small"; decode-event:icmpv6.pkt_too_small; classtype:protocol-command-decode; sid:2200028; rev:2;)
alert pkthdr any any -> any any (msg:"SURICATA ICMPv6 unknown version"; decode-event:icmpv6.ipv6_unknown_version; classtype:protocol-command-decode; sid:2200032; rev:2;)
alert pkthdr any any -> any any (msg:"TCP packet too small"; decode-event:tcp.pkt_too_small; classtype:protocol-command-decode; sid:2200033; rev:2;)
alert pkthdr any any -> any any (msg:"TCP header length too small"; decode-event:tcp.hlen_too_small; classtype:protocol-command-decode; sid:2200034; rev:2;)
alert pkthdr any any -> any any (msg:"UDP packet too small"; decode-event:udp.pkt_too_small; classtype:protocol-command-decode; sid:2200038; rev:2;)
alert pkthdr any any -> any any (msg:"UDP header length too small"; decode-event:udp.hlen_too_small; classtype:protocol-command-decode; sid:2200039; rev:2;)
alert ip any any -> any any (msg:"IPv4 invalid checksum"; ipv4-csum:invalid; classtype:protocol-command-decode; sid:2200073; rev:2;)
alert tcp any any -> any any (msg:"TCPv4 invalid checksum"; tcpv4-csum:invalid; classtype:protocol-command-decode; sid:2200074; rev:2;)
alert udp any any -> any any (msg:"UDPv4 invalid checksum"; udpv4-csum:invalid; classtype:protocol-command-decode; sid:2200075; rev:2;)
alert icmp any any -> any any (msg:"ICMPv4 invalid checksum"; icmpv4-csum:invalid; classtype:protocol-command-decode; sid:2200076; rev:2;)
alert tcp any any -> any any (msg:"TCPv6 invalid checksum"; tcpv6-csum:invalid; classtype:protocol-command-decode; sid:2200077; rev:2;)
alert udp any any -> any any (msg:"UDPv6 invalid checksum"; udpv6-csum:invalid; classtype:protocol-command-decode; sid:2200078; rev:2;)
alert icmp any any -> any any (msg:"ICMPv6 invalid checksum"; icmpv6-csum:invalid; classtype:protocol-command-decode; sid:2200079; rev:2;)
alert tcp any any -> any any (msg:"STREAM 3way handshake SYNACK resend with different seq"; stream-event:3whs_synack_resend_with_diff_seq; classtype:protocol-command-decode; sid:2210005; rev:2;)
alert tcp any any -> any any (msg:"STREAM ESTABLISHED SYNACK resend"; stream-event:est_synack_resend; classtype:protocol-command-decode; sid:2210022; rev:2;)
alert tcp any any -> any any (msg:"STREAM ESTABLISHED SYN resend"; stream-event:est_syn_resend; classtype:protocol-command-decode; sid:2210026; rev:2;)
alert tcp any any -> any any (msg:"STREAM FIN recv but no session"; stream-event:fin_but_no_session; classtype:protocol-command-decode; sid:2210037; rev:2;)
alert tcp any any -> any any (msg:"STREAM RST recv but no session"; stream-event:rst_but_no_session; classtype:protocol-command-decode; sid:2210041; rev:2;)
alert tcp any any -> any any (msg:"STREAM Packet with invalid ack"; stream-event:pkt_invalid_ack; classtype:protocol-command-decode; sid:2210045; rev:2;)
alert tcp any any -> any any (msg:"STREAM SHUTDOWN SYN resend"; stream-event:shutdown_syn_resend; classtype:protocol-command-decode; sid:2210049; rev:2;)
alert tcp any any -> any any (msg:"STREAM Packet with broken ack"; stream-event:pkt_broken_ack; classtype:protocol-command-decode; sid:2210051; rev:2;)
alert tcp any any -> any any (msg:"CLOSEWAIT retransmission packet before last ack"; stream-event:closewait_pkt_before_last_ack; classtype:protocol-command-decode; sid:2210052; rev:3;)
alert tcp any any -> any any (msg:"STREAM Packet is retransmission"; stream-event:pkt_retransmission; classtype:protocol-command-decode; sid:2210053; rev:1;)
alert tcp any any -> any any (msg:"STREAM 3way handshake excessive different SYN/ACKs"; stream-event:3whs_synack_flood; classtype:protocol-command-decode; sid:2210055; rev:2;)
# alert tcp any any -> any any (msg:"STREAM suspected RST injection"; stream-event:suspected_rst_inject; classtype:protocol-command-decode; sid:2210058; rev:1;)
alert tcp any any -> any any (msg:"TCP连接被拒绝"; flow:stateless; flags:R; classtype:tcp-connection; sid:2220000; rev:1;)
alert icmp any any -> any any (msg:"ICMP目标不可达"; itype:3; classtype:icmp-event; sid:2220001; rev:1;)